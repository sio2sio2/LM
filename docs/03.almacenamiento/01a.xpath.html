




<!DOCTYPE html>

<html lang="es">
  <head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" /><meta name="generator" content="Docutils 0.19: https://docutils.sourceforge.io/" />

    <title>3.1.1. XPath &#8212; documentación de Lenguajes de Marcas - rolling</title>
    <link rel="stylesheet" type="text/css" href="../_static/pygments.css" />
    <link rel="stylesheet" type="text/css" href="../_static/cloud.css" />
    <link rel="stylesheet" type="text/css" href="../_static/design-style.1e8bd061cd6da7fc9cf755528e8ffc24.min.css" />
    <link rel="stylesheet" href="../_static/general.css" type="text/css" />
    <link rel="stylesheet" href="../_static/particular.css" type="text/css" />
    <link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Noticia+Text:400,i,b,bi|Open+Sans:400,i,b,bi|Roboto+Mono:400,i,b,bi&amp;display=swap" type="text/css" />
    
    <script data-url_root="../" id="documentation_options" src="../_static/documentation_options.js"></script>
    <script src="../_static/jquery.js"></script>
    <script src="../_static/underscore.js"></script>
    <script src="../_static/_sphinx_javascript_frameworks_compat.js"></script>
    <script src="../_static/doctools.js"></script>
    <script src="../_static/sphinx_highlight.js"></script>
    <script src="../_static/translations.js"></script>
    <script src="../_static/design-tabs.js"></script>

    
    
     
        <script src="../_static/jquery.cookie.js"></script>
    

    
     
        <script src="../_static/cloud.base.js"></script>
    

    
     
        <script src="../_static/cloud.js"></script>
    

    <link rel="index" title="Índice" href="../genindex.html" />
    <link rel="search" title="Búsqueda" href="../search.html" />
    <link rel="next" title="3.1.2. JSONPath" href="01b.jsonpath.html" />
    <link rel="prev" title="3.1. Tecnologías de consulta" href="01.consulta.html" /> 
        <meta name="viewport" content="width=device-width, initial-scale=1">
  </head><body>
    <div class="relbar-top">
        
    <div class="related" role="navigation" aria-label="related navigation">
      <h3>Navegación</h3>
      <ul>
        <li class="right" style="margin-right: 10px">
          <a href="../genindex.html" title="Índice General"
             accesskey="I">índice</a></li>
        <li class="right" >
          <a href="01b.jsonpath.html" title="3.1.2. JSONPath"
             accesskey="N">siguiente</a> &nbsp; &nbsp;</li>
        <li class="right" >
          <a href="01.consulta.html" title="3.1. Tecnologías de consulta"
             accesskey="P">anterior</a> &nbsp; &nbsp;</li>
    <li><a href="../index.html">documentación de Lenguajes de Marcas - rolling</a> &#187;</li>

          <li class="nav-item nav-item-1"><a href="index.html" ><span class="section-number">3. </span>Almacenamiento</a> &#187;</li>
          <li class="nav-item nav-item-2"><a href="01.consulta.html" accesskey="U"><span class="section-number">3.1. </span>Tecnologías de consulta</a> &#187;</li>
        <li class="nav-item nav-item-this"><a href=""><span class="section-number">3.1.1. </span>XPath</a></li> 
      </ul>
    </div>
    </div>
  

    <div class="document">
      <div class="documentwrapper">
        <div class="bodywrapper">
          <div class="body" role="main">
            
  <section id="xpath">
<span id="id1"></span><h1><span class="section-number">3.1.1. </span>XPath<a class="headerlink" href="#xpath" title="Enlace permanente a este encabezado">¶</a></h1>
<p>En muchas de las operaciones que se hacen con un documento <abbr title="eXtensible  Markup Language">XML</abbr>, como extraer
información o escribir reglas para su transformación es necesario referirse a
nodos o conjuntos de nodos. <em class="dfn">XPath</em> es un sintaxis estándar para la
selección de uno o varios componentes (nodos, atributos, etc.) dentro de un
documento <abbr title="eXtensible  Markup Language">XML</abbr>.</p>
<p><em>XPath</em> es, pues, un estandar del <abbr title="W3 Consortium">W3C</abbr> para seleccionar con qué nodos de un
documento <abbr title="eXtensible  Markup Language">XML</abbr> se desea operar para cuya operación posterior se requerirá el
uso de otra herramienta como <span class="xref std std-ref">XQuery</span>, <span class="xref std std-ref">XSLT</span> o alguna biblioteca  de
programas de propósito general. Es, por tanto, una herramienta que no tiene
sentido utilizar aislada.</p>
<div class="admonition caution">
<p class="admonition-title">Prudencia</p>
<p><em>XPath</em> no es el único lenguaje para esta tarea. En <abbr title="HyperText Markup Language">HTML</abbr> (que
no es <abbr title="eXtensible  Markup Language">XML</abbr>, pero tiene bastantes semejanzas) es muy común usar para la
selección de nodos los <span class="xref std std-ref">selectores CSS</span>, diseñados en
principio para definir su estilo (o sea, su aspecto). A pesar de nacer para
documentos <abbr title="HyperText Markup Language">HTML</abbr>, los <em>selectores CSS</em> son perfectamente válidos para
identificar nodos <abbr title="eXtensible  Markup Language">XML</abbr>, por lo que son una alternativa muy utilizado. Por
ejemplo, <a class="reference external" href="https://es.wikipedia.org/wiki/JavaScript">Javascript</a> los soporta para la selección de nodos en general (véase
<a class="reference external" href="https://developer.mozilla.org/es/docs/Web/API/Document/querySelectorAll">document.querySelectorAll</a>),
en vez de <em>XPath</em>, a pesar de que existe  la función <a class="reference external" href="https://developer.mozilla.org/es/docs/Web/JavaScript/Introduction_to_using_XPath_in_JavaScript">document.evaluate</a>,
que permite usar <em>XPath</em>.</p>
</div>
<p>El nombre de la tecnología deriva de la fusión de <abbr title="eXtensible  Markup Language">XML</abbr> y la palabra inglesa
<em>path</em>, que en un sistema de archivo es la manera de indicar la ruta que hay que
seguir para llegar a un determinado archivo. La analogía no es gratuita, puesto
que en el caso de los sistemas de archivos se habla del árbol de directorios, de
la misma manera que en un documento <abbr title="eXtensible  Markup Language">XML</abbr> hay un <a class="reference internal" href="../01.intro/02b.marcas.html#xml-jerarq"><span class="std std-ref">árbol de nodos</span></a>.</p>
<p>Desde su creación en 1999, <em>XPath</em> se ha ido actualizando con distintas
<strong>versiones</strong>:</p>
<dl class="simple">
<dt><a class="reference external" href="https://www.w3.org/TR/xpath-10/">Versión 1</a>,</dt><dd><p>que apareció en el año 1999, y es universalmente soportada. Es la versión que
soporta <a class="reference external" href="http://xmlsoft.org/">libxml</a>, la librería que utiliza
<strong class="command">xmlstarlet</strong>.</p>
</dd>
<dt><a class="reference external" href="https://www.w3.org/TR/xpath-20/">Versión 2</a>,</dt><dd><p>que apareció en 2007, e introduce mejoras muy significativas. No todo el
software soporta esta especificación.</p>
</dd>
<dt><a class="reference external" href="https://www.w3.org/TR/xpath-30/">Versión 3</a>,</dt><dd><p>que apareció en 2014. El cambio respecto a la versión anterior, <a class="reference external" href="https://en.wikipedia.org/wiki/XPath_3">no es tan
significativo</a> como el que se produjo
entre la <strong>1</strong> y la <strong>2</strong>.  En el mundo del software libre soportan esta
versión la librería <a class="reference external" href="http://saxon.sourceforge.net/saxon7.7/api-guide.html">Saxon</a> para <a class="reference external" href="https://www.java.com/">Java</a> y <a class="reference external" href="http://xerces.apache.org/">Xerces</a>, que tiene
versión para <a class="reference external" href="https://es.wikipedia.org/wiki/C%2B%2B">C++</a>. En la <abbr title="Command Line Interface">CLI</abbr> de
Linux puede usarse a través de algunos programas de <em>software</em> libre:</p>
<ul class="simple">
<li><p><a class="reference external" href="http://xqilla.sourceforge.net/HomePage">xqilla</a>, que aunque tiene paquete
en <em>Debian</em>, desgraciadamente no está disponible para <em>Bookworm</em>, por
<a class="reference external" href="https://bugs.debian.org/cgi-bin/bugreport.cgi?bug=984418">problemas de compilación con g++-11</a>.</p></li>
<li><p><a class="reference external" href="https://www.videlibri.de/xidel.html">xidel</a>, que no tiene paquete oficial, pero puede descargarse de su página
oficial.</p></li>
</ul>
</dd>
<dt><a class="reference external" href="https://www.w3.org/TR/xpath-31/">Versión 3.1</a>,</dt><dd><p>publicada en 2017, que añade soporte para dos tipos de datos nuevos, la
secuencia y el mapa, lo que posibilita que el lenguaje sea apto para consultar
también documentos <abbr title="JavaScript Object Notation">JSON</abbr>.</p>
</dd>
</dl>
<div class="admonition seealso">
<p class="admonition-title">Ver también</p>
<p>El <abbr title="W3 Consortium">W3C</abbr> mantiene una <a class="reference external" href="https://www.w3.org/TR/xpath/">página que enumera todas las versiones</a>. Para una exhaustiva comparación entre las
versiones <strong>1.0</strong> y <strong>2.0</strong> se encuentra <a class="reference external" href="http://www.mulberrytech.com/papers/XPath-2-0-User-Grp-HTML/contents.html">en este documento</a>
y para una comparación más sucinta <a class="reference external" href="https://learn.microsoft.com/en-us/archive/msdn-magazine/2003/january/the-xml-files-introducing-xpath-2-0">este artículo en la web de Microsoft</a>.</p>
</div>
<p>En estos apuntes desarrollaremos primero la norma de <em>XPath</em> 1.0 (por su amplio
soporte) y expondremos luego cuáles son los cambios y ampliaciones que presenta
<em>XPath</em> 2.0.</p>
<section id="procesadores">
<span id="xpath-procesadores"></span><h2><span class="section-number">3.1.1.1. </span>Procesadores<a class="headerlink" href="#procesadores" title="Enlace permanente a este encabezado">¶</a></h2>
<p>Como en unidades anteriores, antes de entrar en profundidad en el asunto, es
conveniente conocer qué herramientas tenemos para procesar nuestras expresiones
<em>Xpath</em> tenemos muchas alternativas. Hay muchas entre las que señalaremos:</p>
<ul class="simple">
<li><p><a class="reference external" href="http://xpather.com/">XPather</a>, que permite evaluar online expresiones
<em>XPath</em> 2.0.</p></li>
<li><p><a class="reference external" href="https://code.visualstudio.com">Visual Studio Code</a> con la extensión <a class="reference external" href="https://marketplace.visualstudio.com/items?itemName=creinbacher.xpathtester">XPath Tester</a>
permite evaluar expresiones <em>XPath</em> 1.0. Para evaluar expresiones, basta con
pulsar <kbd class="kbd compound docutils literal notranslate"><kbd class="kbd docutils literal notranslate">Ctrl</kbd>+<kbd class="kbd docutils literal notranslate">Shift</kbd>+<kbd class="kbd docutils literal notranslate">P</kbd></kbd> y buscar <em>XPath</em> para que accedamos al cuadro de
diálogo que nos permite hacer evaluaciones.</p></li>
<li><p>El paquete <a class="reference external" href="https://packages.debian.org/stable/xmlstarlet">xmlstarlet</a>, cuyo paquete homónimo permite utilizar
expresiones <em>XPath</em> 1.0 tanto para seleccionar información del <abbr title="eXtensible  Markup Language">XML</abbr> original,
como para modificarlo.</p></li>
<li><p>El programa <a class="reference external" href="https://www.videlibri.de/xidel.html">xidel</a>, que soporta XPath 3.0.</p></li>
</ul>
<p>Expondremos estos dos últimos programas de línea de comandos, porque son los
únicos que requieren alguna explicación sobre su funcionamiento:</p>
<div class="admonition caution">
<p class="admonition-title">Prudencia</p>
<p>A estas alturas aún, la lectura completa del siguiente epígrafe es
empachante y nada recomendable. Nos basta con saber cómo evaluar las
expresiones <em>XPath</em> que se van introduciendo gradualmente, con lo que nos sobra con
saber cómo usar <a class="reference internal" href="#xpath-xidel"><span class="std std-ref">xidel</span></a>, si necesitamos probar expresiones
validas únicas en <em>XPath</em> 2.0, o manejar la extensión de <a class="reference external" href="https://code.visualstudio.com">Visual Studio
Code</a> que no requiere gran pericia.</p>
</div>
<section id="xidel">
<span id="xpath-xidel"></span><h3><span class="section-number">3.1.1.1.1. </span><strong class="program">Xidel</strong><a class="headerlink" href="#xidel" title="Enlace permanente a este encabezado">¶</a></h3>
<p>La principal ventaja de usarlo frente a <a class="reference internal" href="#xpath-xidel"><span class="std std-ref">xmlstarlet</span></a> es que
podremos probar expresiones <em>XPath</em> 2.0 ó 3.0.</p>
<p>Para comprobar nuestras expresiones <em>XPath</em> podemos usarlo de dos modos
distintos:</p>
<ul>
<li><p>Si el resultado es texto:</p>
<div class="highlight-console notranslate"><div class="highlight"><pre><span></span><span class="gp">$ </span>xidel<span class="w"> </span>-s<span class="w"> </span>-e<span class="w"> </span><span class="s1">&#39;//profesor[1]/@id&#39;</span><span class="w"> </span>casilleros.xml
<span class="go">p1</span>
</pre></div>
</div>
<p>donde «<kbd class="kbd docutils literal notranslate">-s</kbd>» evita mensajes de información innecesarios, y «<kbd class="kbd docutils literal notranslate">-e</kbd>» introduce
la expresión <em>XPath</em>.</p>
</li>
<li><p>Si el resultado es un nodo o un conjunto de nodos, es necesario añadir
<kbd class="kbd compound docutils literal notranslate"><kbd class="kbd docutils literal notranslate">-</kbd>-<kbd class="kbd docutils literal notranslate">printed</kbd>-<kbd class="kbd docutils literal notranslate">node</kbd>-<kbd class="kbd docutils literal notranslate">format=xml</kbd></kbd>:</p>
<div class="highlight-console notranslate"><div class="highlight"><pre><span></span><span class="gp">$ </span>xidel<span class="w"> </span>-s<span class="w"> </span>--printed-node-format<span class="o">=</span>xml<span class="w"> </span>-e<span class="w"> </span><span class="s1">&#39;//profesor/apelativo&#39;</span><span class="w"> </span>casilleros.xml
</pre></div>
</div>
</li>
</ul>
</section>
<section id="xmlstarlet">
<span id="xpath-xmlstarlet"></span><h3><span class="section-number">3.1.1.1.2. </span><strong class="program">XMLStarlet</strong><a class="headerlink" href="#xmlstarlet" title="Enlace permanente a este encabezado">¶</a></h3>
<p>Con este programa podemos usar <em>XPath</em> tanto para seleccionar datos como para
introducir modificaciones al <abbr title="eXtensible  Markup Language">XML</abbr> original. Lo segundo no nos interesa
demasiado, pero por completar la información sobre la orden incluiremos las
posibilidades que brinda.</p>
<section id="seleccion">
<h4><span class="section-number">3.1.1.1.2.1. </span>Selección<a class="headerlink" href="#seleccion" title="Enlace permanente a este encabezado">¶</a></h4>
<p>Para lograrlo es necesario usar el comando <code class="docutils literal notranslate"><span class="pre">sel</span></code>, seguido de la opción <code class="docutils literal notranslate"><span class="pre">-t</span></code>, y
la acción que se quiere realizar a continuación, que puede ser:</p>
<dl>
<dt><code class="code docutils literal notranslate"><span class="pre">-v</span> <span class="pre">&lt;expresión-xpath&gt;</span></code></dt><dd><p>Muestra el valor de lo seleccionado mediante la expresión. Se debe estar
opción cuuando el resultado de la expresión es un valor escalar: un único
atributo, un nodo que contiene texto o el evaluación de un función o una
operación. Por ejemplo:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span>$ xmlstarlet sel -t -v &#39;//profesor[1]/@id&#39; -n casilleros.xml
p1
</pre></div>
</div>
<div class="admonition note">
<p class="admonition-title">Nota</p>
<p>Se ha añadido la opción <code class="docutils literal notranslate"><span class="pre">-n</span></code> para añadir un cambio de línea al
final del resultado.</p>
</div>
</dd>
<dt><code class="code docutils literal notranslate"><span class="pre">-c</span> <span class="pre">&lt;expresion-path&gt;</span></code></dt><dd><p>Copia el nodo seleccionado, por tanto deberá usarse cuando el resultado de
nuestra selección es un nodo elemento o un conjunto de nodos elemento. Por
ejemplo, lo siguiente devuelve todos los nodos <em>apelativo</em>:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span>$ xmlstarlet sel -t -c &#39;//profesor/apelativo&#39; -n casilleros.xml
&lt;apelativo&gt;Pepe&lt;/apelativo&gt;&lt;apelativo&gt;Paco&lt;/apelativo&gt;&lt;apelativo&gt;Mari&lt;/apelativo&gt;
</pre></div>
</div>
</dd>
<dt><code class="code docutils literal notranslate"><span class="pre">-m</span> <span class="pre">&lt;expresión-path&gt;</span></code></dt><dd><p>Selecciona un nodo o un conjunto de nodos para seguir trabajando sobre
ellos. Por tanto, requerirá que luego se use <code class="docutils literal notranslate"><span class="pre">-v</span></code> o <code class="docutils literal notranslate"><span class="pre">-c</span></code>. Por ejemplo:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span>$ xmlstarlet sel -t -m &#39;//profesor/apelativo&#39; -v &#39;.&#39; casilleros.xml
PepePacoMari
</pre></div>
</div>
<p>En este caso, habría sido fundamental usar <code class="docutils literal notranslate"><span class="pre">-n</span></code>:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span>$ xmlstarlet sel -t -m &#39;//profesor/apelativo&#39; -v &#39;.&#39; -n casilleros.xml
Pepe
Paco
Mari
</pre></div>
</div>
</dd>
</dl>
<div class="admonition note">
<p class="admonition-title">Nota</p>
<p><strong class="command">xmlstarlet</strong> es capaz de devolvernos el código <abbr title="eXtensible Stylesheet Language Transformations">XSLT</abbr>
equivalente a nuestra selección añadiendo tras <code class="docutils literal notranslate"><span class="pre">sel</span></code> la opción <code class="docutils literal notranslate"><span class="pre">-C</span></code>.</p>
</div>
</section>
<section id="edicion">
<h4><span class="section-number">3.1.1.1.2.2. </span>Edición<a class="headerlink" href="#edicion" title="Enlace permanente a este encabezado">¶</a></h4>
<p>En este caso, debe usarse <code class="docutils literal notranslate"><span class="pre">ed</span></code>, una acción y el uso de expresiones <em>XPath</em>:</p>
<dl>
<dt><code class="code docutils literal notranslate"><span class="pre">-d</span> <span class="pre">&lt;expresion-xpath&gt;</span></code></dt><dd><p>Borra los nodos que selecciona la expresión:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span>$ xmlstarlet ed -d &#39;//profesor[last()]&#39; casilleros.xml
</pre></div>
</div>
<p>Esta expresión elimnina el último de los profesores.</p>
</dd>
<dt><code class="code docutils literal notranslate"><span class="pre">-u</span> <span class="pre">&lt;expresion-xpath&gt;</span> <span class="pre">-v</span> <span class="pre">valor</span></code></dt><dd><p>Actualiza el valor del nodo o nodos seleccionados:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span>$ xmlstarlet ed -u &#39;//profesor[1]/apelativo&#39; -v &quot;Manolo&quot; casilleros.xml
</pre></div>
</div>
</dd>
<dt><code class="code docutils literal notranslate"><span class="pre">-i</span> <span class="pre">&lt;expresión-xpath&gt;</span> <span class="pre">-t</span> <span class="pre">(elem|text|attr)</span> <span class="pre">-n</span> <span class="pre">&lt;nombre&gt;</span> <span class="pre">-v</span> <span class="pre">&lt;valor&gt;</span></code></dt><dd><p>Permite insertar antes del nodo seleccionado (o los nodos) un nodo de tipo
elemento, texto o atributo del nombre y valor referidos. Se deben hacer
varias puntualizaciones:</p>
<ul class="simple">
<li><p>Los nodos de texto no tienen nombre, así que da igual el nombre que se les
dé.</p></li>
<li><p>El valor sólo puede ser texto, así que, directamente, sólo se pueden crear
nodos elemento que contienen texto.</p></li>
<li><p>Si se quiere crear nodos elemento que tienen atributos o contienen otros
nodos elemento, entonces hay que componer varias acciones.</p></li>
</ul>
<p>Por ejemplo, esto añadiría un nuevo apelativo al primer profesor:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span>$ xmlstarlet ed -i &#39;//profesor[1]/nombre&#39; -t elem -n &quot;apelativo&quot; -v &quot;Pancho&quot; casilleros.xml
</pre></div>
</div>
</dd>
<dt><code class="code docutils literal notranslate"><span class="pre">-a</span> <span class="pre">&lt;expresión-xpath&gt;</span> <span class="pre">-t</span> <span class="pre">(elem|text|attr)</span> <span class="pre">-n</span> <span class="pre">nombre</span> <span class="pre">-v</span> <span class="pre">valor</span></code></dt><dd><p>Como  <code class="docutils literal notranslate"><span class="pre">-i</span></code> pero añade el nodo después, no antes. Por ejemplo:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span>$ xmlstarlet ed -a &#39;//profesor[1]/apelativo[last()]&#39; -t elem -n &quot;apelativo&quot; -v &quot;Pancho&quot; casilleros.xml
</pre></div>
</div>
</dd>
<dt><code class="code docutils literal notranslate"><span class="pre">-s</span> <span class="pre">&lt;expresión-xpath&gt;</span> <span class="pre">-t</span> <span class="pre">(elemen|text|attr)</span> <span class="pre">-n</span> <span class="pre">nombre</span> <span class="pre">-v</span> <span class="pre">valor</span></code></dt><dd><p>Añade el nuevo elemento como último elemento del elemento seleccionado:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span>$ xmlstarlet ed -s &#39;//profesor[2]/nombre&#39; -t text -n foo -v &quot; María&quot; casilleros.xml
</pre></div>
</div>
</dd>
</dl>
<div class="admonition note">
<p class="admonition-title">Nota</p>
<p>Las transformaciones que podemos hacer de este modo son bastante
limitadas. Un mecanismo más apropiado para realizarlas es usar <span class="xref std std-ref">XSLT</span>.</p>
</div>
</section>
</section>
</section>
<section id="sintaxis">
<h2><span class="section-number">3.1.1.2. </span>Sintaxis<a class="headerlink" href="#sintaxis" title="Enlace permanente a este encabezado">¶</a></h2>
<p>Una expresión <em>XPath</em> es, simplemente, una expresión evaluable que devuelve un
resultado. Por lo general, dentro de esta expresión se refieron nodos del <abbr title="eXtensible  Markup Language">XML</abbr>,
pero no necesariamente. Ésta es una expresión <em>XPath</em> perfectamente válida:</p>
<div class="highlight-xquery notranslate"><div class="highlight"><pre><span></span><span class="mi">1</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mi">1</span>
</pre></div>
</div>
<p>¿Es <strong>1</strong>  igual a <strong>1</strong>?  Al ser una tautología, la respuesta es obviamente
verdadera, así que el resultado de esa expresión será <code class="docutils literal notranslate"><span class="pre">true</span></code>. Cuando
involucramos nodos en la expresión:</p>
<div class="highlight-xquery notranslate"><div class="highlight"><pre><span></span><span class="p">/</span><span class="nt">nodo1</span><span class="p">/</span><span class="nt">nodo2</span><span class="p">/</span><span class="nt">nodo3</span>
</pre></div>
</div>
<p>se advierte mejor la analogía entre <em>XPath</em> y las rutas de archivos. En este
caso, la evaluación de expresión devolverá todos los <em>nodo3</em> incluídos dentro de
los <em>nodo2</em> incluidos dentro del <em>nodo1</em>.  O sea, lo mismo que devolvería una
ruta de archivos con la salvedad de que los directorios son únicos y no se
podría devolver varios.</p>
<p>Traigamos el ejemplo del claustro de profesores para ilustrar las rutas que
expresemos a continuación:</p>
<details class="sd-sphinx-override sd-dropdown sd-card sd-mb-3">
<summary class="sd-summary-title sd-card-header">
XML de casilleros<div class="sd-summary-down docutils">
<svg version="1.1" width="1.5em" height="1.5em" class="sd-octicon sd-octicon-chevron-down" viewBox="0 0 24 24" aria-hidden="true"><path fill-rule="evenodd" d="M5.22 8.72a.75.75 0 000 1.06l6.25 6.25a.75.75 0 001.06 0l6.25-6.25a.75.75 0 00-1.06-1.06L12 14.44 6.28 8.72a.75.75 0 00-1.06 0z"></path></svg></div>
<div class="sd-summary-up docutils">
<svg version="1.1" width="1.5em" height="1.5em" class="sd-octicon sd-octicon-chevron-up" viewBox="0 0 24 24" aria-hidden="true"><path fill-rule="evenodd" d="M18.78 15.28a.75.75 0 000-1.06l-6.25-6.25a.75.75 0 00-1.06 0l-6.25 6.25a.75.75 0 101.06 1.06L12 9.56l5.72 5.72a.75.75 0 001.06 0z"></path></svg></div>
</summary><div class="sd-summary-content sd-card-body docutils">
<div class="highlight-xml notranslate"><div class="highlight"><pre><span></span><span class="cp">&lt;?xml version=&quot;1.0&quot; encoding=&quot;UTF-8&quot;?&gt;</span>
<span class="cp">&lt;!DOCTYPE claustro SYSTEM &quot;casilleros.dtd&quot;&gt;</span>

<span class="nt">&lt;claustro</span><span class="w"> </span><span class="na">centro=</span><span class="s">&quot;IES Pepe Botella&quot;</span><span class="nt">&gt;</span>
<span class="w">   </span><span class="nt">&lt;profesor</span><span class="w"> </span><span class="na">id=</span><span class="s">&quot;p1&quot;</span><span class="nt">&gt;</span>
<span class="w">      </span><span class="nt">&lt;apelativo&gt;</span>Luis<span class="nt">&lt;/apelativo&gt;</span>
<span class="w">      </span><span class="nt">&lt;nombre&gt;</span>Luis<span class="nt">&lt;/nombre&gt;</span>
<span class="w">      </span><span class="nt">&lt;apellidos&gt;</span>Márquez<span class="w"> </span>Vázquez<span class="nt">&lt;/apellidos&gt;</span>
<span class="w">      </span><span class="nt">&lt;departamento&gt;</span><span class="ni">&amp;EFI;</span><span class="nt">&lt;/departamento&gt;</span>
<span class="w">   </span><span class="nt">&lt;/profesor&gt;</span>

<span class="w">   </span><span class="nt">&lt;profesor</span><span class="w"> </span><span class="na">id=</span><span class="s">&quot;p13&quot;</span><span class="nt">&gt;</span>
<span class="w">      </span><span class="nt">&lt;apelativo&gt;</span>Cristina<span class="nt">&lt;/apelativo&gt;</span>
<span class="w">      </span><span class="nt">&lt;nombre&gt;</span>María<span class="w"> </span>Cristina<span class="nt">&lt;/nombre&gt;</span>
<span class="w">      </span><span class="nt">&lt;apellidos&gt;</span>Prieto<span class="w"> </span>Monagas<span class="nt">&lt;/apellidos&gt;</span>
<span class="w">      </span><span class="nt">&lt;departamento&gt;</span><span class="ni">&amp;ByG;</span><span class="nt">&lt;/departamento&gt;</span>
<span class="w">   </span><span class="nt">&lt;/profesor&gt;</span>

<span class="w">   </span><span class="cm">&lt;!-- Si se sustituye a sí mismo es que está de baja --&gt;</span>

<span class="w">   </span><span class="nt">&lt;profesor</span><span class="w"> </span><span class="na">id=</span><span class="s">&quot;p15&quot;</span><span class="nt">&gt;</span>
<span class="w">      </span><span class="nt">&lt;apelativo&gt;</span>Manolo<span class="nt">&lt;/apelativo&gt;</span>
<span class="w">      </span><span class="nt">&lt;nombre&gt;</span>Manuel<span class="nt">&lt;/nombre&gt;</span>
<span class="w">      </span><span class="nt">&lt;apellidos&gt;</span>Páez<span class="w"> </span>Robledo<span class="nt">&lt;/apellidos&gt;</span>
<span class="w">      </span><span class="nt">&lt;departamento&gt;</span><span class="ni">&amp;MAT;</span><span class="nt">&lt;/departamento&gt;</span>
<span class="w">   </span><span class="nt">&lt;/profesor&gt;</span>

<span class="w">   </span><span class="cm">&lt;!-- Profesor con casillero(s) adicional(es) --&gt;</span>

<span class="w">   </span><span class="nt">&lt;profesor</span><span class="w"> </span><span class="na">id=</span><span class="s">&quot;p17&quot;</span><span class="w"> </span><span class="na">casillero=</span><span class="s">&quot;17 43&quot;</span><span class="nt">&gt;</span>
<span class="w">      </span><span class="nt">&lt;apelativo&gt;</span>Lucía<span class="nt">&lt;/apelativo&gt;</span>
<span class="w">      </span><span class="nt">&lt;nombre&gt;</span>Lucía<span class="nt">&lt;/nombre&gt;</span>
<span class="w">      </span><span class="nt">&lt;apellidos&gt;</span>Gálvez<span class="w"> </span>Ruiz<span class="nt">&lt;/apellidos&gt;</span>
<span class="w">      </span><span class="nt">&lt;departamento&gt;</span><span class="ni">&amp;ING;</span><span class="nt">&lt;/departamento&gt;</span>
<span class="w">   </span><span class="nt">&lt;/profesor&gt;</span>

<span class="w">   </span><span class="cm">&lt;!-- En principio, si el casillero está vacío</span>
<span class="cm">        la aplicación les asigna el que indica su identificador,</span>
<span class="cm">        pero se puede asignar uno distinto.</span>
<span class="cm">    --&gt;</span>

<span class="w">   </span><span class="nt">&lt;profesor</span><span class="w"> </span><span class="na">id=</span><span class="s">&quot;p28&quot;</span><span class="w"> </span><span class="na">casillero=</span><span class="s">&quot;28&quot;</span><span class="nt">&gt;</span>
<span class="w">      </span><span class="nt">&lt;apelativo&gt;</span>Miguel<span class="w"> </span>Ángel<span class="nt">&lt;/apelativo&gt;</span>
<span class="w">      </span><span class="nt">&lt;nombre&gt;</span>Miguel<span class="w"> </span>Ángel<span class="nt">&lt;/nombre&gt;</span>
<span class="w">      </span><span class="nt">&lt;apellidos&gt;</span>Campos<span class="w"> </span>Sánchez<span class="nt">&lt;/apellidos&gt;</span>
<span class="w">      </span><span class="nt">&lt;departamento&gt;</span><span class="ni">&amp;HIS;</span><span class="nt">&lt;/departamento&gt;</span>
<span class="w">   </span><span class="nt">&lt;/profesor&gt;</span>

<span class="w">   </span><span class="nt">&lt;profesor</span><span class="w"> </span><span class="na">id=</span><span class="s">&quot;p81&quot;</span><span class="w"> </span><span class="na">casillero=</span><span class="s">&quot;&quot;</span><span class="nt">&gt;</span>
<span class="w">      </span><span class="nt">&lt;apelativo&gt;</span>Verónica<span class="nt">&lt;/apelativo&gt;</span>
<span class="w">      </span><span class="nt">&lt;nombre&gt;</span>Verónica<span class="nt">&lt;/nombre&gt;</span>
<span class="w">      </span><span class="nt">&lt;apellidos&gt;</span>Martín<span class="w"> </span>Díaz<span class="nt">&lt;/apellidos&gt;</span>
<span class="w">      </span><span class="nt">&lt;departamento&gt;</span><span class="ni">&amp;ByG;</span><span class="nt">&lt;/departamento&gt;</span>
<span class="w">   </span><span class="nt">&lt;/profesor&gt;</span>

<span class="w">   </span><span class="cm">&lt;!-- Profesor sustituto --&gt;</span>

<span class="w">   </span><span class="nt">&lt;profesor</span><span class="w"> </span><span class="na">id=</span><span class="s">&quot;p86&quot;</span><span class="w"> </span><span class="na">sustituye=</span><span class="s">&quot;p13&quot;</span><span class="nt">&gt;</span>
<span class="w">      </span><span class="nt">&lt;apelativo&gt;</span>Roberto<span class="nt">&lt;/apelativo&gt;</span>
<span class="w">      </span><span class="nt">&lt;nombre&gt;</span>Roberto<span class="nt">&lt;/nombre&gt;</span>
<span class="w">      </span><span class="nt">&lt;apellidos&gt;</span>Mínguez<span class="w"> </span>Torralbo<span class="nt">&lt;/apellidos&gt;</span>
<span class="w">   </span><span class="nt">&lt;/profesor&gt;</span>
<span class="nt">&lt;/claustro&gt;</span>
</pre></div>
</div>
</div>
</details><p>En este caso, la expresión:</p>
<div class="highlight-xquery notranslate"><div class="highlight"><pre><span></span><span class="p">/</span><span class="nt">claustro</span>
</pre></div>
</div>
<p>representa el nodo <em>claustro</em>.</p>
<div class="admonition note">
<p class="admonition-title">Nota</p>
<p>En <em>XPath</em> el nodo <em>claustro</em> no es el nodo raíz, sino «/», de ahí que
la expresión <code class="code docutils literal notranslate"><span class="pre">/claustro</span></code> indique el nodo claustro que es inmediatamente
hijo del nodo raíz. Por ese motivo, si este es el documento <abbr title="eXtensible  Markup Language">XML</abbr>:</p>
<div class="highlight-xml notranslate"><div class="highlight"><pre><span></span><span class="cp">&lt;?xml version=&quot;1.0&quot; encoding=&quot;utf-8&quot;?&gt;</span>
<span class="cm">&lt;!-- Este es un ejemplo de documento XML --&gt;</span>
<span class="nt">&lt;grafico</span><span class="w"> </span><span class="na">unidades=</span><span class="s">&quot;cm&quot;</span><span class="nt">&gt;</span>
<span class="w">   </span><span class="nt">&lt;punto</span><span class="w"> </span><span class="na">id=</span><span class="s">&quot;p01&quot;</span><span class="nt">&gt;</span>
<span class="w">      </span><span class="nt">&lt;x&gt;</span>4<span class="nt">&lt;/x&gt;</span>
<span class="w">      </span><span class="nt">&lt;y&gt;</span>10<span class="nt">&lt;/y&gt;</span>
<span class="w">   </span><span class="nt">&lt;/punto&gt;</span>
<span class="nt">&lt;/grafico&gt;</span>
</pre></div>
</div>
<p>La expresión:</p>
<div class="highlight-xquery notranslate"><div class="highlight"><pre><span></span><span class="p">/</span><span class="nt">claustro</span>
</pre></div>
</div>
<p>devuelve, exclusivamente, el nodo claustro, mientras que la expresión</p>
<div class="highlight-xquery notranslate"><div class="highlight"><pre><span></span><span class="p">/</span>
</pre></div>
</div>
<p>devuelve también el nodo comentario (<code class="code docutils literal notranslate"><span class="pre">&lt;!--</span> <span class="pre">Este</span> <span class="pre">es</span> <span class="pre">un</span> <span class="pre">ejemplo</span> <span class="pre">de</span> <span class="pre">documento</span> <span class="pre">XML</span> <span class="pre">--&gt;</span></code>).</p>
</div>
<p>Por su parte, la expresión:</p>
<div class="highlight-xquery notranslate"><div class="highlight"><pre><span></span><span class="p">/</span><span class="nt">claustro</span><span class="p">/</span><span class="nt">profesor</span>
</pre></div>
</div>
<p>representa todos los nodos <em>profesor</em> que son hijos de <em>claustro</em>.  Es posible
también hacer referencia a descendientes no directos como en:</p>
<div class="highlight-xquery notranslate"><div class="highlight"><pre><span></span><span class="p">/</span><span class="nt">claustro</span><span class="p">//</span><span class="nt">nombre</span>
</pre></div>
</div>
<p>en que seleccionamos todos los nodos <em>nombre</em> que son descendientes de claustro.
Para este caso particular, obtenemos los nombres de todos profesores que
pertenecen al claustro. Otro ejemplo podría ser:</p>
<div class="highlight-xquery notranslate"><div class="highlight"><pre><span></span><span class="p">//</span><span class="nt">profesor</span>
</pre></div>
</div>
<p>Del mismo modo que en las rutas de archivos existen rutas relativas, en las
rutas <em>XPath</em> también existen, y del mismo modo que puede surgir la necesidad de
seleccionar un directorio o archivo cuando nos encontramos trabajando en otro
directorio, es posible que necesitemos hacer referencia a otros nodos, cuando
nos encontramos procesando un determinado nodo. Para las rutas relativas, como
en el caso de los archivos, se usa el punto (<code class="docutils literal notranslate"><span class="pre">.</span></code>), que significa este nodo, y
dos puntos seguidos (<code class="docutils literal notranslate"><span class="pre">..</span></code>), que significan el nodo padre. Así pues, si
estuviésemos procesando un determinado nodo <em>profesor</em>, la ruta:</p>
<div class="highlight-xquery notranslate"><div class="highlight"><pre><span></span><span class="p">./</span><span class="nt">nombre</span>
</pre></div>
</div>
<p>o, simplemente:</p>
<div class="highlight-xquery notranslate"><div class="highlight"><pre><span></span><span class="nt">nombre</span>
</pre></div>
</div>
<p>representaría el nodo <em>nombre</em> de ese profesor; mientras que, si procesando el
nodo <em>apelativo</em> de un procesor, hacemos referencia a:</p>
<div class="highlight-xquery notranslate"><div class="highlight"><pre><span></span><span class="p">../</span><span class="nt">nombre</span>
</pre></div>
</div>
<p>haremos referencia al nombre del profesor cuyo nodo estuviéramos procesando. En
realidad la expresión del nodo es algo más complicada que indicar simplemente su
nombre como introdujimos antes:</p>
<div class="highlight-xquery notranslate"><div class="highlight"><pre><span></span><span class="p">/</span><span class="nt">nodo1</span><span class="p">/</span><span class="nt">nodo2</span><span class="p">/</span><span class="nt">nodo3</span>
</pre></div>
</div>
<p>Cada paso de la ruta tiene, en realidad, la siguiente estructura completa:</p>
<div class="highlight-xquery notranslate"><div class="highlight"><pre><span></span><span class="nt">eje</span><span class="p">::</span><span class="nt">filtro</span><span class="p">[</span><span class="nt">predicado</span><span class="p">]</span>
</pre></div>
</div>
<div class="admonition warning">
<p class="admonition-title">Advertencia</p>
<p>Antes de proseguir es importante hacer una aclaración
terminológica. Hasta ahora es posible que hubiéramos tratado los términos
«<em>nodo</em>» y «<em>elemento</em>» como sinónimos. Pero ello no es así: un
<em class="dfn">elemento</em>, en realidad, es un tipo de <em>nodo</em> llamado <em>nodo elemento</em>.
<em>Nodo</em> es un término más general que engloba también otros tipos de nodos:
los <em>atributos</em>, que son <em>nodos atributo</em>; los <em>comentarios</em>, que son <em>nodos
comentario</em>; el texto, que son <em>nodos texto</em>, etc.</p>
</div>
<section id="filtros">
<h3><span class="section-number">3.1.1.2.1. </span>Filtros<a class="headerlink" href="#filtros" title="Enlace permanente a este encabezado">¶</a></h3>
<p>El <em class="dfn">filtro</em> es aquella parte de la ruta <em>XPath</em> que expresa qué nodo o nodos
quieren referirse con tal ruta. Puede ser:</p>
<dl>
<dt><strong>QName</strong></dt><dd><p>Selecciona nodos elemento por nombre. Por ejemplo:</p>
<div class="highlight-xquery notranslate"><div class="highlight"><pre><span></span><span class="p">/</span><span class="nt">claustro</span>
</pre></div>
</div>
<p>selecciona el nodo <em>claustro</em>.</p>
</dd>
<dt><strong>*</strong></dt><dd><p>Selecciona todos los nodos elemento, sea cual sea su nombre. Por ejemplo:</p>
<div class="highlight-xquery notranslate"><div class="highlight"><pre><span></span><span class="p">/</span><span class="nt">claustro</span><span class="p">/</span><span class="nt">profesor</span><span class="p">[</span><span class="mi">1</span><span class="p">]/</span><span class="nt">*</span>
</pre></div>
</div>
<p>selecciona los elementos <em>apelativo</em>, <em>nombre</em>, <em>apellidos</em> y <em>departamento</em>
hijos del primer profesor.</p>
<div class="admonition note" id="xpath-element">
<p class="admonition-title">Nota</p>
<p>A partir de XPath 2.0, existe <code class="docutils literal notranslate"><span class="pre">element()</span></code> que tiene el mismo
efecto:</p>
<div class="highlight-xquery notranslate"><div class="highlight"><pre><span></span><span class="p">/</span><span class="nt">claustro</span><span class="p">/</span><span class="nt">profesor</span><span class="p">[</span><span class="mi">1</span><span class="p">]/</span><span class="nf">element</span><span class="p">()</span>
</pre></div>
</div>
<p>La función permite expresar el nombre del elemento:</p>
<div class="highlight-xquery notranslate"><div class="highlight"><pre><span></span><span class="p">/</span><span class="nt">claustro</span><span class="p">/</span><span class="nt">profesor</span><span class="p">[</span><span class="mi">1</span><span class="p">]/</span><span class="nf">element</span><span class="p">(</span><span class="nt">apodo</span><span class="p">)</span>
</pre></div>
</div>
<p>lo que sería equivalente a haber usado directamente el nombre. Sin
embargo, si el procesador es capaz de validar con una gramática el
documento, entonces conocerá el tipo de dato que almacena y puede
filtrarse por tipo de valor:</p>
<div class="highlight-xquery notranslate"><div class="highlight"><pre><span></span><span class="p">/</span><span class="nt">claustro</span><span class="p">/</span><span class="nt">profesor</span><span class="p">[</span><span class="mi">1</span><span class="p">]/</span><span class="nf">element</span><span class="p">(</span><span class="nt">*</span><span class="p">,</span><span class="w"> </span><span class="nt">xs:integer</span><span class="p">)</span>
</pre></div>
</div>
</div>
</dd>
<dt><strong>text()</strong></dt><dd><p>Selecciona los nodos de texto. Por ejemplo:</p>
<div class="highlight-xquery notranslate"><div class="highlight"><pre><span></span><span class="p">/</span><span class="nt">claustro</span><span class="p">/</span><span class="nt">profesor</span><span class="p">[</span><span class="mi">1</span><span class="p">]/</span><span class="nt">nombre</span><span class="p">/</span><span class="nf">text</span><span class="p">()</span>
</pre></div>
</div>
<p>devuelve exclusivamente la cadena «<em>José</em>», mientras que la expresión:</p>
<div class="highlight-xquery notranslate"><div class="highlight"><pre><span></span><span class="p">/</span><span class="nt">claustro</span><span class="p">/</span><span class="nt">profesor</span><span class="p">[</span><span class="mi">1</span><span class="p">]/</span><span class="nt">nombre</span>
</pre></div>
</div>
<p>devuelve el nodo <em>nombre</em>, esto es:</p>
<div class="highlight-xml notranslate"><div class="highlight"><pre><span></span><span class="nt">&lt;nombre&gt;</span>José<span class="nt">&lt;/nombre&gt;</span>
</pre></div>
</div>
<div class="admonition note">
<p class="admonition-title">Nota</p>
<p>Nótese que a efectos de su definición gramatical este nodo:</p>
<div class="highlight-xml notranslate"><div class="highlight"><pre><span></span><span class="nt">&lt;profesor</span><span class="w"> </span><span class="na">id=</span><span class="s">&quot;p1&quot;</span><span class="w"> </span><span class="na">sexo=</span><span class="s">&quot;hombre&quot;</span><span class="nt">&gt;</span>
<span class="w">   </span><span class="nt">&lt;apelativo&gt;</span>Pepe<span class="nt">&lt;/apelativo&gt;</span>
<span class="w">   </span><span class="nt">&lt;nombre&gt;</span>José<span class="nt">&lt;/nombre&gt;</span>
<span class="w">   </span><span class="nt">&lt;apellidos&gt;</span>Suárez<span class="w"> </span>Lantilla<span class="nt">&lt;/apellidos&gt;</span>
<span class="w">   </span><span class="nt">&lt;departamento&gt;</span><span class="ni">&amp;ING;</span><span class="nt">&lt;/departamento&gt;</span>
<span class="nt">&lt;/profesor&gt;</span>
</pre></div>
</div>
<p>y este otro:</p>
<div class="highlight-xml notranslate"><div class="highlight"><pre><span></span><span class="nt">&lt;profesor</span><span class="w"> </span><span class="na">id=</span><span class="s">&quot;p1&quot;</span><span class="w"> </span><span class="na">sexo=</span><span class="s">&quot;hombre&quot;</span><span class="nt">&gt;&lt;apelativo&gt;</span>Pepe<span class="nt">&lt;/apelativo&gt;&lt;nombre&gt;</span>José<span class="nt">&lt;/nombre&gt;&lt;apellidos&gt;</span>Suárez<span class="w"> </span>Lantilla<span class="nt">&lt;/apellidos&gt;&lt;departamento&gt;</span><span class="ni">&amp;ING;</span><span class="nt">&lt;/departamento&gt;&lt;/profesor&gt;</span>
</pre></div>
</div>
<p>son equivalentes: un nodo <em>profesor</em> que contiene cuatro nodos elemento:
<em>apelativo</em>, <em>nombre</em>, <em>apellidos</em> y <em>departamento</em>. En cambio, para <em>XPath</em>
la primera expresión de <em>profesor</em> contiene nodos texto entre los
nodo elementos, cada uno de los cuales contiene, siemplemente, caracteres
de espaciado.</p>
</div>
</dd>
<dt><strong>node()</strong></dt><dd><p>Todos los nodos, sean del tipo que sean. Por ejemplo:</p>
<div class="highlight-xquery notranslate"><div class="highlight"><pre><span></span><span class="p">/</span><span class="nt">claustro</span><span class="p">/</span><span class="nf">node</span><span class="p">()</span>
</pre></div>
</div>
<p>selecciona todos los nodo <em>profesor</em> y todos los nodos texto hijo,
consecuencia de haber sangrado tan bien el documento.</p>
<div class="admonition note">
<p class="admonition-title">Nota</p>
<p>En cambio:</p>
<div class="highlight-xquery notranslate"><div class="highlight"><pre><span></span><span class="p">/</span><span class="nt">claustro</span><span class="p">/</span><span class="nt">*</span>
</pre></div>
</div>
<p>selecciona exclusivamente los nodos <em>profesor</em>.</p>
</div>
</dd>
<dt><strong>comment()</strong></dt><dd><p>Todos los nodos que sean comentarios:</p>
<div class="highlight-xquery notranslate"><div class="highlight"><pre><span></span><span class="p">/</span><span class="nt">claustro</span><span class="p">/</span><span class="nf">comment</span><span class="p">()</span>
</pre></div>
</div>
</dd>
<dt><strong>&#64;atributo</strong></dt><dd><p>Selecciona el atributo con el nombre expresado. Por ejemplo:</p>
<div class="highlight-xquery notranslate"><div class="highlight"><pre><span></span><span class="p">/</span><span class="nt">claustro</span><span class="p">/</span><span class="nt">profesor</span><span class="p">/</span><span class="na">@sexo</span>
</pre></div>
</div>
<p>refiero los sexos de todos los profesores.</p>
</dd>
<dt><strong>&#64;*</strong></dt><dd><p>Selecciona todos los atributos:</p>
<div class="highlight-xquery notranslate"><div class="highlight"><pre><span></span><span class="p">/</span><span class="nt">claustro</span><span class="p">/</span><span class="nt">profesor</span><span class="p">/</span><span class="na">@*</span>
</pre></div>
</div>
<div class="admonition note">
<p class="admonition-title">Nota</p>
<p>A partir de XPath 2, puede usarse la función <code class="docutils literal notranslate"><span class="pre">attribute()</span></code> con
idéntico fin y que admite <a class="reference internal" href="#xpath-element"><span class="std std-ref">argumentos como element()</span></a>.</p>
</div>
</dd>
<dt><strong>processing-instruction()</strong></dt><dd><p>Todas las instrucciones de procesamiento. Por ejemplo:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="o">..</span> <span class="n">code</span><span class="o">-</span><span class="n">block</span><span class="p">::</span> <span class="n">xquery</span>
</pre></div>
</div>
<blockquote>
<div><p>“//procesing-instruction()”</p>
</div></blockquote>
<p>selecciona todas las instrucciones de procesamiento del documento.</p>
</dd>
<dt><strong>processing-instruction(destino)</strong></dt><dd><p>Todas las instrucciones de procesamiento cuyo destino sea el indicado. El
<em class="dfn">destino</em> es la palabra adyacente al signo «?».</p>
</dd>
</dl>
<div class="admonition note">
<p class="admonition-title">Nota</p>
<p>Obsérvese que estas expresiones responden a cuáles son los siete tipos de
nodos que el modelo de datos de <em>XPath</em> define:</p>
<ol class="arabic simple">
<li><p>Nodo de documento (o nodo raíz)</p></li>
<li><p>Nodo elemento.</p></li>
<li><p>Nodo texto.</p></li>
<li><p>Nodo atributo.</p></li>
<li><p>Nodo de espacio de nombres.</p></li>
<li><p>Nodo de instrucción de procesamiento.</p></li>
<li><p>Nodo comentario.</p></li>
</ol>
<p>De entre estos siete tipos, dos (los nodos texto y los nodos atributo) pueden
a su ver estar tipados de distinta forma (ser cadenas, ser números, etc.).
Más adelaten profundizaremos en ello.</p>
</div>
<p id="xpath1-union"><em>XPath</em> permite <strong>agregar rutas</strong> de manera que los nodos seleccionados sean la
unión de los nodos que seleccionan las distintas rutas. Para ello, usa el
operador «<kbd class="kbd docutils literal notranslate">|</kbd>»:</p>
<div class="highlight-xquery notranslate"><div class="highlight"><pre><span></span><span class="p">//</span><span class="nt">profesor</span><span class="p">/</span><span class="nt">apelativo</span><span class="w"> </span><span class="o">|</span><span class="w"> </span><span class="p">//</span><span class="nt">profesor</span><span class="p">/</span><span class="nt">nombre</span>
</pre></div>
</div>
<p>selecciona todos los nodos <em>apelativo</em> y <em>nombre</em> de todos los profesores.</p>
</section>
<section id="ejes">
<h3><span class="section-number">3.1.1.2.2. </span>Ejes<a class="headerlink" href="#ejes" title="Enlace permanente a este encabezado">¶</a></h3>
<p>El <em class="dfn">eje</em> es la parte de la ruta <em>XPath</em> que determina el sentido que se
tomará al interpretar la siguiente parte de la ruta. Recordemos que, si nos
encontramos procesando un nodo y queremos referirnos a otro, podemos buscar
entre sus descendientes, entre sus ascendientes o entre sus hermanos.</p>
<table class="tb-eje docutils align-default" id="id12">
<caption><span class="caption-text"><strong>Ejes en XPath</strong></span><a class="headerlink" href="#id12" title="Enlace permanente a esta tabla">¶</a></caption>
<thead>
<tr class="row-odd"><th class="head"><p>Sentido</p></th>
<th class="head"><p>Nombre</p></th>
<th class="head"><p>Abreviatura</p></th>
<th class="head"><p>Ejemplo</p></th>
<th class="head"><p>Descripción</p></th>
</tr>
</thead>
<tbody>
<tr class="row-even"><td rowspan="7"><p>Descendente</p></td>
<td><p>child</p></td>
<td></td>
<td><div class="line-block">
<div class="line">/claustro/profesor</div>
<div class="line">/claustro/child::profesor</div>
</div>
</td>
<td><p>Selecciona hijos.</p></td>
</tr>
<tr class="row-odd"><td><p>descendent</p></td>
<td><p>/</p></td>
<td><div class="line-block">
<div class="line">/claustro//apelativo</div>
<div class="line">/claustro/descendent::apelativo</div>
</div>
</td>
<td><p>Selecciona descendientes.</p></td>
</tr>
<tr class="row-even"><td><p>self</p></td>
<td><p>.</p></td>
<td><div class="line-block">
<div class="line">/claustro/.</div>
<div class="line">/claustro//self::*</div>
</div>
</td>
<td><p>Selecciona el propio nodo.</p></td>
</tr>
<tr class="row-odd"><td colspan="2"><p>descendent-or-self</p></td>
<td><p>/claustro/descendent-or-self::*</p></td>
<td><p>Selecciona descendientes o el propio nodo</p></td>
</tr>
<tr class="row-even"><td colspan="2"><p>following-sibling</p></td>
<td><p>//profesor[1]/following-sibling::profesor</p></td>
<td><p>Selecciona los hermanos posteriores</p></td>
</tr>
<tr class="row-odd"><td colspan="2"><p>following</p></td>
<td><p>//profesor[1]/following::*</p></td>
<td><p>Selecciona los nodos posteriores</p></td>
</tr>
<tr class="row-even"><td><p>attribute</p></td>
<td><p>&#64;</p></td>
<td><div class="line-block">
<div class="line">//profesor/&#64;sexo</div>
<div class="line">//profesor/attribute::sexo</div>
</div>
</td>
<td><p>Selecciona atributo (puede usarse
<code class="docutils literal notranslate"><span class="pre">&#64;*</span></code>)</p></td>
</tr>
<tr class="row-odd"><td rowspan="5"><p>Ascendente</p></td>
<td><p>parent</p></td>
<td><p>..</p></td>
<td><div class="line-block">
<div class="line">//profesor[1]/apelativo/..</div>
<div class="line">//profesor[1]/apelativo/parent::*</div>
</div>
</td>
<td><p>Selecciona el nodo padre.</p></td>
</tr>
<tr class="row-even"><td colspan="2"><p>ancestor</p></td>
<td><div class="line-block">
<div class="line">//profesor[1]/apelativo/ancestor::*</div>
</div>
</td>
<td><p>Selecciona ascendientes.</p></td>
</tr>
<tr class="row-odd"><td colspan="2"><p>ancestor-or-self</p></td>
<td><p>//profesor[1]/apelativo/ancestor-or-self::*</p></td>
<td><p>Seleccioa ascendientes o el propio nodo</p></td>
</tr>
<tr class="row-even"><td colspan="2"><p>preceding</p></td>
<td><p>//profesor[2]/nombre/preceding::nombre</p></td>
<td><p>Selecciona nodos anteriores</p></td>
</tr>
<tr class="row-odd"><td colspan="2"><p>preceding-sibling</p></td>
<td><p>//profesor[2]/nombre/preceding-sibling::*</p></td>
<td><p>Selecciona los hermanos anteriores</p></td>
</tr>
</tbody>
</table>
</section>
<section id="predicados">
<h3><span class="section-number">3.1.1.2.3. </span>Predicados<a class="headerlink" href="#predicados" title="Enlace permanente a este encabezado">¶</a></h3>
<p>El <em class="dfn">predicado</em> es la parte de la ruta que permite añadir condiciones al
filtro al que acompaña y se escribe entre corchetes. Por ejemplo:</p>
<div class="highlight-xquery notranslate"><div class="highlight"><pre><span></span><span class="p">//</span><span class="nt">profesor</span><span class="p">[</span><span class="na">@sexo</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s1">&#39;hombre&#39;</span><span class="p">]</span>
</pre></div>
</div>
<div class="admonition note">
<p class="admonition-title">Nota</p>
<p>En <em>XPath</em> las cadenas pueden notarse indistintamente con comillas
simples o con comillas dobles.</p>
</div>
<p>selecciona, entre todos los nodos <em>profesor</em>, sólo los que representan
profesores varones.</p>
<p>Dos son aspectos fundamentales a la hora de componer un predicado:</p>
<ul class="simple">
<li><p>Al representar el predicado una condición, la expresión se evalúa a verdadero
o falso. En el ejemplo, comprobábamos unas igualdad.</p></li>
<li><p>Las rutas <em>XPath</em> expresadas dentro del predicado, si son relativas, son
relativas al nodo adyacente (<em>profesor</em> en el caso del ejemplo). En
consecuencia, <code class="docutils literal notranslate"><span class="pre">&#64;sexo</span></code> es el atributo <em>sexo</em> del profesor en cuestión.</p></li>
</ul>
<div class="admonition note">
<p class="admonition-title">Nota</p>
<p>Para poder explicar mejor los predicados supondremos  a lo largo de
estas explicaciones que un <em>profesor</em> puede tener ninguno, uno o varios
apodos, esto es, que su definición usando <abbr title="Document Type Definition">DTD</abbr> es:</p>
<div class="highlight-dtd notranslate"><div class="highlight"><pre><span></span><span class="k">&lt;!ELEMENT</span> <span class="nt">profesor</span> <span class="o">(</span><span class="nt">apelativo</span><span class="o">*,</span> <span class="nt">nombre</span><span class="o">,</span> <span class="nt">apellidos</span><span class="o">,</span> <span class="nt">departamento</span><span class="o">)</span><span class="k">&gt;</span>
</pre></div>
</div>
</div>
<p>Para expresar condiciones necesitamos <em>operadores</em> y <em>funciones</em>, aunque ni unos
ni otras deben forzosamente aparecer dentro de un predicado. Por ejemplo, esto
es una expresión <em>XPath</em> válida:</p>
<div class="highlight-xquery notranslate"><div class="highlight"><pre><span></span><span class="mi">1</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="mi">1</span>
</pre></div>
</div>
<p>que devuelve <strong>2</strong> y esta otra, que devuelve el número de profesores, también:</p>
<div class="highlight-xquery notranslate"><div class="highlight"><pre><span></span><span class="nf">count</span><span class="p">(//</span><span class="nt">profesor</span><span class="p">)</span>
</pre></div>
</div>
<p>Sin embargo, como habitualmente aparecen dentro de predicados las introduciremos
como apartados dentro de este epígrafe.</p>
<section id="operadores">
<h4><span class="section-number">3.1.1.2.3.1. </span>Operadores<a class="headerlink" href="#operadores" title="Enlace permanente a este encabezado">¶</a></h4>
<p>Dentro de los predicados pueden usarse los siguientes operadores:</p>
<span id="xpath-op-arit"></span><table class="docutils align-default" id="id13">
<caption><span class="caption-text"><strong>Operadores aritméticos</strong></span><a class="headerlink" href="#id13" title="Enlace permanente a esta tabla">¶</a></caption>
<thead>
<tr class="row-odd"><th class="head"><p>Operador</p></th>
<th class="head"><p>Significado</p></th>
</tr>
</thead>
<tbody>
<tr class="row-even"><td><p>+</p></td>
<td><p>Suma</p></td>
</tr>
<tr class="row-odd"><td><p>-</p></td>
<td><p>Resta</p></td>
</tr>
<tr class="row-even"><td><p>*</p></td>
<td><p>Multiplicación</p></td>
</tr>
<tr class="row-odd"><td><p>div</p></td>
<td><p>División</p></td>
</tr>
<tr class="row-even"><td><p>mod</p></td>
<td><p>Módulo (resto)</p></td>
</tr>
</tbody>
</table>
<span id="xpath-op-log"></span><table class="docutils align-default" id="id14">
<caption><span class="caption-text"><strong>Operadores lógicos</strong></span><a class="headerlink" href="#id14" title="Enlace permanente a esta tabla">¶</a></caption>
<thead>
<tr class="row-odd"><th class="head"><p>Operador</p></th>
<th class="head"><p>Significado</p></th>
</tr>
</thead>
<tbody>
<tr class="row-even"><td><p>=</p></td>
<td><p>Igualdad</p></td>
</tr>
<tr class="row-odd"><td><p>!=</p></td>
<td><p>Desigualdad</p></td>
</tr>
<tr class="row-even"><td><p>&lt;</p></td>
<td><p>Menor</p></td>
</tr>
<tr class="row-odd"><td><p>&lt;=</p></td>
<td><p>Menor o igual</p></td>
</tr>
<tr class="row-even"><td><p>&gt;</p></td>
<td><p>Mayor</p></td>
</tr>
<tr class="row-odd"><td><p>&gt;=</p></td>
<td><p>Mayor o igual</p></td>
</tr>
<tr class="row-even"><td><p>and</p></td>
<td><p>Conjunción</p></td>
</tr>
<tr class="row-odd"><td><p>or</p></td>
<td><p>Disyunción</p></td>
</tr>
<tr class="row-even"><td><p>not()</p></td>
<td><p>Negación</p></td>
</tr>
</tbody>
</table>
<p><strong>Ejemplos</strong>:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="o">//</span><span class="n">profesor</span><span class="p">[</span><span class="nd">@sexo</span> <span class="o">=</span> <span class="s1">&#39;hombre&#39;</span><span class="p">]</span>
<span class="o">//</span><span class="n">profesor</span><span class="p">[</span><span class="n">nombre</span> <span class="o">!=</span> <span class="s1">&#39;José&#39;</span><span class="p">]</span>
<span class="o">//</span><span class="n">profesor</span><span class="p">[</span><span class="ow">not</span><span class="p">(</span><span class="n">nombre</span> <span class="o">=</span> <span class="s1">&#39;José&#39;</span><span class="p">)]</span>
<span class="o">//</span><span class="n">profesor</span><span class="p">[</span><span class="nd">@sexo</span> <span class="o">=</span> <span class="s1">&#39;hombre&#39;</span> <span class="ow">and</span> <span class="n">departamento</span> <span class="o">=</span> <span class="s1">&#39;Historia&#39;</span><span class="p">]</span>
</pre></div>
</div>
<div class="admonition note">
<p class="admonition-title">Nota</p>
<p>Pueden yuxtaponerse dos predicados y en ese caso deberán cumplirse
ambos predicados. Por tanto, el último ejemplo es equivalente a:</p>
<div class="highlight-xquery notranslate"><div class="highlight"><pre><span></span><span class="p">//</span><span class="nt">profesor</span><span class="p">[</span><span class="na">@sexo</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s1">&#39;hombre&#39;</span><span class="p">][</span><span class="nt">departamento</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s1">&#39;Historia&#39;</span><span class="p">]</span>
</pre></div>
</div>
</div>
</section>
<section id="funciones">
<h4><span class="section-number">3.1.1.2.3.2. </span>Funciones<a class="headerlink" href="#funciones" title="Enlace permanente a este encabezado">¶</a></h4>
<p>Junto a nodos y operadores, en los predicados<a class="footnote-reference brackets" href="#id7" id="id2" role="doc-noteref"><span class="fn-bracket">[</span>1<span class="fn-bracket">]</span></a> también es posible usar
funciones. En el sitio para desarrolladores de <strong class="program">mozilla</strong> puede
consultarse <a class="reference external" href="https://developer.mozilla.org/en-US/docs/Web/XPath/Functions">una relación completa de funciones para XPath 1.0</a>, de las cuales
aquí citaremos algunas muy socorridas:</p>
<dl>
<dt><a class="reference external" href="https://developer.mozilla.org/en-US/docs/Web/XPath/Functions/count">count()</a></dt><dd><p>Cuenta el número de nodos. Por ejemplo, podemos seleccionar los profesores
que tienen más de un apelativo de este modo:</p>
<div class="highlight-xquery notranslate"><div class="highlight"><pre><span></span><span class="p">//</span><span class="nt">profesor</span><span class="p">[</span><span class="nf">count</span><span class="p">(</span><span class="nt">apelativo</span><span class="p">)</span><span class="w"> </span><span class="o">&gt;</span><span class="w"> </span><span class="mi">1</span><span class="p">]</span>
</pre></div>
</div>
</dd>
<dt><a class="reference external" href="https://developer.mozilla.org/en-US/docs/Web/XPath/Functions/local-name">local-name()</a></dt><dd><p>Devuelve el nombre del elemento (sin el espacio de nombres). Si no se incluye
como argumento un nodo, se devuelve el nombre del nodo actual. Por ejemplo:</p>
<div class="highlight-xquery notranslate"><div class="highlight"><pre><span></span><span class="p">//</span><span class="nt">profesor</span><span class="p">/</span><span class="nt">*</span><span class="p">[</span><span class="nf">local-name</span><span class="p">()</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s1">&#39;apelativo&#39;</span><span class="w"> </span><span class="ow">or</span><span class="w"> </span><span class="nf">local-name</span><span class="p">()</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s1">&#39;nombre&#39;</span><span class="p">]</span>
</pre></div>
</div>
<p>selecciona los nodos hijo de profesor que son <em>apelativo</em> o <em>nombre</em>.</p>
<div class="admonition note">
<p class="admonition-title">Nota</p>
<p>Esto mismo hay modos alternativos de lograrlo:</p>
<div class="highlight-xquery notranslate"><div class="highlight"><pre><span></span><span class="p">//</span><span class="nt">profesor</span><span class="p">/</span><span class="nt">*</span><span class="p">[</span><span class="k">self</span><span class="p">::</span><span class="nt">apelativo</span><span class="w"> </span><span class="ow">or</span><span class="w"> </span><span class="k">self</span><span class="p">::</span><span class="nt">nombre</span><span class="p">]</span>
</pre></div>
</div>
<p>o también usando el <a class="reference internal" href="#xpath1-union"><span class="std std-ref">operador de unión</span></a></p>
<div class="highlight-xquery notranslate"><div class="highlight"><pre><span></span><span class="p">//</span><span class="nt">profesor</span><span class="p">/</span><span class="nt">apelativo</span><span class="w"> </span><span class="o">|</span><span class="w"> </span><span class="p">//</span><span class="nt">profesor</span><span class="p">/</span><span class="nt">nombre</span>
</pre></div>
</div>
</div>
</dd>
<dt><a class="reference external" href="https://developer.mozilla.org/en-US/docs/Web/XPath/Functions/not">not()</a></dt><dd><p>Invierte el resultado lógico de la expresión. Ya se trató al hablar de los
operadores.</p>
</dd>
</dl>
<dl id="xpath-position">
<dt><a class="reference external" href="https://developer.mozilla.org/en-US/docs/Web/XPath/Functions/position">position()</a></dt><dd><p>Devuelve la posición del elemento actual. Para seleccionar el segundo
profesor se puede hacer:</p>
<div class="highlight-xquery notranslate"><div class="highlight"><pre><span></span><span class="p">//</span><span class="nt">profesor</span><span class="p">[</span><span class="nf">position</span><span class="p">()</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mi">2</span><span class="p">]</span>
</pre></div>
</div>
<p>que puede simplificarse simplemente a:</p>
<div class="highlight-xquery notranslate"><div class="highlight"><pre><span></span><span class="p">//</span><span class="nt">profesor</span><span class="p">[</span><span class="mi">2</span><span class="p">]</span>
</pre></div>
</div>
<div class="admonition warning">
<p class="admonition-title">Advertencia</p>
<p>A diferencia de lo que suele ocurrir en Informática, el primer
elemento se identifica con la posición <strong>1</strong>, no con la <strong>0</strong>.</p>
</div>
<div class="admonition note">
<p class="admonition-title">Nota</p>
<p>Para indicar el último, puede usarse la función <a class="reference external" href="https://developer.mozilla.org/en-US/docs/Web/XPath/Functions/last">last()</a>.</p>
</div>
</dd>
<dt><a class="reference external" href="https://developer.mozilla.org/en-US/docs/Web/XPath/Functions/sum">sum()</a></dt><dd><p>Suma los nodos que se incluyen como argumento, supuesto que estos sean
números.</p>
</dd>
</dl>
</section>
</section>
</section>
<section id="xpath-1-0">
<h2><span class="section-number">3.1.1.3. </span>XPath 1.0<a class="headerlink" href="#xpath-1-0" title="Enlace permanente a este encabezado">¶</a></h2>
<p>Las aspectos introducidos hasta ahora sobre <em>XPath</em> son generales e
independientes de qué versión utilicemos. Han sido expuestos de forma tan
general que pecan (a sabiendas) de superficialidad y dejan aún muchos aspectos
indefinidos. Por ejemplo, la expresión:</p>
<div class="highlight-xquery notranslate"><div class="highlight"><pre><span></span><span class="p">//</span><span class="nt">profesor</span><span class="p">[</span><span class="na">@casillero</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mi">28</span><span class="p">]</span>
</pre></div>
</div>
<p>¿Funciona o no funciona realmente? Porque quizás es necesario escribir el número
28 entre comillas si el valor del atributo es una cadena. Hay, pues, que afinar
para poder escribir las expresiones con propiedad.</p>
<p>Para empezar hay que aclarar dos aspectos importantes:</p>
<dl id="xpath1-result">
<dt><strong>Resultado</strong></dt><dd><p>esto es, ¿qué devuelve una expresión <em>XPath</em>? En la versión 1.0, se pueden
obtener resultados de dos naturalezas distintas:</p>
<ol class="arabic">
<li><p><em>Valores atómicos</em>, que se devuelven en expresiones como:</p>
<div class="highlight-xquery notranslate"><div class="highlight"><pre><span></span><span class="mi">1</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mi">1</span>
</pre></div>
</div>
<p>o:</p>
<div class="highlight-xquery notranslate"><div class="highlight"><pre><span></span><span class="mi">1</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="mi">1</span>
</pre></div>
</div>
<p>o:</p>
<div class="highlight-xquery notranslate"><div class="highlight"><pre><span></span><span class="nf">count</span><span class="p">(//</span><span class="nt">profesor</span><span class="p">)</span>
</pre></div>
</div>
</li>
<li><p>Un <em>conjunto de nodos</em> (a veces constituido por un solo nodo), que es lo que
devuelven expresiones como:</p>
<div class="highlight-xquery notranslate"><div class="highlight"><pre><span></span><span class="p">//</span><span class="nt">profesor</span><span class="p">/</span><span class="nt">nombre</span>
</pre></div>
</div>
<p>que devuelve un conjunto de nodos elemento, o esta:</p>
<div class="highlight-xquery notranslate"><div class="highlight"><pre><span></span><span class="p">//</span><span class="nt">profesor</span><span class="p">/</span><span class="na">@id</span>
</pre></div>
</div>
<p>que devuelve un conjunto de nodos atributo, o esta:</p>
<div class="highlight-xquery notranslate"><div class="highlight"><pre><span></span><span class="p">//</span><span class="nt">profesor</span><span class="p">[</span><span class="na">@id</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s1">&#39;p28&#39;</span><span class="p">]/</span><span class="na">@casillero</span>
</pre></div>
</div>
<p>que devuelve un conjunto de nodos atributo, constituido por un nodo solo.</p>
<div class="admonition note">
<p class="admonition-title">Nota</p>
<p>Obsérvese que se ha usado la palabra «conjunto» y no
«secuencia». Es importante el matiz, porque las secuencias ordenan sus
elementos, mientra que los conjuntos, no. Esto quiere decir que los
conjuntos de nodos, en teoría, no aseguran cuál es el orden en que se
obtendrán nodos. En la práctica, sin embargo, los nodos siempre se
devuelven en el orden en que se encuentran en el documento <abbr title="eXtensible  Markup Language">XML</abbr>.</p>
</div>
</li>
</ol>
</dd>
</dl>
<dl id="xpath1-datatypes">
<dt><strong>Tipos de datos</strong></dt><dd><p>¿Cuáles son los tipos de datos (no de nodos, que ya hemos enumerado) que
reconoce XPath 1.0? Solamente <strong>4</strong>:</p>
<ol class="arabic simple">
<li><p>Booleanos (notados <code class="docutils literal notranslate"><span class="pre">true</span></code> y <code class="docutils literal notranslate"><span class="pre">false</span></code>).</p></li>
<li><p>Números.</p></li>
<li><p>Cadenas.</p></li>
<li><p>Conjuntos de nodos.</p></li>
</ol>
<p>Es muy conveniente tener presente esto, porque los operadores pueden
comportarse de distinto modo según sea el tipo de los operandos y también
habrá que saber cómo se actúa cuando los operandos son de distinto tipo.</p>
</dd>
</dl>
<p>Por tanto, para afinar por completo nuestro conocimiento de <em>XPath</em>, es
necesario saber cómo realiza <em>XPath</em> la <strong>evaluación</strong> de las operaciones. Por
ejemplo, observe esta expresión aparentemente simple:</p>
<div class="highlight-xquery notranslate"><div class="highlight"><pre><span></span><span class="p">//</span><span class="nt">profesor</span><span class="p">[</span><span class="nt">nombre</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s2">&quot;José&quot;</span><span class="p">]</span>
</pre></div>
</div>
<p>Intuitivamente entendemos que esta expresión devuelve el conjunto de profesores
(en puridad, nodos profesor) cuyo nombre es «<em>José</em>». Sin embargo, si
profundizamos un poco, llegaremos a la conclusión de que «José» es un cadena,
pero el nodo <code class="docutils literal notranslate"><span class="pre">nombre</span></code> con el que se compara no lo es: es un nodo elemento que,
a su vez contiene un nodo texto, cuyo valor sí es una cadena:</p>
<div class="highlight-xquery notranslate"><div class="highlight"><pre><span></span><span class="p">//</span><span class="nt">profesor</span><span class="p">[</span><span class="nt">nombre</span><span class="p">/</span><span class="nf">text</span><span class="p">()</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s2">&quot;José&quot;</span><span class="p">]</span>
</pre></div>
</div>
<p>¿Tendríamos que haber expresado la comparación así para que ambos operandos
fueran una cadena? Lo cierto es que no llega a ser necesario y la primera
expresión también funciona, porque existen mecanismos de conversión automática
de tipos. Este es un aspecto que debemos revisar.</p>
<dl id="xpath1-conversion">
<dt><strong>Conversión de tipos</strong></dt><dd><p>Al evaluarse expresiones es común que se realicen conversiones automáticas de
tipos, aunque pueden forzarse algunas conversiones utilizando las funciones
<a class="reference external" href="https://developer.mozilla.org/en-US/docs/Web/XPath/Functions/boolean">boolean()</a>,
<a class="reference external" href="https://developer.mozilla.org/en-US/docs/Web/XPath/Functions/string">string()</a> o
<a class="reference external" href="https://developer.mozilla.org/en-US/docs/Web/XPath/Functions/number">number()</a>.</p>
<p>Las conversiones <strong>automáticas</strong> operan del siguiente modo:</p>
<ol class="arabic simple">
<li><p>Si el operador es <code class="docutils literal notranslate"><span class="pre">=</span></code> o <code class="docutils literal notranslate"><span class="pre">!=</span></code> y alguno de los dos operandos es booleano,
el otro se convertirá a booleano; si no es así y uno de los dos es número, el
otro se convierte a número; y en cualquier otro caso, ambos se convierten a
cadena.</p></li>
<li><p>Si los operadores son de comparación (<code class="docutils literal notranslate"><span class="pre">&lt;</span></code>, <code class="docutils literal notranslate"><span class="pre">&lt;=</span></code>, <code class="docutils literal notranslate"><span class="pre">&gt;</span></code> y <code class="docutils literal notranslate"><span class="pre">&gt;=</span></code>) los
operandos se convierten a número.</p>
<div class="admonition warning">
<p class="admonition-title">Advertencia</p>
<p>Nótese que esto implica que en <em>XPath</em> 1.0 no pueden
compararse alfabéticamente cadenas. Y como no existe el tipo «fecha»,
no pueden compararse fechas (que son cadenas), aunque tengan el formato
<code class="docutils literal notranslate"><span class="pre">AAAA-MM-DD</span></code>. Para comparar fechas, primero hay que quitar los
guiones para que quede la cadena <code class="docutils literal notranslate"><span class="pre">AAAAMMDD</span></code> que sí puede convertirse
en un número. Por ejemplo, si queremos comprobar si una nodo fecha es
anterior al 21 de diciembre de 2020:</p>
<div class="highlight-xquery notranslate"><div class="highlight"><pre><span></span><span class="nf">translate</span><span class="p">(</span><span class="nt">fecha</span><span class="p">,</span><span class="w"> </span><span class="s2">&quot;-&quot;</span><span class="p">,</span><span class="w"> </span><span class="s2">&quot;&quot;</span><span class="p">)</span><span class="w"> </span><span class="o">&lt;</span><span class="w"> </span><span class="mi">20201221</span>
</pre></div>
</div>
<p>En esta expresión hemos usado la función para cadenas <a class="reference external" href="https://developer.mozilla.org/en-US/docs/Web/XPath/Functions/translate">translate</a>.</p>
</div>
</li>
<li><p>Ante operadores aritméticos, ambos operandos se convierten a número.</p></li>
</ol>
<p>Otro aspecto a considerar es qué resultado produce la conversión a otro tipo:</p>
<ul class="simple">
<li><p><em>Conversión a cadena</em>:</p>
<ul class="simple">
<li><p>Los números se convierten a cadenas según lo que se esperaría de ellos.</p></li>
<li><p>Los valores booleanos <em>false</em> y <em>true</em> se convierten a las cadenas «false» y
«true».</p></li>
<li><p>Un conjunto de nodos se convierte a cadena, convirtiendo a cadena el primero
de los nodos. Si el conjunto está vacío, entonces se obtiene la cadena
vacía. El valor de cadena de un nodo es el valor del atributo, si el nodo es
un nodo atributo; o la concatenación de los nodos de texto descendientes, si
el nodo es un nodo elemento.</p></li>
</ul>
</li>
<li><p><em>Conversión a número</em>:</p>
<ul class="simple">
<li><p>Las cadenas que representan número son convertidas al número equivalente; si
no representan ningún número, se obtiene <strong>NaN</strong>.</p></li>
<li><p><em>true</em> se convierte a <strong>1</strong>, y <em>false</em> a <strong>0</strong>.</p></li>
<li><p>Para convertir en número un conjunto de nodos se convierte primero el
conjunto en cadena.</p></li>
</ul>
</li>
<li><p><em>Conversión a booleano</em>:</p>
<ul>
<li><p>Los números negativos y positivos se consideran verdaderos; <strong>0</strong> y <strong>NaN</strong>
se consideran falsos.</p></li>
<li><p>Un conjunto de nodos es verdadero, a menos que esté vacío. Esta es la razón
por la que para seleccionar los profesores que no tienen apelativo basta con
hacer:</p>
<div class="highlight-xquery notranslate"><div class="highlight"><pre><span></span><span class="p">//</span><span class="nt">profesor</span><span class="p">[</span><span class="nf">not</span><span class="p">(</span><span class="nt">apelativo</span><span class="p">)]</span>
</pre></div>
</div>
</li>
<li><p>Una cadena es verdadera, a menos que sea la cadena vacía.</p></li>
</ul>
</li>
</ul>
<p>Sabido esto ya podemos desentrañar el misterio de por qué funciona:</p>
<div class="highlight-xquery notranslate"><div class="highlight"><pre><span></span><span class="p">//</span><span class="nt">profesor</span><span class="p">[</span><span class="nt">nombre</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s2">&quot;José&quot;</span><span class="p">]</span>
</pre></div>
</div>
<p>El primer operando, «nombre», es un conjunto de nodos elemento que contiene
un único nodo elemento y el segundo operando es una cadena. Como el operador
es «=», esto implica que «nombre» se convierte a cadena. Esto implica que el
primer elemento del conjunto (sólo hay uno en cualquier caso), se transforma
a cadena. ¿Cómo se transforma un nodo elemento a cadena? Se yuxtaponen los
valores de todos los nodos de texto que contiene. Sólo tiene uno, el que
contiene el propio nombre, por lo que la comparación se puede llevar a cabo.</p>
</dd>
</dl>
<dl id="xpath-pluralidad">
<dt><strong>Pluralidad</strong></dt><dd><p>Existe, además del de la conversión, otro aspecto a tener en cuenta.
Recordemos que habíamos modificado el <abbr title="Document Type Definition">DTD</abbr> para que un profesor pudiera
tener varios apodos. ¿Cómo encontraríamos los profesores a los que se conoce
como «Pepe»? La  respuesta inmediata es:</p>
<div class="highlight-xquery notranslate"><div class="highlight"><pre><span></span><span class="p">//</span><span class="nt">profesor</span><span class="p">[</span><span class="nt">apodo</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s2">&quot;Pepe&quot;</span><span class="p">]</span>
</pre></div>
</div>
<p>que es correcta, pero que tiene más miga de la que aparenta. Descontado el hecho
de que hemos escrito <code class="code docutils literal notranslate"><span class="pre">apodo</span></code> y no <code class="code docutils literal notranslate"><span class="pre">apodo/text()</span></code> (que acabamos de
explicar por qué funciona), un mismo profesor puede tener varios apodos, así
que el operador de la izquierda no tiene que ser un único nodo, puede ser un
conjunto de nodos, caso de que a nuestro profesor <em>don José</em>, lo conozcan
como <em>Pepe</em>, pero también como <em>Pepito</em>. Así que esa comparación no es de uno
contra uno, sino de varios contra uno, y en otros casos nos podríamos
encontrar con operaciones binarias<a class="footnote-reference brackets" href="#id8" id="id3" role="doc-noteref"><span class="fn-bracket">[</span>2<span class="fn-bracket">]</span></a> de varios contra varios.</p>
<p>Cuando las operaciones implican conjuntos de nodos, nos encontramos con lo
que denominaremos <em class="dfn">el problema de la pluralidad</em>. <em>XPath</em> lo resuelve
del siguiente modo:</p>
<ol class="arabic simple">
<li><p>Cuando se compara una pluralidad de nodos con un único valor, la expresión es
verdadera con que al menos uno de los nodos de la pluralidad cumpla con la
expresión. En consecuencia, en el ejemplo anterior bastaría con que uno de
los apodos del profesor fuera «Pepe» para que ese profesor quedara
seleccionado.</p></li>
<li><p>Cuando ambos operandos de las expresión son una pluralidad de nodos, la
expresión es verdadera si hay un nodo del primer conjunto y un nodo del
segundo conjunto, que al ser comparados entre sí como cadenas hacen que la
expresión sea verdadera.</p></li>
</ol>
<div class="admonition caution">
<p class="admonition-title">Prudencia</p>
<p>Es importante tener presente que cuando uno o los dos operandos son
una pluralidad, lo contrario a:</p>
<div class="highlight-xquery notranslate"><div class="highlight"><pre><span></span><span class="p">//</span><span class="nt">profesor</span><span class="p">[</span><span class="nt">apelativo</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s2">&quot;Pepe&quot;</span><span class="p">]</span>
</pre></div>
</div>
<p>no es:</p>
<div class="highlight-xquery notranslate"><div class="highlight"><pre><span></span><span class="p">//</span><span class="nt">profesor</span><span class="p">[</span><span class="nt">apelativo</span><span class="w"> </span><span class="o">!=</span><span class="w"> </span><span class="s2">&quot;Pepe&quot;</span><span class="p">]</span>
</pre></div>
</div>
<p>sino:</p>
<div class="highlight-xquery notranslate"><div class="highlight"><pre><span></span><span class="p">//</span><span class="nt">profesor</span><span class="p">[</span><span class="nf">not</span><span class="p">(</span><span class="nt">apelativo</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s2">&quot;Pepe&quot;</span><span class="p">)]</span>
</pre></div>
</div>
<p>Sólo esta segunda expresión nos devolvería los nodos de los profesores cuyo
apelativo no sea «Pepe», ya que la segunda expresión sería cierta con que
alguno de los apodos del profesor no fuera «Pepe». Por ejemplo, un
profesor que tenga por apodos «Pepe» y «Pepito» hace verdadero el primer
predicado, pero también el segundo, ya que «Pepito» no es igual a «Pepe».
Sólo el tercer predicado es cierto cuando ninguno de los apodos del
profesor es «Pepe».</p>
</div>
</dd>
</dl>
</section>
<section id="xpath-2-0-3-0">
<h2><span class="section-number">3.1.1.4. </span>XPath 2.0/3.0<a class="headerlink" href="#xpath-2-0-3-0" title="Enlace permanente a este encabezado">¶</a></h2>
<p>La versión 2.0 del lenguaje supuso en gran cambio hasta el punto de que, aunque
procuró mantenerse cierta compatibilidad con la primera versión, no todas las
expresiones se evalúan del mismo modo. La especificación añadió:</p>
<ol class="arabic simple">
<li><p>Dos redefiniciones conceptuales de suma importancia referentes al <a class="reference internal" href="#xpath2-result"><span class="std std-ref">resultado de
evaluar la expresión</span></a> y a los <a class="reference internal" href="#xpath2-tipos"><span class="std std-ref">tipos de datos</span></a>.</p></li>
<li><p>Nuevos operadores.</p></li>
<li><p>Algunas construcciones novedosas.</p></li>
<li><p>Nuevas funciones.</p></li>
<li><p><em>XPath</em> 3.1 incorporó soporte para arrays y mapas y, con ello,  soporte para
<abbr title="JavaScript Object Notation">JSON</abbr>.</p></li>
</ol>
<dl id="xpath2-result">
<dt><strong>Resultado</strong></dt><dd><p>A diferencia de <a class="reference internal" href="#xpath1-result"><span class="std std-ref">lo que ocurre en XPath 1.0</span></a>, en las
versiones posteriores el resultado de una expresión es siempre una secuencia
de <em>ítems</em>, esto es, una serie ordenada de valores o nodos. Por tanto, la
expresión:</p>
<div class="highlight-xquery notranslate"><div class="highlight"><pre><span></span><span class="mi">1</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mi">1</span>
</pre></div>
</div>
<p>devuelve una secuencia constituida por un único valor lógico (verdadero), o</p>
<div class="highlight-xquery notranslate"><div class="highlight"><pre><span></span><span class="p">/</span><span class="nt">claustro</span><span class="p">/</span><span class="nt">profesor</span>
</pre></div>
</div>
<p>devuelve una secuencia constituida por todos los nodos profesor ordenada
según aparecen en el documento. Las secuencias pueden construirse
explícitamente:</p>
<div class="highlight-xquery notranslate"><div class="highlight"><pre><span></span><span class="p">(</span><span class="mi">1</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mi">1</span><span class="p">,</span><span class="w"> </span><span class="mi">1</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="mi">1</span><span class="p">,</span><span class="w"> </span><span class="s2">&quot;Soy una cadena&quot;</span><span class="p">,</span><span class="w"> </span><span class="p">//</span><span class="nt">profesor</span><span class="p">)</span>
</pre></div>
</div>
<p>lo cual es muy útil porque nos sirve para predicados como este:</p>
<div class="highlight-xquery notranslate"><div class="highlight"><pre><span></span><span class="p">//</span><span class="nt">profesor</span><span class="p">[</span><span class="nt">nombre</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="p">(</span><span class="s2">&quot;Manuel&quot;</span><span class="p">,</span><span class="w"> </span><span class="s2">&quot;Luis&quot;</span><span class="p">)]</span>
</pre></div>
</div>
<p>que devolverá todos los nodos profesor en que el profesor se llame «Manuel» o
«Luis», ya que el operando de la izquierda es único, el de la derecha varios
y ya sabe <a class="reference internal" href="#xpath-pluralidad"><span class="std std-ref">cómo se resuelve el problema de la pluralidad</span></a>.</p>
<p>Las secuencias tienen algunas particularidades:</p>
<ul>
<li><p>Cuando están compuestas por un único ítem, pueden escribirse con o sin el
paréntesis. En consecuencia, esta expresión:</p>
<div class="highlight-xquery notranslate"><div class="highlight"><pre><span></span><span class="mi">1</span>
</pre></div>
</div>
<p>y esta otra:</p>
<div class="highlight-xquery notranslate"><div class="highlight"><pre><span></span><span class="p">(</span><span class="mi">1</span><span class="p">)</span>
</pre></div>
</div>
<p>son equivalentes.</p>
</li>
<li><p>Las secuencias no se anidan a otras secuencias, sino que si se
produce este hecho, se <em>aplanan</em>. En consecuencia esto:</p>
<div class="highlight-xquery notranslate"><div class="highlight"><pre><span></span><span class="p">(</span><span class="mi">1</span><span class="p">,</span><span class="w"> </span><span class="mi">2</span><span class="p">,</span><span class="w"> </span><span class="p">(</span><span class="mi">3</span><span class="p">,</span><span class="w"> </span><span class="mi">4</span><span class="p">),</span><span class="w"> </span><span class="mi">5</span><span class="p">)</span>
</pre></div>
</div>
<p>es equivalente a esto otro:</p>
<div class="highlight-xquery notranslate"><div class="highlight"><pre><span></span><span class="p">(</span><span class="mi">1</span><span class="p">,</span><span class="w"> </span><span class="mi">2</span><span class="p">,</span><span class="w"> </span><span class="mi">3</span><span class="p">,</span><span class="w"> </span><span class="mi">4</span><span class="p">,</span><span class="w"> </span><span class="mi">5</span><span class="p">)</span>
</pre></div>
</div>
</li>
<li><p>Las secuencias que representan rangos de números enteros pueden expresarse
con una sintaxis abreviada. Así, la secuencia anterior puede escribirse
como:</p>
<div class="highlight-xquery notranslate"><div class="highlight"><pre><span></span><span class="p">(</span><span class="mi">1</span><span class="w"> </span><span class="k">to</span><span class="w"> </span><span class="mi">5</span><span class="p">)</span>
</pre></div>
</div>
</li>
</ul>
</dd>
</dl>
<dl id="xpath2-tipos">
<dt><strong>Tipos</strong></dt><dd><p>El otro gran cambio sustancial son los tipos atómicos de los datos (que no de
nodos, pues siguen siendo los siete mismos). De <em>XPath</em> 2.0 en adelante se
asumen los tipos definidos para <a class="reference internal" href="../98.apendices/21.xsd.html#xsd"><span class="std std-ref">XML Schemas</span></a>, más algún pequeño
añadido que, resumidos por <a class="reference external" href="https://commons.wikimedia.org/wiki/File:XQuery_and_XPath_Data_Model_type_hierarchy.png">cortesía de Wikipedia</a>,
los podemos ver en el siguiente esquema:</p>
<img alt="https://upload.wikimedia.org/wikipedia/commons/9/91/XQuery_and_XPath_Data_Model_type_hierarchy.png" src="https://upload.wikimedia.org/wikipedia/commons/9/91/XQuery_and_XPath_Data_Model_type_hierarchy.png" />
<p>Así pues, nos encontraremos con tipos de datos como <code class="docutils literal notranslate"><span class="pre">xs:integer</span></code>  o
<code class="docutils literal notranslate"><span class="pre">xs:string</span></code>, pero sólo en caso de que el procesador haya sido capaz de
validar el documento con una gramática para discernir realmente el tipo de
dato. De lo contrario, el tipo quedará indefinido (<code class="docutils literal notranslate"><span class="pre">xs:untypedAtomic</span></code>).</p>
<div class="admonition caution">
<p class="admonition-title">Prudencia</p>
<p>Recuerde, pues, que el procesador sólo sabrá el tipo concreto
del dato almacenado en un nodo si ha sido capaz de utilizar una gramática
para determinarlo. Por ese motivo, ante este <abbr title="eXtensible  Markup Language">XML</abbr>:</p>
<div class="highlight-xml notranslate"><div class="highlight"><pre><span></span><span class="nt">&lt;cifras&gt;</span>
<span class="w">   </span><span class="nt">&lt;n&gt;</span>11<span class="nt">&lt;/n&gt;</span>
<span class="w">   </span><span class="nt">&lt;n&gt;</span>9<span class="nt">&lt;/n&gt;</span>
<span class="w">   </span><span class="nt">&lt;n&gt;</span>123<span class="nt">&lt;/n&gt;</span>
<span class="nt">&lt;/cifras&gt;</span>
</pre></div>
</div>
<p>la expresión:</p>
<div class="highlight-xquery notranslate"><div class="highlight"><pre><span></span><span class="p">//</span><span class="nt">n</span><span class="p">[</span><span class="nf">not</span><span class="p">(.</span><span class="w"> </span><span class="o">&lt;</span><span class="w"> </span><span class="p">//</span><span class="nt">n</span><span class="p">)]</span>
</pre></div>
</div>
<p>devuelve el segundo nodo «n» (<strong>9</strong>) en vez de devolver el nodo tercero
que es el que tiene el número mayor (<strong>123</strong>).</p>
</div>
<p>Al haberse ampliado la cantidad de tipos, ha aumentado la complejidad y ha
cambiado la forma de tratarlos respecto a <em>XPath</em> 1.0, por lo que <a class="reference internal" href="#xpath1-conversion"><span class="std std-ref">mucho de lo
indicado respecto a sus conversiones en XPath 1.0</span></a> ya no
es válido. Muy resumidamente:</p>
<ul>
<li><p>Existen los constructores <code class="docutils literal notranslate"><span class="pre">xs:string()</span></code>, <code class="docutils literal notranslate"><span class="pre">xs:integer()</span></code>,
<code class="docutils literal notranslate"><span class="pre">xs:boolean()</span></code>, etc. que permiten convertir el tipo del valor que se
proporcione como argumento. El argumento debe ser un valor único o, si se
prefiere decir así, una secuencia con uno y sólo un ítem. Por tanto, la
expresión:</p>
<div class="highlight-xquery notranslate"><div class="highlight"><pre><span></span><span class="nf">xs:string</span><span class="p">((</span><span class="mi">1</span><span class="p">,</span><span class="w"> </span><span class="nf">false</span><span class="p">()))</span>
</pre></div>
</div>
<p>provocá un error, ya que intenta convertirse una secuencia de dos
elementos. Como alternativa al uso de estos constructores como funciones para realizar
una conversión, existe <code class="docutils literal notranslate"><span class="pre">cast</span> <span class="pre">as</span></code> que tiene el mismo efecto. Por tanto,
vale tanto hacer:</p>
<div class="highlight-xquery notranslate"><div class="highlight"><pre><span></span><span class="nf">xs:boolean</span><span class="p">(</span><span class="s2">&quot;false&quot;</span><span class="p">)</span>
</pre></div>
</div>
<p>como hacer:</p>
<div class="highlight-xquery notranslate"><div class="highlight"><pre><span></span><span class="s2">&quot;false&quot;</span><span class="w"> </span><span class="k">cast</span><span class="w"> </span><span class="k">as</span><span class="w"> </span><span class="nv">xs:boolean</span>
</pre></div>
</div>
<p>y, en ambos casos, la expresión devuelve el valor lógico <em>falso</em>. Para
prevenir un posible error, existe <code class="docutils literal notranslate"><span class="pre">castable</span> <span class="pre">as</span></code>, que permite inquirir si
una conversión es posible o no. Así, es <em>verdadera</em> la expresión:</p>
<div class="highlight-xquery notranslate"><div class="highlight"><pre><span></span><span class="s2">&quot;false&quot;</span><span class="w"> </span><span class="k">castable</span><span class="w"> </span><span class="k">as</span><span class="w"> </span><span class="nv">xs:boolean</span>
</pre></div>
</div>
<p>pero <em>falsa</em>:</p>
<div class="highlight-xquery notranslate"><div class="highlight"><pre><span></span><span class="p">(</span><span class="mi">1</span><span class="p">,</span><span class="w"> </span><span class="nf">false</span><span class="p">())</span><span class="w"> </span><span class="k">castable</span><span class="w"> </span><span class="k">as</span><span class="w"> </span><span class="nv">xs:string</span>
</pre></div>
</div>
</li>
<li><p>Además de los constructores, siguen existiendo las funciones <a class="reference external" href="https://www.w3.org/TR/xpath-functions-31/#func-boolean">fn:boolean()</a>, <a class="reference external" href="https://www.w3.org/TR/xpath-functions-31/#func-string">fn:string()</a> y <a class="reference external" href="https://www.w3.org/TR/xpath-functions-31/#func-number">fn:number()</a>, que se comportan
de un modo más parecido a <em>XPath</em> 1.0 de como lo hacen los constructores.
Por ejemplo, <code class="code docutils literal notranslate"><span class="pre">boolean(&quot;false&quot;)</span></code> es <em>verdadero</em> y <code class="code docutils literal notranslate"><span class="pre">boolean(&quot;&quot;)</span></code>
es <em>falso</em>, mientras que al usar el constructor <code class="docutils literal notranslate"><span class="pre">xs:boolean</span></code> la primera
expresión es falsa y la segunda devuelve un error. Sin embargo, a
diferencia de lo que ocurría en <em>XPath</em> 1.0 al convertir un conjunto de
nodos en que se devolvía la conversión a cadena del primer elemento, la
conversión con la función <code class="docutils literal notranslate"><span class="pre">string()</span></code> de una secuencia de dos o más
elementos provoca un error.</p></li>
<li><p>No existen los constantes <code class="docutils literal notranslate"><span class="pre">true</span></code> ni <code class="docutils literal notranslate"><span class="pre">false</span></code>, sino las funciones
<a class="reference external" href="https://www.w3.org/TR/xpath-functions-31/#func-true">true()</a> y <a class="reference external" href="https://www.w3.org/TR/xpath-functions-31/#func-false">false()</a>.</p></li>
<li><p>El <a class="reference external" href="https://www.w3.org/TR/xpath-31/#id-ebv">valor efectivo booleano</a> que
es el valor lógico que el procesador tiene que calcular automáticamente en
determinados casos (para el resultado de un predicado, para el argumento de
la función <a class="reference external" href="https://www.w3.org/TR/xpath-31/#func-not">not</a>, etc.) se
obtiene al aplicar la función <code class="docutils literal notranslate"><span class="pre">boolean()</span></code> y no el constructor
<code class="docutils literal notranslate"><span class="pre">xs:boolean()</span></code>. Por ese motivo, la expresión:</p>
<div class="highlight-xquery notranslate"><div class="highlight"><pre><span></span><span class="p">/</span><span class="nt">claustro</span><span class="p">/</span><span class="nt">profesor</span><span class="p">[</span><span class="nt">apodo</span><span class="p">]</span>
</pre></div>
</div>
<p>devolverá los profesores con algún apodo (tal como ocurre en <em>XPath</em> 1.0)
en vez de generar un error si algún profesor presentara más de un apodo.</p>
</li>
<li><p><code class="docutils literal notranslate"><span class="pre">instance</span> <span class="pre">of</span></code> permite preguntar sobre el tipo del ítem. Así:</p>
<div class="highlight-xquery notranslate"><div class="highlight"><pre><span></span><span class="s1">&#39;Luis&#39;</span><span class="w"> </span><span class="k">instance</span><span class="w"> </span><span class="k">of</span><span class="w"> </span><span class="kt">xs:string</span>
</pre></div>
</div>
<p>devolverá verdadero, o:</p>
<div class="highlight-xquery notranslate"><div class="highlight"><pre><span></span><span class="p">/</span><span class="nt">claustro</span><span class="p">/</span><span class="nt">profesor</span><span class="p">[</span><span class="mi">1</span><span class="p">]/</span><span class="nt">nombre</span><span class="w"> </span><span class="k">instance</span><span class="w"> </span><span class="k">of</span><span class="w"> </span><span class="nt">element</span><span class="p">()</span>
</pre></div>
</div>
<p>también lo hará. Es también verdadero:</p>
<div class="highlight-xquery notranslate"><div class="highlight"><pre><span></span><span class="p">/</span><span class="nt">claustro</span><span class="p">/</span><span class="nt">profesor</span><span class="p">[</span><span class="mi">1</span><span class="p">]/</span><span class="nt">nombre</span><span class="w"> </span><span class="k">instance</span><span class="w"> </span><span class="k">of</span><span class="w"> </span><span class="nt">node</span><span class="p">()</span>
</pre></div>
</div>
<p>ya que un elemento es un tipo particular de nodo. Cuando se pregunta
sobre secuencias de ítems, es posible usar la nomenclatura que se usa al
definir la <a class="reference internal" href="../02.validacion/01.dtdxml.html#dtd-cardinalidad"><span class="std std-ref">cardinalidad en DTD</span></a>:</p>
<div class="highlight-xquery notranslate"><div class="highlight"><pre><span></span><span class="p">/</span><span class="nt">claustro</span><span class="p">/</span><span class="nt">profesor</span><span class="p">/</span><span class="nt">nombre</span><span class="w"> </span><span class="k">instance</span><span class="w"> </span><span class="k">of</span><span class="w"> </span><span class="nt">element</span><span class="p">()+</span>
</pre></div>
</div>
</li>
<li><p>La función <a class="reference external" href="https://www.w3.org/TR/xpath-functions-31/#func-data">data()</a>
devuelve el valor atómico del nodo que se le proporciona como argumento.
Por ello, la expresión:</p>
<div class="highlight-xquery notranslate"><div class="highlight"><pre><span></span><span class="nf">data</span><span class="p">(/</span><span class="nt">claustro</span><span class="p">/</span><span class="nt">profesor</span><span class="p">[</span><span class="mi">1</span><span class="p">]/</span><span class="nt">nombre</span><span class="p">)</span>
</pre></div>
</div>
<p>devolverá el valor atómico del elemento <em>nombre</em> del primer profesor en el
documento y no el elemento en sí. Por tanto, es verdadera la expresión:</p>
<div class="highlight-xquery notranslate"><div class="highlight"><pre><span></span><span class="nf">data</span><span class="p">(/</span><span class="nt">claustro</span><span class="p">/</span><span class="nt">profesor</span><span class="p">[</span><span class="mi">1</span><span class="p">]/</span><span class="nt">nombre</span><span class="p">)</span><span class="w"> </span><span class="k">instance</span><span class="w"> </span><span class="k">of</span><span class="w"> </span><span class="kt">xs:untypedAtomic</span>
</pre></div>
</div>
<p>ya que se ha supuesto que el procesador no ha analizado una gramática que proporcione
el tipo del elemento<a class="footnote-reference brackets" href="#id9" id="id5" role="doc-noteref"><span class="fn-bracket">[</span>3<span class="fn-bracket">]</span></a>. A la función se le puede proporcionar una
secuencia para que obtenga el valor atómico de cada ítem de la secuencia:</p>
<div class="highlight-xquery notranslate"><div class="highlight"><pre><span></span><span class="nf">data</span><span class="p">(/</span><span class="nt">claustro</span><span class="p">/</span><span class="nt">profesor</span><span class="p">/</span><span class="nt">nombre</span><span class="p">)</span>
</pre></div>
</div>
<p>La expresión devuelve los valores atómicos que contiene cada uno de los elementos <em>nombre</em>
de profesor. Lo habitual es que no haya que usar esta función al construir
las expresiones <em>XPath</em>, puesto que, cuando un nodo actúa como operando, el
procesador obtiene su valor atómico automáticamente. Así, por ejemplo:</p>
<div class="highlight-xquery notranslate"><div class="highlight"><pre><span></span><span class="p">/</span><span class="nt">claustro</span><span class="p">/</span><span class="nt">profesor</span><span class="p">/</span><span class="nt">nombre</span><span class="p">/</span><span class="nf">concat</span><span class="p">(</span><span class="s1">&#39;Hola, &#39;</span><span class="p">,</span><span class="w"> </span><span class="p">.)</span>
</pre></div>
</div>
<p>logrará concatenar a la cadena literal &quot;Hola, &quot; el valor atómico del
elemento <em>nombre</em> de cada profesor sin necesidad de usar <code class="docutils literal notranslate"><span class="pre">data()</span></code>.</p>
<div class="admonition warning">
<p class="admonition-title">Advertencia</p>
<p>Note que esta expresión <strong>no es válida</strong> en <em>XPath</em> 1.0, a
pesar de que  existe la función <code class="docutils literal notranslate"><span class="pre">concat</span></code>,  ya que una función no puede
formar parte de la ruta: o forma parte del predicado o engloba toda la
ruta<a class="footnote-reference brackets" href="#id10" id="id6" role="doc-noteref"><span class="fn-bracket">[</span>4<span class="fn-bracket">]</span></a>.</p>
</div>
</li>
<li><p>Los tipos de los valores atómicos de los atributos y los elementos
<a class="reference internal" href="#xpath-element"><span class="std std-ref">pueden servir como filtro</span></a> en las expresiones.</p></li>
</ul>
</dd>
<dt><strong>Operadores</strong></dt><dd><p>Los operadores que ya existían en <em>XPath</em> 1.0 se mantienen, aunque con
algunos cambios, y se añaden otros nuevos.</p>
</dd>
</dl>
<p><strong>Funciones</strong></p>
<p><strong>Construcciones</strong></p>
<div class="admonition seealso">
<p class="admonition-title">Ver también</p>
<p>La página <a class="reference external" href="https://www.altova.com">altova.com</a> tiene una <a class="reference external" href="https://www.altova.com/training/xpath3">guía
bastante completa de XPath 3.1</a> que
incluye bastante ejemplos de uso. También es bastante revelador <a class="reference external" href="https://www.oreilly.com/library/view/xslt-cookbook-2nd/0596009747/ch01.html">el primer
capítulo del libro «XSLT Cookbook»</a>,
que trata sobre <em>XPath</em> y que ofrece de gratis la editorial O’Reilly.</p>
</div>
</section>
<section id="xquery">
<h2><span class="section-number">3.1.1.5. </span>XQuery<a class="headerlink" href="#xquery" title="Enlace permanente a este encabezado">¶</a></h2>
</section>
<section id="ejercicio-resuelto">
<h2><span class="section-number">3.1.1.6. </span>Ejercicio resuelto<a class="headerlink" href="#ejercicio-resuelto" title="Enlace permanente a este encabezado">¶</a></h2>
<p>Dado el <abbr title="eXtensible  Markup Language">XML</abbr> <a class="reference internal" href="../01.intro/02b.marcas.html#xml-resueltos"><span class="std std-ref">propuesto para representar el negocio de una cadena de
restaurantes</span></a>, determine las expresion <em>XPath</em> apropiadas para:</p>
<ol class="arabic">
<li><p>Obtener todas las recetas disponibles.</p>
<details class="sd-sphinx-override sd-dropdown sd-card sd-mb-3">
<summary class="sd-summary-title sd-card-header">
Solución…<div class="sd-summary-down docutils">
<svg version="1.1" width="1.5em" height="1.5em" class="sd-octicon sd-octicon-chevron-down" viewBox="0 0 24 24" aria-hidden="true"><path fill-rule="evenodd" d="M5.22 8.72a.75.75 0 000 1.06l6.25 6.25a.75.75 0 001.06 0l6.25-6.25a.75.75 0 00-1.06-1.06L12 14.44 6.28 8.72a.75.75 0 00-1.06 0z"></path></svg></div>
<div class="sd-summary-up docutils">
<svg version="1.1" width="1.5em" height="1.5em" class="sd-octicon sd-octicon-chevron-up" viewBox="0 0 24 24" aria-hidden="true"><path fill-rule="evenodd" d="M18.78 15.28a.75.75 0 000-1.06l-6.25-6.25a.75.75 0 00-1.06 0l-6.25 6.25a.75.75 0 101.06 1.06L12 9.56l5.72 5.72a.75.75 0 001.06 0z"></path></svg></div>
</summary><div class="sd-summary-content sd-card-body docutils">
<div class="highlight-xquery notranslate"><div class="highlight"><pre><span></span><span class="p">//</span><span class="nt">receta</span>
</pre></div>
</div>
</div>
</details></li>
<li><p>Obtener el nodo que representa la receta de nombre «ensalada».</p>
<details class="sd-sphinx-override sd-dropdown sd-card sd-mb-3">
<summary class="sd-summary-title sd-card-header">
Solución…<div class="sd-summary-down docutils">
<svg version="1.1" width="1.5em" height="1.5em" class="sd-octicon sd-octicon-chevron-down" viewBox="0 0 24 24" aria-hidden="true"><path fill-rule="evenodd" d="M5.22 8.72a.75.75 0 000 1.06l6.25 6.25a.75.75 0 001.06 0l6.25-6.25a.75.75 0 00-1.06-1.06L12 14.44 6.28 8.72a.75.75 0 00-1.06 0z"></path></svg></div>
<div class="sd-summary-up docutils">
<svg version="1.1" width="1.5em" height="1.5em" class="sd-octicon sd-octicon-chevron-up" viewBox="0 0 24 24" aria-hidden="true"><path fill-rule="evenodd" d="M18.78 15.28a.75.75 0 000-1.06l-6.25-6.25a.75.75 0 00-1.06 0l-6.25 6.25a.75.75 0 101.06 1.06L12 9.56l5.72 5.72a.75.75 0 001.06 0z"></path></svg></div>
</summary><div class="sd-summary-content sd-card-body docutils">
<div class="highlight-xquery notranslate"><div class="highlight"><pre><span></span><span class="p">//</span><span class="nt">receta</span><span class="p">[</span><span class="na">@nombre</span><span class="o">=</span><span class="s2">&quot;ensalada&quot;</span><span class="p">]</span>
</pre></div>
</div>
</div>
</details></li>
<li><p>Obtener la carta del restaurante de identificador «re01».</p>
<details class="sd-sphinx-override sd-dropdown sd-card sd-mb-3">
<summary class="sd-summary-title sd-card-header">
Solución…<div class="sd-summary-down docutils">
<svg version="1.1" width="1.5em" height="1.5em" class="sd-octicon sd-octicon-chevron-down" viewBox="0 0 24 24" aria-hidden="true"><path fill-rule="evenodd" d="M5.22 8.72a.75.75 0 000 1.06l6.25 6.25a.75.75 0 001.06 0l6.25-6.25a.75.75 0 00-1.06-1.06L12 14.44 6.28 8.72a.75.75 0 00-1.06 0z"></path></svg></div>
<div class="sd-summary-up docutils">
<svg version="1.1" width="1.5em" height="1.5em" class="sd-octicon sd-octicon-chevron-up" viewBox="0 0 24 24" aria-hidden="true"><path fill-rule="evenodd" d="M18.78 15.28a.75.75 0 000-1.06l-6.25-6.25a.75.75 0 00-1.06 0l-6.25 6.25a.75.75 0 101.06 1.06L12 9.56l5.72 5.72a.75.75 0 001.06 0z"></path></svg></div>
</summary><div class="sd-summary-content sd-card-body docutils">
<div class="highlight-xquery notranslate"><div class="highlight"><pre><span></span><span class="p">/</span><span class="nt">cadena</span><span class="p">/</span><span class="nt">restaurante</span><span class="p">[</span><span class="na">@id</span><span class="o">=</span><span class="s2">&quot;re01&quot;</span><span class="p">]/</span><span class="nt">carta</span>
</pre></div>
</div>
</div>
</details></li>
<li><p>Obtener el código postal del restaurante «El tragón feliz»-</p>
<details class="sd-sphinx-override sd-dropdown sd-card sd-mb-3">
<summary class="sd-summary-title sd-card-header">
Solución…<div class="sd-summary-down docutils">
<svg version="1.1" width="1.5em" height="1.5em" class="sd-octicon sd-octicon-chevron-down" viewBox="0 0 24 24" aria-hidden="true"><path fill-rule="evenodd" d="M5.22 8.72a.75.75 0 000 1.06l6.25 6.25a.75.75 0 001.06 0l6.25-6.25a.75.75 0 00-1.06-1.06L12 14.44 6.28 8.72a.75.75 0 00-1.06 0z"></path></svg></div>
<div class="sd-summary-up docutils">
<svg version="1.1" width="1.5em" height="1.5em" class="sd-octicon sd-octicon-chevron-up" viewBox="0 0 24 24" aria-hidden="true"><path fill-rule="evenodd" d="M18.78 15.28a.75.75 0 000-1.06l-6.25-6.25a.75.75 0 00-1.06 0l-6.25 6.25a.75.75 0 101.06 1.06L12 9.56l5.72 5.72a.75.75 0 001.06 0z"></path></svg></div>
</summary><div class="sd-summary-content sd-card-body docutils">
<div class="highlight-xquery notranslate"><div class="highlight"><pre><span></span><span class="p">/</span><span class="nt">cadena</span><span class="p">/</span><span class="nt">restaurante</span><span class="p">[</span><span class="na">@nombre</span><span class="o">=</span><span class="s2">&quot;El dragon feliz&quot;</span><span class="p">]/</span><span class="nt">domicilio</span><span class="p">/</span><span class="nt">cp</span>
</pre></div>
</div>
</div>
</details></li>
<li><p>Contar las recetas de las que dispone la cadena.</p>
<details class="sd-sphinx-override sd-dropdown sd-card sd-mb-3">
<summary class="sd-summary-title sd-card-header">
Solución…<div class="sd-summary-down docutils">
<svg version="1.1" width="1.5em" height="1.5em" class="sd-octicon sd-octicon-chevron-down" viewBox="0 0 24 24" aria-hidden="true"><path fill-rule="evenodd" d="M5.22 8.72a.75.75 0 000 1.06l6.25 6.25a.75.75 0 001.06 0l6.25-6.25a.75.75 0 00-1.06-1.06L12 14.44 6.28 8.72a.75.75 0 00-1.06 0z"></path></svg></div>
<div class="sd-summary-up docutils">
<svg version="1.1" width="1.5em" height="1.5em" class="sd-octicon sd-octicon-chevron-up" viewBox="0 0 24 24" aria-hidden="true"><path fill-rule="evenodd" d="M18.78 15.28a.75.75 0 000-1.06l-6.25-6.25a.75.75 0 00-1.06 0l-6.25 6.25a.75.75 0 101.06 1.06L12 9.56l5.72 5.72a.75.75 0 001.06 0z"></path></svg></div>
</summary><div class="sd-summary-content sd-card-body docutils">
<div class="highlight-xquery notranslate"><div class="highlight"><pre><span></span><span class="nf">count</span><span class="p">(//</span><span class="nt">receta</span><span class="p">)</span>
</pre></div>
</div>
</div>
</details></li>
<li><p>Contar cuántos ingredientes necesita la receta de la <em>ensalada</em>.</p>
<details class="sd-sphinx-override sd-dropdown sd-card sd-mb-3">
<summary class="sd-summary-title sd-card-header">
Solución…<div class="sd-summary-down docutils">
<svg version="1.1" width="1.5em" height="1.5em" class="sd-octicon sd-octicon-chevron-down" viewBox="0 0 24 24" aria-hidden="true"><path fill-rule="evenodd" d="M5.22 8.72a.75.75 0 000 1.06l6.25 6.25a.75.75 0 001.06 0l6.25-6.25a.75.75 0 00-1.06-1.06L12 14.44 6.28 8.72a.75.75 0 00-1.06 0z"></path></svg></div>
<div class="sd-summary-up docutils">
<svg version="1.1" width="1.5em" height="1.5em" class="sd-octicon sd-octicon-chevron-up" viewBox="0 0 24 24" aria-hidden="true"><path fill-rule="evenodd" d="M18.78 15.28a.75.75 0 000-1.06l-6.25-6.25a.75.75 0 00-1.06 0l-6.25 6.25a.75.75 0 101.06 1.06L12 9.56l5.72 5.72a.75.75 0 001.06 0z"></path></svg></div>
</summary><div class="sd-summary-content sd-card-body docutils">
<div class="highlight-xquery notranslate"><div class="highlight"><pre><span></span><span class="nf">count</span><span class="p">(//</span><span class="nt">receta</span><span class="p">[</span><span class="na">@nombre</span><span class="o">=</span><span class="s2">&quot;ensalada&quot;</span><span class="p">]/</span><span class="nt">ingrediente</span><span class="p">)</span>
</pre></div>
</div>
</div>
</details></li>
<li><p>Contar cuántos ingredientes de «ensalada» se deben medir en gramos.</p>
<details class="sd-sphinx-override sd-dropdown sd-card sd-mb-3">
<summary class="sd-summary-title sd-card-header">
Solución…<div class="sd-summary-down docutils">
<svg version="1.1" width="1.5em" height="1.5em" class="sd-octicon sd-octicon-chevron-down" viewBox="0 0 24 24" aria-hidden="true"><path fill-rule="evenodd" d="M5.22 8.72a.75.75 0 000 1.06l6.25 6.25a.75.75 0 001.06 0l6.25-6.25a.75.75 0 00-1.06-1.06L12 14.44 6.28 8.72a.75.75 0 00-1.06 0z"></path></svg></div>
<div class="sd-summary-up docutils">
<svg version="1.1" width="1.5em" height="1.5em" class="sd-octicon sd-octicon-chevron-up" viewBox="0 0 24 24" aria-hidden="true"><path fill-rule="evenodd" d="M18.78 15.28a.75.75 0 000-1.06l-6.25-6.25a.75.75 0 00-1.06 0l-6.25 6.25a.75.75 0 101.06 1.06L12 9.56l5.72 5.72a.75.75 0 001.06 0z"></path></svg></div>
</summary><div class="sd-summary-content sd-card-body docutils">
<div class="highlight-xquery notranslate"><div class="highlight"><pre><span></span><span class="nf">count</span><span class="p">(//</span><span class="nt">receta</span><span class="p">[</span><span class="na">@nombre</span><span class="o">=</span><span class="s2">&quot;ensalada&quot;</span><span class="p">]/</span><span class="nt">ingrediente</span><span class="p">[</span><span class="na">@unidad</span><span class="o">=</span><span class="s2">&quot;gramo&quot;</span><span class="p">])</span>
</pre></div>
</div>
</div>
</details></li>
<li><p>Obtener la carta del restaurante «El tragón feliz».</p>
<details class="sd-sphinx-override sd-dropdown sd-card sd-mb-3">
<summary class="sd-summary-title sd-card-header">
Solución…<div class="sd-summary-down docutils">
<svg version="1.1" width="1.5em" height="1.5em" class="sd-octicon sd-octicon-chevron-down" viewBox="0 0 24 24" aria-hidden="true"><path fill-rule="evenodd" d="M5.22 8.72a.75.75 0 000 1.06l6.25 6.25a.75.75 0 001.06 0l6.25-6.25a.75.75 0 00-1.06-1.06L12 14.44 6.28 8.72a.75.75 0 00-1.06 0z"></path></svg></div>
<div class="sd-summary-up docutils">
<svg version="1.1" width="1.5em" height="1.5em" class="sd-octicon sd-octicon-chevron-up" viewBox="0 0 24 24" aria-hidden="true"><path fill-rule="evenodd" d="M18.78 15.28a.75.75 0 000-1.06l-6.25-6.25a.75.75 0 00-1.06 0l-6.25 6.25a.75.75 0 101.06 1.06L12 9.56l5.72 5.72a.75.75 0 001.06 0z"></path></svg></div>
</summary><div class="sd-summary-content sd-card-body docutils">
<div class="highlight-xquery notranslate"><div class="highlight"><pre><span></span><span class="p">/</span><span class="nt">cadena</span><span class="p">/</span><span class="nt">restaurante</span><span class="p">[</span><span class="na">@nombre</span><span class="o">=</span><span class="s2">&quot;El tragón feliz&quot;</span><span class="p">]/</span><span class="nt">carta</span>
</pre></div>
</div>
</div>
</details></li>
<li><p>Obtener el nombre de las recetas en las que se usa <em>lechuga</em>.</p>
<details class="sd-sphinx-override sd-dropdown sd-card sd-mb-3">
<summary class="sd-summary-title sd-card-header">
Solución…<div class="sd-summary-down docutils">
<svg version="1.1" width="1.5em" height="1.5em" class="sd-octicon sd-octicon-chevron-down" viewBox="0 0 24 24" aria-hidden="true"><path fill-rule="evenodd" d="M5.22 8.72a.75.75 0 000 1.06l6.25 6.25a.75.75 0 001.06 0l6.25-6.25a.75.75 0 00-1.06-1.06L12 14.44 6.28 8.72a.75.75 0 00-1.06 0z"></path></svg></div>
<div class="sd-summary-up docutils">
<svg version="1.1" width="1.5em" height="1.5em" class="sd-octicon sd-octicon-chevron-up" viewBox="0 0 24 24" aria-hidden="true"><path fill-rule="evenodd" d="M18.78 15.28a.75.75 0 000-1.06l-6.25-6.25a.75.75 0 00-1.06 0l-6.25 6.25a.75.75 0 101.06 1.06L12 9.56l5.72 5.72a.75.75 0 001.06 0z"></path></svg></div>
</summary><div class="sd-summary-content sd-card-body docutils">
<div class="highlight-xquery notranslate"><div class="highlight"><pre><span></span><span class="p">//</span><span class="nt">receta</span><span class="p">[</span><span class="nt">ingrediente</span><span class="p">/</span><span class="na">@nombre</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s2">&quot;lechuga&quot;</span><span class="p">]/</span><span class="na">@nombre</span>
</pre></div>
</div>
</div>
</details></li>
<li><p>Obtener el nombre de las recetas en las que <strong>no</strong> se usa <em>lechuga</em>.</p>
<details class="sd-sphinx-override sd-dropdown sd-card sd-mb-3">
<summary class="sd-summary-title sd-card-header">
Solución…<div class="sd-summary-down docutils">
<svg version="1.1" width="1.5em" height="1.5em" class="sd-octicon sd-octicon-chevron-down" viewBox="0 0 24 24" aria-hidden="true"><path fill-rule="evenodd" d="M5.22 8.72a.75.75 0 000 1.06l6.25 6.25a.75.75 0 001.06 0l6.25-6.25a.75.75 0 00-1.06-1.06L12 14.44 6.28 8.72a.75.75 0 00-1.06 0z"></path></svg></div>
<div class="sd-summary-up docutils">
<svg version="1.1" width="1.5em" height="1.5em" class="sd-octicon sd-octicon-chevron-up" viewBox="0 0 24 24" aria-hidden="true"><path fill-rule="evenodd" d="M18.78 15.28a.75.75 0 000-1.06l-6.25-6.25a.75.75 0 00-1.06 0l-6.25 6.25a.75.75 0 101.06 1.06L12 9.56l5.72 5.72a.75.75 0 001.06 0z"></path></svg></div>
</summary><div class="sd-summary-content sd-card-body docutils">
<div class="highlight-xquery notranslate"><div class="highlight"><pre><span></span><span class="p">//</span><span class="nt">receta</span><span class="p">[</span><span class="nf">not</span><span class="p">(</span><span class="nt">ingrediente</span><span class="p">/</span><span class="na">@nombre</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s2">&quot;lechuga&quot;</span><span class="p">)]/</span><span class="na">@nombre</span>
</pre></div>
</div>
</div>
</details></li>
<li><p>Obtener el identificador de los restaurantes en los que se sirven tapas.</p>
<details class="sd-sphinx-override sd-dropdown sd-card sd-mb-3">
<summary class="sd-summary-title sd-card-header">
Solución…<div class="sd-summary-down docutils">
<svg version="1.1" width="1.5em" height="1.5em" class="sd-octicon sd-octicon-chevron-down" viewBox="0 0 24 24" aria-hidden="true"><path fill-rule="evenodd" d="M5.22 8.72a.75.75 0 000 1.06l6.25 6.25a.75.75 0 001.06 0l6.25-6.25a.75.75 0 00-1.06-1.06L12 14.44 6.28 8.72a.75.75 0 00-1.06 0z"></path></svg></div>
<div class="sd-summary-up docutils">
<svg version="1.1" width="1.5em" height="1.5em" class="sd-octicon sd-octicon-chevron-up" viewBox="0 0 24 24" aria-hidden="true"><path fill-rule="evenodd" d="M18.78 15.28a.75.75 0 000-1.06l-6.25-6.25a.75.75 0 00-1.06 0l-6.25 6.25a.75.75 0 101.06 1.06L12 9.56l5.72 5.72a.75.75 0 001.06 0z"></path></svg></div>
</summary><div class="sd-summary-content sd-card-body docutils">
<div class="highlight-xquery notranslate"><div class="highlight"><pre><span></span><span class="p">/</span><span class="nt">cadena</span><span class="p">/</span><span class="nt">restaurante</span><span class="p">[</span><span class="nt">carta</span><span class="p">/</span><span class="nt">plato</span><span class="p">/</span><span class="na">@tipo</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s2">&quot;tapa&quot;</span><span class="w"> </span><span class="p">]/</span><span class="na">@id</span>
</pre></div>
</div>
<p class="sd-card-text">o mejor:</p>
<div class="highlight-xquery notranslate"><div class="highlight"><pre><span></span><span class="p">/</span><span class="nt">cadena</span><span class="p">/</span><span class="nt">restaurante</span><span class="p">[</span><span class="nt">carta</span><span class="p">/</span><span class="nt">plato</span><span class="p">[</span><span class="nf">contains</span><span class="p">(</span><span class="na">@tipo</span><span class="p">,</span><span class="w"> </span><span class="s2">&quot;tapa&quot;</span><span class="p">)]]/</span><span class="na">@id</span>
</pre></div>
</div>
</div>
</details></li>
<li><p>Obtener el identificador de los restaurantes en los que <strong>no</strong> se sirven tapas.</p>
<details class="sd-sphinx-override sd-dropdown sd-card sd-mb-3">
<summary class="sd-summary-title sd-card-header">
Solución…<div class="sd-summary-down docutils">
<svg version="1.1" width="1.5em" height="1.5em" class="sd-octicon sd-octicon-chevron-down" viewBox="0 0 24 24" aria-hidden="true"><path fill-rule="evenodd" d="M5.22 8.72a.75.75 0 000 1.06l6.25 6.25a.75.75 0 001.06 0l6.25-6.25a.75.75 0 00-1.06-1.06L12 14.44 6.28 8.72a.75.75 0 00-1.06 0z"></path></svg></div>
<div class="sd-summary-up docutils">
<svg version="1.1" width="1.5em" height="1.5em" class="sd-octicon sd-octicon-chevron-up" viewBox="0 0 24 24" aria-hidden="true"><path fill-rule="evenodd" d="M18.78 15.28a.75.75 0 000-1.06l-6.25-6.25a.75.75 0 00-1.06 0l-6.25 6.25a.75.75 0 101.06 1.06L12 9.56l5.72 5.72a.75.75 0 001.06 0z"></path></svg></div>
</summary><div class="sd-summary-content sd-card-body docutils">
<div class="highlight-xquery notranslate"><div class="highlight"><pre><span></span><span class="p">/</span><span class="nt">cadena</span><span class="p">/</span><span class="nt">restaurante</span><span class="p">[</span><span class="nt">carta</span><span class="p">/</span><span class="nt">plato</span><span class="p">[</span><span class="nf">not</span><span class="p">(</span><span class="nf">contains</span><span class="p">(</span><span class="na">@tipo</span><span class="p">,</span><span class="w"> </span><span class="s2">&quot;tapa&quot;</span><span class="p">))]]/</span><span class="na">@id</span>
</pre></div>
</div>
</div>
</details></li>
<li><p>Obtener el nombre de los restaurantes con más de 10 platos en la carta.</p>
<details class="sd-sphinx-override sd-dropdown sd-card sd-mb-3">
<summary class="sd-summary-title sd-card-header">
Solución…<div class="sd-summary-down docutils">
<svg version="1.1" width="1.5em" height="1.5em" class="sd-octicon sd-octicon-chevron-down" viewBox="0 0 24 24" aria-hidden="true"><path fill-rule="evenodd" d="M5.22 8.72a.75.75 0 000 1.06l6.25 6.25a.75.75 0 001.06 0l6.25-6.25a.75.75 0 00-1.06-1.06L12 14.44 6.28 8.72a.75.75 0 00-1.06 0z"></path></svg></div>
<div class="sd-summary-up docutils">
<svg version="1.1" width="1.5em" height="1.5em" class="sd-octicon sd-octicon-chevron-up" viewBox="0 0 24 24" aria-hidden="true"><path fill-rule="evenodd" d="M18.78 15.28a.75.75 0 000-1.06l-6.25-6.25a.75.75 0 00-1.06 0l-6.25 6.25a.75.75 0 101.06 1.06L12 9.56l5.72 5.72a.75.75 0 001.06 0z"></path></svg></div>
</summary><div class="sd-summary-content sd-card-body docutils">
<div class="highlight-xquery notranslate"><div class="highlight"><pre><span></span><span class="p">/</span><span class="nt">cadena</span><span class="p">/</span><span class="nt">restaurante</span><span class="p">[</span><span class="nf">count</span><span class="p">(</span><span class="nt">carta</span><span class="p">/</span><span class="nt">plato</span><span class="p">)</span><span class="w"> </span><span class="o">&gt;</span><span class="w"> </span><span class="mi">10</span><span class="p">]/</span><span class="na">@nombre</span>
</pre></div>
</div>
</div>
</details></li>
<li><p>Obtener los nombres de las recetas que se sirven en «El tragón feliz».</p>
<details class="sd-sphinx-override sd-dropdown sd-card sd-mb-3">
<summary class="sd-summary-title sd-card-header">
Solución…<div class="sd-summary-down docutils">
<svg version="1.1" width="1.5em" height="1.5em" class="sd-octicon sd-octicon-chevron-down" viewBox="0 0 24 24" aria-hidden="true"><path fill-rule="evenodd" d="M5.22 8.72a.75.75 0 000 1.06l6.25 6.25a.75.75 0 001.06 0l6.25-6.25a.75.75 0 00-1.06-1.06L12 14.44 6.28 8.72a.75.75 0 00-1.06 0z"></path></svg></div>
<div class="sd-summary-up docutils">
<svg version="1.1" width="1.5em" height="1.5em" class="sd-octicon sd-octicon-chevron-up" viewBox="0 0 24 24" aria-hidden="true"><path fill-rule="evenodd" d="M18.78 15.28a.75.75 0 000-1.06l-6.25-6.25a.75.75 0 00-1.06 0l-6.25 6.25a.75.75 0 101.06 1.06L12 9.56l5.72 5.72a.75.75 0 001.06 0z"></path></svg></div>
</summary><div class="sd-summary-content sd-card-body docutils">
<div class="highlight-xquery notranslate"><div class="highlight"><pre><span></span><span class="p">//</span><span class="nt">receta</span><span class="p">[</span><span class="na">@id</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="p">/</span><span class="nt">cadena</span><span class="p">/</span><span class="nt">restaurante</span><span class="p">[</span><span class="na">@nombre</span><span class="o">=</span><span class="s2">&quot;El tragón feliz&quot;</span><span class="p">]/</span><span class="nt">carta</span><span class="p">/</span><span class="nt">plato</span><span class="p">/</span><span class="na">@ref</span><span class="p">]/</span><span class="na">@nombre</span>
</pre></div>
</div>
</div>
</details></li>
<li><p>Obtener el nombre de los restaurantes situados en la provincia de Huelva
(hágalo a partir del código postal)</p>
<details class="sd-sphinx-override sd-dropdown sd-card sd-mb-3">
<summary class="sd-summary-title sd-card-header">
Solución…<div class="sd-summary-down docutils">
<svg version="1.1" width="1.5em" height="1.5em" class="sd-octicon sd-octicon-chevron-down" viewBox="0 0 24 24" aria-hidden="true"><path fill-rule="evenodd" d="M5.22 8.72a.75.75 0 000 1.06l6.25 6.25a.75.75 0 001.06 0l6.25-6.25a.75.75 0 00-1.06-1.06L12 14.44 6.28 8.72a.75.75 0 00-1.06 0z"></path></svg></div>
<div class="sd-summary-up docutils">
<svg version="1.1" width="1.5em" height="1.5em" class="sd-octicon sd-octicon-chevron-up" viewBox="0 0 24 24" aria-hidden="true"><path fill-rule="evenodd" d="M18.78 15.28a.75.75 0 000-1.06l-6.25-6.25a.75.75 0 00-1.06 0l-6.25 6.25a.75.75 0 101.06 1.06L12 9.56l5.72 5.72a.75.75 0 001.06 0z"></path></svg></div>
</summary><div class="sd-summary-content sd-card-body docutils">
<div class="highlight-xquery notranslate"><div class="highlight"><pre><span></span><span class="p">/</span><span class="nt">cadena</span><span class="p">/</span><span class="nt">restaurante</span><span class="p">[</span><span class="nf">substring</span><span class="p">(</span><span class="nt">domicilio</span><span class="p">/</span><span class="nt">cp</span><span class="p">,</span><span class="w"> </span><span class="mi">1</span><span class="p">,</span><span class="w"> </span><span class="mi">2</span><span class="p">)</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s2">&quot;21&quot;</span><span class="p">]/</span><span class="na">@nombre</span>
</pre></div>
</div>
</div>
</details></li>
<li><p>Obtener el nombre de las recetas que se sirven como tapa en algún restaurante.</p>
<details class="sd-sphinx-override sd-dropdown sd-card sd-mb-3">
<summary class="sd-summary-title sd-card-header">
Solución…<div class="sd-summary-down docutils">
<svg version="1.1" width="1.5em" height="1.5em" class="sd-octicon sd-octicon-chevron-down" viewBox="0 0 24 24" aria-hidden="true"><path fill-rule="evenodd" d="M5.22 8.72a.75.75 0 000 1.06l6.25 6.25a.75.75 0 001.06 0l6.25-6.25a.75.75 0 00-1.06-1.06L12 14.44 6.28 8.72a.75.75 0 00-1.06 0z"></path></svg></div>
<div class="sd-summary-up docutils">
<svg version="1.1" width="1.5em" height="1.5em" class="sd-octicon sd-octicon-chevron-up" viewBox="0 0 24 24" aria-hidden="true"><path fill-rule="evenodd" d="M18.78 15.28a.75.75 0 000-1.06l-6.25-6.25a.75.75 0 00-1.06 0l-6.25 6.25a.75.75 0 101.06 1.06L12 9.56l5.72 5.72a.75.75 0 001.06 0z"></path></svg></div>
</summary><div class="sd-summary-content sd-card-body docutils">
<div class="highlight-xquery notranslate"><div class="highlight"><pre><span></span><span class="p">//</span><span class="nt">receta</span><span class="p">[</span><span class="na">@id</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="p">/</span><span class="nt">cadena</span><span class="p">/</span><span class="nt">restaurante</span><span class="p">/</span><span class="nt">carta</span><span class="p">/</span><span class="nt">plato</span><span class="p">[</span><span class="nf">contains</span><span class="p">(</span><span class="na">@tipo</span><span class="p">,</span><span class="w"> </span><span class="s2">&quot;tapa&quot;</span><span class="p">)]/</span><span class="na">@ref</span><span class="p">]/</span><span class="na">@nombre</span>
</pre></div>
</div>
</div>
</details></li>
<li><p>Obtener el nombre de los restaurantes que sirven bocadillos de anchoa.</p>
<details class="sd-sphinx-override sd-dropdown sd-card sd-mb-3">
<summary class="sd-summary-title sd-card-header">
Solución…<div class="sd-summary-down docutils">
<svg version="1.1" width="1.5em" height="1.5em" class="sd-octicon sd-octicon-chevron-down" viewBox="0 0 24 24" aria-hidden="true"><path fill-rule="evenodd" d="M5.22 8.72a.75.75 0 000 1.06l6.25 6.25a.75.75 0 001.06 0l6.25-6.25a.75.75 0 00-1.06-1.06L12 14.44 6.28 8.72a.75.75 0 00-1.06 0z"></path></svg></div>
<div class="sd-summary-up docutils">
<svg version="1.1" width="1.5em" height="1.5em" class="sd-octicon sd-octicon-chevron-up" viewBox="0 0 24 24" aria-hidden="true"><path fill-rule="evenodd" d="M18.78 15.28a.75.75 0 000-1.06l-6.25-6.25a.75.75 0 00-1.06 0l-6.25 6.25a.75.75 0 101.06 1.06L12 9.56l5.72 5.72a.75.75 0 001.06 0z"></path></svg></div>
</summary><div class="sd-summary-content sd-card-body docutils">
<div class="highlight-xquery notranslate"><div class="highlight"><pre><span></span><span class="p">/</span><span class="nt">cadena</span><span class="p">/</span><span class="nt">restaurante</span><span class="p">[</span><span class="nt">carta</span><span class="p">/</span><span class="nt">plato</span><span class="p">/</span><span class="na">@ref</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="p">//</span><span class="nt">receta</span><span class="p">[</span><span class="na">@nombre</span><span class="o">=</span><span class="s2">&quot;bocadillo de anchoas&quot;</span><span class="p">]/</span><span class="na">@id</span><span class="p">]/</span><span class="na">@nombre</span>
</pre></div>
</div>
</div>
</details></li>
<li><p>Contar los restaurantes que usan lechuga en su carta.</p>
<details class="sd-sphinx-override sd-dropdown sd-card sd-mb-3">
<summary class="sd-summary-title sd-card-header">
Solución…<div class="sd-summary-down docutils">
<svg version="1.1" width="1.5em" height="1.5em" class="sd-octicon sd-octicon-chevron-down" viewBox="0 0 24 24" aria-hidden="true"><path fill-rule="evenodd" d="M5.22 8.72a.75.75 0 000 1.06l6.25 6.25a.75.75 0 001.06 0l6.25-6.25a.75.75 0 00-1.06-1.06L12 14.44 6.28 8.72a.75.75 0 00-1.06 0z"></path></svg></div>
<div class="sd-summary-up docutils">
<svg version="1.1" width="1.5em" height="1.5em" class="sd-octicon sd-octicon-chevron-up" viewBox="0 0 24 24" aria-hidden="true"><path fill-rule="evenodd" d="M18.78 15.28a.75.75 0 000-1.06l-6.25-6.25a.75.75 0 00-1.06 0l-6.25 6.25a.75.75 0 101.06 1.06L12 9.56l5.72 5.72a.75.75 0 001.06 0z"></path></svg></div>
</summary><div class="sd-summary-content sd-card-body docutils">
<div class="highlight-xquery notranslate"><div class="highlight"><pre><span></span><span class="nf">count</span><span class="p">(/</span><span class="nt">cadena</span><span class="p">/</span><span class="nt">restaurante</span><span class="p">[</span><span class="nt">carta</span><span class="p">/</span><span class="nt">plato</span><span class="p">/</span><span class="na">@ref</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="p">//</span><span class="nt">receta</span><span class="p">[</span><span class="nt">ingrediente</span><span class="p">/</span><span class="na">@nombre</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s2">&quot;lechuga&quot;</span><span class="p">]/</span><span class="na">@id</span><span class="p">])</span>
</pre></div>
</div>
</div>
</details></li>
<li><p>Contar los restaurantes que <strong>no</strong> usan lechuga en su carta.</p>
<details class="sd-sphinx-override sd-dropdown sd-card sd-mb-3">
<summary class="sd-summary-title sd-card-header">
Solución…<div class="sd-summary-down docutils">
<svg version="1.1" width="1.5em" height="1.5em" class="sd-octicon sd-octicon-chevron-down" viewBox="0 0 24 24" aria-hidden="true"><path fill-rule="evenodd" d="M5.22 8.72a.75.75 0 000 1.06l6.25 6.25a.75.75 0 001.06 0l6.25-6.25a.75.75 0 00-1.06-1.06L12 14.44 6.28 8.72a.75.75 0 00-1.06 0z"></path></svg></div>
<div class="sd-summary-up docutils">
<svg version="1.1" width="1.5em" height="1.5em" class="sd-octicon sd-octicon-chevron-up" viewBox="0 0 24 24" aria-hidden="true"><path fill-rule="evenodd" d="M18.78 15.28a.75.75 0 000-1.06l-6.25-6.25a.75.75 0 00-1.06 0l-6.25 6.25a.75.75 0 101.06 1.06L12 9.56l5.72 5.72a.75.75 0 001.06 0z"></path></svg></div>
</summary><div class="sd-summary-content sd-card-body docutils">
<div class="highlight-xquery notranslate"><div class="highlight"><pre><span></span><span class="nf">count</span><span class="p">(/</span><span class="nt">cadena</span><span class="p">/</span><span class="nt">restaurante</span><span class="p">[</span><span class="nf">not</span><span class="p">(</span><span class="nt">carta</span><span class="p">/</span><span class="nt">plato</span><span class="p">/</span><span class="na">@ref</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="p">//</span><span class="nt">receta</span><span class="p">[</span><span class="nt">ingrediente</span><span class="p">/</span><span class="na">@nombre</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s2">&quot;lechuga&quot;</span><span class="p">]/</span><span class="na">@id</span><span class="p">)])</span>
</pre></div>
</div>
</div>
</details></li>
<li><p>¿Qué receta requiere más aceite? Suponga que el aceite siempre se mide en <em>cc</em>.</p>
<details class="sd-sphinx-override sd-dropdown sd-card sd-mb-3">
<summary class="sd-summary-title sd-card-header">
Solución…<div class="sd-summary-down docutils">
<svg version="1.1" width="1.5em" height="1.5em" class="sd-octicon sd-octicon-chevron-down" viewBox="0 0 24 24" aria-hidden="true"><path fill-rule="evenodd" d="M5.22 8.72a.75.75 0 000 1.06l6.25 6.25a.75.75 0 001.06 0l6.25-6.25a.75.75 0 00-1.06-1.06L12 14.44 6.28 8.72a.75.75 0 00-1.06 0z"></path></svg></div>
<div class="sd-summary-up docutils">
<svg version="1.1" width="1.5em" height="1.5em" class="sd-octicon sd-octicon-chevron-up" viewBox="0 0 24 24" aria-hidden="true"><path fill-rule="evenodd" d="M18.78 15.28a.75.75 0 000-1.06l-6.25-6.25a.75.75 0 00-1.06 0l-6.25 6.25a.75.75 0 101.06 1.06L12 9.56l5.72 5.72a.75.75 0 001.06 0z"></path></svg></div>
</summary><div class="sd-summary-content sd-card-body docutils">
<div class="highlight-xquery notranslate"><div class="highlight"><pre><span></span><span class="p">//</span><span class="nt">receta</span><span class="p">[</span><span class="nt">ingrediente</span><span class="p">[</span><span class="na">@nombre</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s2">&quot;aceite&quot;</span><span class="p">]/</span><span class="na">@cantidad</span><span class="w"> </span><span class="o">&gt;=</span><span class="w"> </span><span class="p">//</span><span class="nt">receta</span><span class="p">/</span><span class="nt">ingrediente</span><span class="p">[</span><span class="na">@nombre</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s2">&quot;aceite&quot;</span><span class="p">]/</span><span class="na">@cantidad</span><span class="p">]</span>
</pre></div>
</div>
</div>
</details></li>
</ol>
</section>
<section id="ejercicios-propuestos">
<h2><span class="section-number">3.1.1.7. </span>Ejercicios propuestos<a class="headerlink" href="#ejercicios-propuestos" title="Enlace permanente a este encabezado">¶</a></h2>
<blockquote>
<div><ol class="arabic simple">
<li><p>Las facturas que tenían algún descuento</p></li>
<li><p>Las facturas anteriores al año en curso</p></li>
<li><p>El número de facturas a las que se les aplicó un descuento mayor del 5%</p></li>
<li><p>Las facturas con cinco productos diferentes.</p></li>
<li><p>Las facturas en las que se facturó el producto «p01».</p></li>
<li><p>Los clientes que viven en Isla Cristina.</p></li>
<li><p>Los clientes que viven en la provincia de Huelva (el código postal puede servir para ello).</p></li>
<li><p>Los nombres de los productos con iva superreducido.</p></li>
<li><p>El número de productos que tienen un iva superreducido.</p></li>
<li><p>Los productos cuyo precio es mayor a 2 euros.</p></li>
<li><p>Todas las facturas en las que el número total de artículos comprados
fuese de más de 10. Para que tenga sentido esta pregunta, hágase la suposición
de que todos los productos que se venden, se venden por unidades.</p></li>
<li><p>El número de facturas de emitidas en noviembre de 2012.</p></li>
<li><p>El número de facturas que sólo contienen un producto.</p></li>
<li><p>Las facturas a nombre de Perico de los Palotes.</p></li>
<li><p>Las productos de la factura con identificador «f01» cuyo iva es normal.</p></li>
<li><p>Todas las facturas en las que se facturaron altramuces.</p></li>
<li><p>El total de sandías vendidas.</p></li>
<li><p>Las facturas emitidas a residentes en Isla Cristina.</p></li>
<li><p>Las facturas sin productos gravados con iva normal.</p></li>
<li><p>Las facturas cuyos productos están todos gravados con iva normal.</p></li>
</ol>
</div></blockquote>
<ol class="arabic simple">
<li><p>Dada la solución propuesta para almacenar la información sobre los libros y préstamos en una biblioteca,
determinar la expresión <em>XPath</em> que devuelve:</p>
<ol class="arabic simple">
<li><p>El número de socios de la biblioteca</p></li>
<li><p>La dirección del socio que se llama Perico de los Palotes.</p></li>
<li><p>Los libros cuyo año de edición sea 1985.</p></li>
<li><p>Los libros de la editorial Alfaguara.</p></li>
<li><p>El número total de ejemplares que hay en la biblioteca.</p></li>
<li><p>Todos los libros cuyo autor sea «Miguel de Cervantes Saavedra».</p></li>
<li><p>El número de ejemplares del libro con ISBN 00-9081-234.</p></li>
<li><p>El número total de ejemplares prestados.</p></li>
<li><p>El número total de ejemplares no prestados.</p></li>
<li><p>Los libros que se han prestado al socio c1.</p></li>
<li><p>Los libros que no están prestados al socio c1.</p></li>
<li><p>Los libros que se han prestado al socio c1, pero no al socio c2.</p></li>
<li><p>El número de ejemplares de libros de la editorial Castalia.</p></li>
<li><p>Los identificadores de los socios que tiene algún libro en préstamo.</p></li>
<li><p>Los ejemplares aún disponibles (no prestados) de Don Quijote de La Mancha.</p></li>
<li><p>Los libros de los que quedan menos de dos ejemplares en la biblioteca.</p></li>
<li><p>Los libros de los que no se ha prestado ningún ejemplar.</p></li>
<li><p>Los libros que tiene todos los ejemplares prestados</p></li>
<li><p>Los libros que tiene más ejemplares prestados que en la biblioteca.</p></li>
<li><p>El número de ejemplares prestados al socio Perico de los Palotes.</p></li>
</ol>
</li>
<li><p>Dada la solución propuesta para almacenar la información sobre los coches
que vende un concesionario, determinar la expresión <em>XPath</em> que devuelve:</p>
<ol class="arabic simple">
<li><p>Los nombres de las marchas que vende el concesionario.</p></li>
<li><p>El nombre de los modelos de la marca Renault que vende el concesionario.</p></li>
<li><p>Los modelos de cinco plazas.</p></li>
<li><p>Los modelos que tienen una cilindrada mayor a 300.</p></li>
<li><p>El modelo Megane.</p></li>
<li><p>El último modelo de todas las marcas.</p></li>
<li><p>El número de marcas que vende el concesionario.</p></li>
<li><p>El número de modelos que vende el concesionario.</p></li>
<li><p>El cliente de identificador p1.</p></li>
<li><p>El número de clientes.</p></li>
<li><p>Los coches que ha reservado el cliente p1</p></li>
<li><p>Los coches nuevos (no tienen kilometraje)</p></li>
<li><p>Los coches reservados.</p></li>
<li><p>El número de coches Clio.</p></li>
<li><p>Los Clio reservados</p></li>
<li><p>Los coches de segunda mano reservados.</p></li>
<li><p>Los coches reservados que sean Clio o Megane</p></li>
<li><p>Los coches nuevos no reservados aún.</p></li>
<li><p>El número de coches de la marca Renault</p></li>
<li><p>Los coches reservados a los habitantes de Villaconejos</p></li>
</ol>
</li>
<li><p>Dada la solución propuesta para almacenar la información sobre los parques
nacionales, determinar la expresión <em>XPath</em> que devuelve:</p>
<ol class="arabic simple">
<li><p>El número de especies vegetales.</p></li>
<li><p>Las especies vegetales con un peligro alto de extinción.</p></li>
<li><p>El número de especies animales en peligro bajo de extinción.</p></li>
<li><p>El número de especies en peligro alto de extinción.</p></li>
<li><p>El nombre común de las especies vegetales en peligro alto de extinción</p></li>
<li><p>El peligro de extinción del animal de nombre común «Lince ibérico».</p></li>
<li><p>El número de parques nacionales.</p></li>
<li><p>El número de parques en Canarias.</p></li>
<li><p>Los parques de la provincia de Huelva.</p></li>
<li><p>Los parques con una extensión mayor de 30.000 hectáreas.</p></li>
<li><p>El total de presupuestos.</p></li>
<li><p>El total de ejemplares de Lince ibérico que hay en los parques.</p></li>
<li><p>El número de especies de interés en Doñana.</p></li>
<li><p>El número de ejemplares animales de interés en Doñana.</p></li>
<li><p>El parque de Timanfaya.</p></li>
<li><p>Los especies animales de interés de Garajonay.</p></li>
<li><p>Las comunidades autónomas con parques nacionales.</p></li>
<li><p>Los parques nacionales con menos de veinte especies de interés</p></li>
<li><p>El número de parque nacionales que sólo tiene como especies de interés animales.</p></li>
<li><p>Los parques donde hay más especies animales de interés que vegetales</p></li>
</ol>
</li>
<li><p>Dada la solución propuesta para almacenar la información sobre los
habitantes de un municipio, determinar la expresión <em>XPath</em> que devuelve:</p>
<ol class="arabic simple">
<li><p>El número de habitantes del municipio.</p></li>
<li><p>Los varones del municipio.</p></li>
<li><p>Las mujeres del municipio.</p></li>
<li><p>El número de habitantes de los que se tiene registrado el padre.</p></li>
<li><p>El número de habitantes de los que se tienen registrados padre y madre.</p></li>
<li><p>El número de habitantes de los que no se conoce padre ni madre.</p></li>
<li><p>Los nombres de los habitantes de los que se conoce la madre, pero no el padre.</p></li>
<li><p>Los varones cazorleños de los que se conoce el padre.</p></li>
<li><p>Los habitantes que se llaman Perico.</p></li>
<li><p>El listado de identificadores de personas que son padre.</p></li>
<li><p>El listado de identificadores de personas que son madre.</p></li>
<li><p>Los habitantes de padre conocido que han nacido en Cazorla.</p></li>
<li><p>Los datos de los habitantes cuyo padre tienen identificador h01.</p></li>
<li><p>Los habitantes que son padre de alguien.</p></li>
<li><p>Las habitantes que son madre de alguien.</p></li>
<li><p>Los habitantes que son padre de alguien y, a la vez, tienen padre conocido.</p></li>
<li><p>¿Hay alguna persona que haya nacido en Villaconejos.</p></li>
<li><p>El listado de localidades en las que hayan nacido los habitantes que son padre.</p></li>
<li><p>Los varones que no son padre.</p></li>
<li><p>Las mujeres que no son madre de ninguna niña.</p></li>
</ol>
</li>
<li><p>Dada la solución propuesta para almacenar la información de un dibujo
técnico en dos dimensiones, determinar la expresión <em>XPath</em> que selecciona:</p>
<ol class="arabic simple">
<li><p>Todas las circunferencias.</p></li>
<li><p>La cuarta recta.</p></li>
<li><p>Los centros de las circunferencias.</p></li>
<li><p>El último punto.</p></li>
<li><p>El rectángulo con identificador «e32».</p></li>
<li><p>Todos los radios de las circunferencias.</p></li>
<li><p>El radio de la circunferencia de identificador «e2».</p></li>
<li><p>El radio de la quinta circunferencia.</p></li>
<li><p>Todos los radios de circunferencia mayores de 10.</p></li>
<li><p>Las unidades en las que se han expresado todos los números.</p></li>
<li><p>El identificador de la quinta entidad de dibujo.</p></li>
<li><p>Las rectas cuyo punto inicial (p1) sea el centro de coordenadas (0,0).</p></li>
<li><p>Las rectas cuyo punto inicial esté en el segundo cuadrante.</p></li>
<li><p>Los puntos que se encuentren en el cuarto cuadrante.</p></li>
<li><p>El cuarto de los rectángulos</p></li>
<li><p>Todas las coordenadas y de todas las rectas.</p></li>
<li><p>Todas las coordenadas y de todas las entidades de dibujo.</p></li>
<li><p>Los puntos finales de todos los rectángulos.</p></li>
<li><p>Todas las rectas cuya coordenada x del punto inicial sea mayor que la coordenada x del punto final.</p></li>
<li><p>¿Cuántos puntos hay en total?</p></li>
<li><p>¿Cuántos puntos hay en el primer cuadrante?</p></li>
<li><p>¿Cuántas circunferencias tienen radio mayor de 20?</p></li>
<li><p>¿Cuántas entidades de dibujo hay en total?</p></li>
<li><p>¿Cuántas coordenadas x hay definidas en total?</p></li>
<li><p>Todas los rectángulos cuyo lado horizontal sea el doble de largo que el vertical.</p></li>
</ol>
</li>
</ol>
<p class="rubric">Notas al pie</p>
<aside class="footnote-list brackets">
<aside class="footnote brackets" id="id7" role="note">
<span class="label"><span class="fn-bracket">[</span><a role="doc-backlink" href="#id2">1</a><span class="fn-bracket">]</span></span>
<p>Y no sólo. Ya veremos más adelante.</p>
</aside>
<aside class="footnote brackets" id="id8" role="note">
<span class="label"><span class="fn-bracket">[</span><a role="doc-backlink" href="#id3">2</a><span class="fn-bracket">]</span></span>
<p><a class="reference external" href="https://es.wikipedia.org/wiki/Operaci%C3%B3n_binaria">Operación binaria</a> en el sentido de que
hay involucrados dos operandos y un operador, no en el sentido de que los
operadores sean números binarios.</p>
</aside>
<aside class="footnote brackets" id="id9" role="note">
<span class="label"><span class="fn-bracket">[</span><a role="doc-backlink" href="#id5">3</a><span class="fn-bracket">]</span></span>
<p>De haberlo hecho, la expresión verdadera hubiera sido:</p>
<div class="highlight-xquery notranslate"><div class="highlight"><pre><span></span><span class="nf">data</span><span class="p">(/</span><span class="nt">claustro</span><span class="p">/</span><span class="nt">profesor</span><span class="p">/</span><span class="nt">nombre</span><span class="p">)</span><span class="w"> </span><span class="k">instance</span><span class="w"> </span><span class="k">of</span><span class="w"> </span><span class="kt">xs:string</span><span class="o">+</span>
</pre></div>
</div>
</aside>
<aside class="footnote brackets" id="id10" role="note">
<span class="label"><span class="fn-bracket">[</span><a role="doc-backlink" href="#id6">4</a><span class="fn-bracket">]</span></span>
<p>En <em>XPath</em> 1.0 el resultado ha de ser un valor atómico o un conjunto de
nodos. No existe la posibilidad de que una expresión devuelva una secuencia
de valores atómicos, que es lo que devuelve este ejemplo.</p>
</aside>
</aside>
</section>
</section>


            <div class="clearer"></div>
          </div>
        </div>
      </div>
      <div class="sphinxsidebar" role="navigation" aria-label="main navigation">
        <div class="sphinxsidebarwrapper">
        <p class="logo"><a href="../index.html" title="index">
          <img class="logo" src="../_static/logo.png" alt="Logo"/>
        </a></p><div class="sphinx-toc sphinxlocaltoc">
    <h3><a href="../index.html">Page contents</a></h3>
    <ul>
<li><a class="reference internal" href="#">3.1.1. XPath</a><ul>
<li><a class="reference internal" href="#procesadores">3.1.1.1. Procesadores</a><ul>
<li><a class="reference internal" href="#xidel">3.1.1.1.1. <strong class="program">Xidel</strong></a></li>
<li><a class="reference internal" href="#xmlstarlet">3.1.1.1.2. <strong class="program">XMLStarlet</strong></a><ul>
<li><a class="reference internal" href="#seleccion">3.1.1.1.2.1. Selección</a></li>
<li><a class="reference internal" href="#edicion">3.1.1.1.2.2. Edición</a></li>
</ul>
</li>
</ul>
</li>
<li><a class="reference internal" href="#sintaxis">3.1.1.2. Sintaxis</a><ul>
<li><a class="reference internal" href="#filtros">3.1.1.2.1. Filtros</a></li>
<li><a class="reference internal" href="#ejes">3.1.1.2.2. Ejes</a></li>
<li><a class="reference internal" href="#predicados">3.1.1.2.3. Predicados</a><ul>
<li><a class="reference internal" href="#operadores">3.1.1.2.3.1. Operadores</a></li>
<li><a class="reference internal" href="#funciones">3.1.1.2.3.2. Funciones</a></li>
</ul>
</li>
</ul>
</li>
<li><a class="reference internal" href="#xpath-1-0">3.1.1.3. XPath 1.0</a></li>
<li><a class="reference internal" href="#xpath-2-0-3-0">3.1.1.4. XPath 2.0/3.0</a></li>
<li><a class="reference internal" href="#xquery">3.1.1.5. XQuery</a></li>
<li><a class="reference internal" href="#ejercicio-resuelto">3.1.1.6. Ejercicio resuelto</a></li>
<li><a class="reference internal" href="#ejercicios-propuestos">3.1.1.7. Ejercicios propuestos</a></li>
</ul>
</li>
</ul>

  </div>
  <div class="sphinxprev">
    <h4>Previous page</h4>
    <p class="topless"><a href="01.consulta.html"
                          title="Previous page">&larr; <span class="section-number">3.1. </span>Tecnologías de consulta</a></p>
  </div>
  <div class="sphinxnext">
    <h4>Next page</h4>
    <p class="topless"><a href="01b.jsonpath.html"
                          title="Next page">&rarr; <span class="section-number">3.1.2. </span><abbr title="JavaScript Object Notation">JSON</abbr>Path</a></p>
  </div>
  <div role="note" aria-label="source link">
    <h3>Esta página</h3>
    <ul class="this-page-menu">
      <li><a href="../_sources/03.almacenamiento/01a.xpath.rst.txt"
            rel="nofollow">Mostrar el código</a></li>
    </ul>
   </div>
<div id="searchbox" style="display: none" role="search">
  <h3 id="searchlabel">Búsqueda rápida</h3>
    <div class="searchformwrapper">
    <form class="search" action="../search.html" method="get">
      <input type="text" name="q" aria-labelledby="searchlabel" autocomplete="off" autocorrect="off" autocapitalize="off" spellcheck="false"/>
      <input type="submit" value="Ir a" />
    </form>
    </div>
</div>
<script>document.getElementById('searchbox').style.display = "block"</script>
        </div>
      </div>
    
    
        <div class="sidebar-toggle-group no-js">
            
            <button class="sidebar-toggle" id="sidebar-hide" title="Hide the sidebar menu">
                 «
                <span class="show-for-small">hide menu</span>
                
            </button>
            <button class="sidebar-toggle" id="sidebar-show" title="Show the sidebar menu">
                
                <span class="show-for-small">menu</span>
                <span class="hide-for-small">sidebar</span>
                 »
            </button>
        </div>
    
      <div class="clearer"></div>
    </div>
    <div class="relbar-bottom">
        
    <div class="related" role="navigation" aria-label="related navigation">
      <h3>Navegación</h3>
      <ul>
        <li class="right" style="margin-right: 10px">
          <a href="../genindex.html" title="Índice General"
             >índice</a></li>
        <li class="right" >
          <a href="01b.jsonpath.html" title="3.1.2. JSONPath"
             >siguiente</a> &nbsp; &nbsp;</li>
        <li class="right" >
          <a href="01.consulta.html" title="3.1. Tecnologías de consulta"
             >anterior</a> &nbsp; &nbsp;</li>
    <li><a href="../index.html">documentación de Lenguajes de Marcas - rolling</a> &#187;</li>

          <li class="nav-item nav-item-1"><a href="index.html" ><span class="section-number">3. </span>Almacenamiento</a> &#187;</li>
          <li class="nav-item nav-item-2"><a href="01.consulta.html" ><span class="section-number">3.1. </span>Tecnologías de consulta</a> &#187;</li>
        <li class="nav-item nav-item-this"><a href=""><span class="section-number">3.1.1. </span>XPath</a></li> 
      </ul>
    </div>
    </div>

    <div class="footer" role="contentinfo">
        &#169; Derechos de autor 2023, José Miguel Sánchez Alés.
      Creado usando <a href="https://www.sphinx-doc.org/">Sphinx</a> 5.3.0.
    </div>
    <!-- cloud_sptheme 1.4 -->
  </body>
</html>