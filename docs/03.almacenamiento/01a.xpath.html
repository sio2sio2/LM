




<!DOCTYPE html>

<html lang="es">
  <head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" /><meta name="generator" content="Docutils 0.19: https://docutils.sourceforge.io/" />

    <title>3.1.1. XPath &#8212; documentación de Lenguajes de Marcas - rolling</title>
    <link rel="stylesheet" type="text/css" href="../_static/pygments.css" />
    <link rel="stylesheet" type="text/css" href="../_static/cloud.css" />
    <link rel="stylesheet" type="text/css" href="../_static/design-style.1e8bd061cd6da7fc9cf755528e8ffc24.min.css" />
    <link rel="stylesheet" href="../_static/general.css" type="text/css" />
    <link rel="stylesheet" href="../_static/particular.css" type="text/css" />
    <link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Noticia+Text:400,i,b,bi|Open+Sans:400,i,b,bi|Roboto+Mono:400,i,b,bi&amp;display=swap" type="text/css" />
    
    <script data-url_root="../" id="documentation_options" src="../_static/documentation_options.js"></script>
    <script src="../_static/jquery.js"></script>
    <script src="../_static/underscore.js"></script>
    <script src="../_static/_sphinx_javascript_frameworks_compat.js"></script>
    <script src="../_static/doctools.js"></script>
    <script src="../_static/sphinx_highlight.js"></script>
    <script src="../_static/translations.js"></script>
    <script src="../_static/design-tabs.js"></script>

    
    
     
        <script src="../_static/jquery.cookie.js"></script>
    

    
     
        <script src="../_static/cloud.base.js"></script>
    

    
     
        <script src="../_static/cloud.js"></script>
    

    <link rel="index" title="Índice" href="../genindex.html" />
    <link rel="search" title="Búsqueda" href="../search.html" />
    <link rel="next" title="3.1.2. JSONPath" href="01b.jsonpath.html" />
    <link rel="prev" title="3.1. Tecnologías de consulta" href="01.consulta.html" /> 
        <meta name="viewport" content="width=device-width, initial-scale=1">
  </head><body>
    <div class="relbar-top">
        
    <div class="related" role="navigation" aria-label="related navigation">
      <h3>Navegación</h3>
      <ul>
        <li class="right" style="margin-right: 10px">
          <a href="../genindex.html" title="Índice General"
             accesskey="I">índice</a></li>
        <li class="right" >
          <a href="01b.jsonpath.html" title="3.1.2. JSONPath"
             accesskey="N">siguiente</a> &nbsp; &nbsp;</li>
        <li class="right" >
          <a href="01.consulta.html" title="3.1. Tecnologías de consulta"
             accesskey="P">anterior</a> &nbsp; &nbsp;</li>
    <li><a href="../index.html">documentación de Lenguajes de Marcas - rolling</a> &#187;</li>

          <li class="nav-item nav-item-1"><a href="index.html" ><span class="section-number">3. </span>Almacenamiento</a> &#187;</li>
          <li class="nav-item nav-item-2"><a href="01.consulta.html" accesskey="U"><span class="section-number">3.1. </span>Tecnologías de consulta</a> &#187;</li>
        <li class="nav-item nav-item-this"><a href=""><span class="section-number">3.1.1. </span>XPath</a></li> 
      </ul>
    </div>
    </div>
  

    <div class="document">
      <div class="documentwrapper">
        <div class="bodywrapper">
          <div class="body" role="main">
            
  <section id="xpath">
<span id="id1"></span><h1><span class="section-number">3.1.1. </span>XPath<a class="headerlink" href="#xpath" title="Enlace permanente a este encabezado">¶</a></h1>
<p>En muchas de las operaciones que se hacen con un documento <abbr title="eXtensible  Markup Language">XML</abbr>, como extraer
información o escribir reglas para su transformación es necesario referirse a
nodos o conjuntos de nodos. <em class="dfn">XPath</em> es un sintaxis estándar para la
selección de uno o varios componentes (nodos, atributos, etc.) dentro de un
documento <abbr title="eXtensible  Markup Language">XML</abbr>.</p>
<p><em>XPath</em> es, pues, un estandar del <abbr title="W3 Consortium">W3C</abbr><a class="footnote-reference brackets" href="#id4" id="id2" role="doc-noteref"><span class="fn-bracket">[</span>1<span class="fn-bracket">]</span></a> que no tiene utilidad <em>per se</em>,
sino como herramienta cuando se usan métodos de procesamiento del <abbr title="eXtensible  Markup Language">XML</abbr> (XQuery,
<span class="xref std std-ref">XSLT</span>, bibliotecas para <abbr title="eXtensible  Markup Language">XML</abbr> de programas de propósito general,
etc.). Las últimas versiones de <a class="reference external" href="https://es.wikipedia.org/wiki/JavaScript">Javascript</a>, que fue un lenguaje
diseñado específicamente para la manipulación de <abbr title="HyperText Markup Language">HTML</abbr>, soportan también la
selección de nodos con <em>XPath</em>, mediante la función <a class="reference external" href="https://developer.mozilla.org/es/docs/Web/JavaScript/Introduction_to_using_XPath_in_JavaScript">document.evaluate</a>.</p>
<div class="admonition note">
<p class="admonition-title">Nota</p>
<p><em>XPath</em> no es el único lenguaje para esta tarea. En la <abbr title="HyperText Markup Language">HTML</abbr> (que no
es <abbr title="eXtensible  Markup Language">XML</abbr>, pero tiene bastantes semejanzas) es muy común usar para la
identificación de nodos los <span class="xref std std-ref">selectores CSS</span>, diseñados
en principio para definir el estilo (el aspecto) de cada nodo. Sin embargo,
<a class="reference external" href="https://es.wikipedia.org/wiki/JavaScript">Javascript</a> los usa también en general para la manipulación de nodos (véase
<a class="reference external" href="https://developer.mozilla.org/es/docs/Web/API/Document/querySelectorAll">document.querySelectorAll</a>),
en vez de <em>XPath</em>.</p>
</div>
<p>El nombre de la tecnología deriva de la fusión de <abbr title="eXtensible  Markup Language">XML</abbr> y la palabra inglesa
<em>path</em>, que en un sistema de archivo es la manera de indicar la ruta que hay que
seguir para llegar a un determinado archivo. La analogía no es gratuita, puesto
que en el caso de los sistemas de archivos se habla del árbol de directorios, de
la misma manera que en un documento <abbr title="eXtensible  Markup Language">XML</abbr> hay un árbol de nodos.</p>
<p class="rubric">Versiones</p>
<p>Desde su creación en 1999, <em>XPath</em> se ha ido actualizando con distintas
versiones:</p>
<dl class="simple">
<dt><a class="reference external" href="https://www.w3.org/TR/xpath-10/">Versión 1</a>,</dt><dd><p>que apareció en el año 1999, y es universalmente soportada. Es la versión que
soporta <a class="reference external" href="http://xmlsoft.org/">libxml</a>, la librería que utiliza
<strong class="command">xmlstarlet</strong>.</p>
</dd>
<dt><a class="reference external" href="https://www.w3.org/TR/xpath-20/">Versión 2</a>,</dt><dd><p>que apareció en 2007, e introduce mejoras muy significativas. No todo el
software soporta esta especificación.</p>
</dd>
<dt><a class="reference external" href="https://www.w3.org/TR/xpath-30/">Versión 3</a>,</dt><dd><p>que apareció en 2014. En el mundo del software libre soportan esta versión la
librería <a class="reference external" href="http://saxon.sourceforge.net/saxon7.7/api-guide.html">Saxon</a> para
<a class="reference external" href="https://www.java.com/">Java</a> y <a class="reference external" href="http://xerces.apache.org/">Xerces</a>, que
tiene versión para <a class="reference external" href="https://es.wikipedia.org/wiki/C%2B%2B">C++</a>. En la <abbr title="Command Line Interface">CLI</abbr>
de Linux puede usarse a través de algunos progamas de <em>software</em> libre:</p>
<ul class="simple">
<li><p><a class="reference external" href="http://xqilla.sourceforge.net/HomePage">xqilla</a>, que aunque tiene paquete
en <em>Debian</em>, desgraciadamente no está disponible para <em>Bookworm</em>, por
<a class="reference external" href="https://bugs.debian.org/cgi-bin/bugreport.cgi?bug=984418">problemas de compilación con g++-11</a>.</p></li>
<li><p><a class="reference external" href="http://www.videlibri.de/xidel.html">xidel</a>, que no tiene paquete oficial,
pero puede descargarse de su página oficial.</p></li>
</ul>
</dd>
<dt><a class="reference external" href="https://www.w3.org/TR/xpath-31/">Versión 3.1</a>,</dt><dd><p>publicada en 2017, que añade soporte para consultar también documentos <abbr title="JavaScript Object Notation">JSON</abbr>.</p>
</dd>
</dl>
<div class="admonition seealso">
<p class="admonition-title">Ver también</p>
<p>El <abbr title="W3 Consortium">W3C</abbr> mantiene una <a class="reference external" href="https://www.w3.org/TR/xpath/">página que enumera todas las versiones</a>. Para una exhaustiva comparación entre las
versiones <strong>1.0</strong> y <strong>2.0</strong> se encuentra <a class="reference external" href="http://www.mulberrytech.com/papers/XPath-2-0-User-Grp-HTML/contents.html">en este documento</a>.</p>
</div>
<p>Estos apuntes desarrollan <em>XPath</em> <strong>1.0</strong>.</p>
<section id="sintaxis-basica">
<h2><span class="section-number">3.1.1.1. </span>Sintaxis básica<a class="headerlink" href="#sintaxis-basica" title="Enlace permanente a este encabezado">¶</a></h2>
<p>Por analogía con las rutas de archivos, una ruta de <em>XPath</em> tiene una forma
semejante:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="o">/</span><span class="n">nodo1</span><span class="o">/</span><span class="n">nodo2</span><span class="o">/</span><span class="n">nodo3</span>
</pre></div>
</div>
<p>Traigamos el ejemplo del claustro de profesores para ilustrar las rutas que
expresemos a continuación:</p>
<details class="sd-sphinx-override sd-dropdown sd-card sd-mb-3">
<summary class="sd-summary-title sd-card-header">
XML de casilleros<div class="sd-summary-down docutils">
<svg version="1.1" width="1.5em" height="1.5em" class="sd-octicon sd-octicon-chevron-down" viewBox="0 0 24 24" aria-hidden="true"><path fill-rule="evenodd" d="M5.22 8.72a.75.75 0 000 1.06l6.25 6.25a.75.75 0 001.06 0l6.25-6.25a.75.75 0 00-1.06-1.06L12 14.44 6.28 8.72a.75.75 0 00-1.06 0z"></path></svg></div>
<div class="sd-summary-up docutils">
<svg version="1.1" width="1.5em" height="1.5em" class="sd-octicon sd-octicon-chevron-up" viewBox="0 0 24 24" aria-hidden="true"><path fill-rule="evenodd" d="M18.78 15.28a.75.75 0 000-1.06l-6.25-6.25a.75.75 0 00-1.06 0l-6.25 6.25a.75.75 0 101.06 1.06L12 9.56l5.72 5.72a.75.75 0 001.06 0z"></path></svg></div>
</summary><div class="sd-summary-content sd-card-body docutils">
<div class="highlight-xml notranslate"><div class="highlight"><pre><span></span><span class="cp">&lt;?xml version=&quot;1.0&quot; encoding=&quot;UTF-8&quot;?&gt;</span>
<span class="cp">&lt;!DOCTYPE claustro SYSTEM &quot;casilleros.dtd&quot;&gt;</span>

<span class="nt">&lt;claustro</span><span class="w"> </span><span class="na">centro=</span><span class="s">&quot;IES Pepe Botella&quot;</span><span class="nt">&gt;</span>
<span class="w">   </span><span class="nt">&lt;profesor</span><span class="w"> </span><span class="na">id=</span><span class="s">&quot;p1&quot;</span><span class="nt">&gt;</span>
<span class="w">      </span><span class="nt">&lt;apelativo&gt;</span>Luis<span class="nt">&lt;/apelativo&gt;</span>
<span class="w">      </span><span class="nt">&lt;nombre&gt;</span>Luis<span class="nt">&lt;/nombre&gt;</span>
<span class="w">      </span><span class="nt">&lt;apellidos&gt;</span>Márquez<span class="w"> </span>Vázquez<span class="nt">&lt;/apellidos&gt;</span>
<span class="w">      </span><span class="nt">&lt;departamento&gt;</span><span class="ni">&amp;EFI;</span><span class="nt">&lt;/departamento&gt;</span>
<span class="w">   </span><span class="nt">&lt;/profesor&gt;</span>

<span class="w">   </span><span class="nt">&lt;profesor</span><span class="w"> </span><span class="na">id=</span><span class="s">&quot;p13&quot;</span><span class="nt">&gt;</span>
<span class="w">      </span><span class="nt">&lt;apelativo&gt;</span>Cristina<span class="nt">&lt;/apelativo&gt;</span>
<span class="w">      </span><span class="nt">&lt;nombre&gt;</span>María<span class="w"> </span>Cristina<span class="nt">&lt;/nombre&gt;</span>
<span class="w">      </span><span class="nt">&lt;apellidos&gt;</span>Prieto<span class="w"> </span>Monagas<span class="nt">&lt;/apellidos&gt;</span>
<span class="w">      </span><span class="nt">&lt;departamento&gt;</span><span class="ni">&amp;ByG;</span><span class="nt">&lt;/departamento&gt;</span>
<span class="w">   </span><span class="nt">&lt;/profesor&gt;</span>

<span class="w">   </span><span class="cm">&lt;!-- Si se sustituye a sí mismo es que está de baja --&gt;</span>

<span class="w">   </span><span class="nt">&lt;profesor</span><span class="w"> </span><span class="na">id=</span><span class="s">&quot;p15&quot;</span><span class="nt">&gt;</span>
<span class="w">      </span><span class="nt">&lt;apelativo&gt;</span>Manolo<span class="nt">&lt;/apelativo&gt;</span>
<span class="w">      </span><span class="nt">&lt;nombre&gt;</span>Manuel<span class="nt">&lt;/nombre&gt;</span>
<span class="w">      </span><span class="nt">&lt;apellidos&gt;</span>Páez<span class="w"> </span>Robledo<span class="nt">&lt;/apellidos&gt;</span>
<span class="w">      </span><span class="nt">&lt;departamento&gt;</span><span class="ni">&amp;MAT;</span><span class="nt">&lt;/departamento&gt;</span>
<span class="w">   </span><span class="nt">&lt;/profesor&gt;</span>

<span class="w">   </span><span class="cm">&lt;!-- Profesor con casillero(s) adicional(es) --&gt;</span>

<span class="w">   </span><span class="nt">&lt;profesor</span><span class="w"> </span><span class="na">id=</span><span class="s">&quot;p17&quot;</span><span class="w"> </span><span class="na">casillero=</span><span class="s">&quot;17 43&quot;</span><span class="nt">&gt;</span>
<span class="w">      </span><span class="nt">&lt;apelativo&gt;</span>Lucía<span class="nt">&lt;/apelativo&gt;</span>
<span class="w">      </span><span class="nt">&lt;nombre&gt;</span>Lucía<span class="nt">&lt;/nombre&gt;</span>
<span class="w">      </span><span class="nt">&lt;apellidos&gt;</span>Gálvez<span class="w"> </span>Ruiz<span class="nt">&lt;/apellidos&gt;</span>
<span class="w">      </span><span class="nt">&lt;departamento&gt;</span><span class="ni">&amp;ING;</span><span class="nt">&lt;/departamento&gt;</span>
<span class="w">   </span><span class="nt">&lt;/profesor&gt;</span>

<span class="w">   </span><span class="cm">&lt;!-- En principio, si el casillero está vacío</span>
<span class="cm">        la aplicación les asigna el que indica su identificador,</span>
<span class="cm">        pero se puede asignar uno distinto.</span>
<span class="cm">    --&gt;</span>

<span class="w">   </span><span class="nt">&lt;profesor</span><span class="w"> </span><span class="na">id=</span><span class="s">&quot;p28&quot;</span><span class="w"> </span><span class="na">casillero=</span><span class="s">&quot;28&quot;</span><span class="nt">&gt;</span>
<span class="w">      </span><span class="nt">&lt;apelativo&gt;</span>Miguel<span class="w"> </span>Ángel<span class="nt">&lt;/apelativo&gt;</span>
<span class="w">      </span><span class="nt">&lt;nombre&gt;</span>Miguel<span class="w"> </span>Ángel<span class="nt">&lt;/nombre&gt;</span>
<span class="w">      </span><span class="nt">&lt;apellidos&gt;</span>Campos<span class="w"> </span>Sánchez<span class="nt">&lt;/apellidos&gt;</span>
<span class="w">      </span><span class="nt">&lt;departamento&gt;</span><span class="ni">&amp;HIS;</span><span class="nt">&lt;/departamento&gt;</span>
<span class="w">   </span><span class="nt">&lt;/profesor&gt;</span>

<span class="w">   </span><span class="nt">&lt;profesor</span><span class="w"> </span><span class="na">id=</span><span class="s">&quot;p81&quot;</span><span class="w"> </span><span class="na">casillero=</span><span class="s">&quot;&quot;</span><span class="nt">&gt;</span>
<span class="w">      </span><span class="nt">&lt;apelativo&gt;</span>Verónica<span class="nt">&lt;/apelativo&gt;</span>
<span class="w">      </span><span class="nt">&lt;nombre&gt;</span>Verónica<span class="nt">&lt;/nombre&gt;</span>
<span class="w">      </span><span class="nt">&lt;apellidos&gt;</span>Martín<span class="w"> </span>Díaz<span class="nt">&lt;/apellidos&gt;</span>
<span class="w">      </span><span class="nt">&lt;departamento&gt;</span><span class="ni">&amp;ByG;</span><span class="nt">&lt;/departamento&gt;</span>
<span class="w">   </span><span class="nt">&lt;/profesor&gt;</span>

<span class="w">   </span><span class="cm">&lt;!-- Profesor sustituto --&gt;</span>

<span class="w">   </span><span class="nt">&lt;profesor</span><span class="w"> </span><span class="na">id=</span><span class="s">&quot;p86&quot;</span><span class="w"> </span><span class="na">sustituye=</span><span class="s">&quot;p13&quot;</span><span class="nt">&gt;</span>
<span class="w">      </span><span class="nt">&lt;apelativo&gt;</span>Roberto<span class="nt">&lt;/apelativo&gt;</span>
<span class="w">      </span><span class="nt">&lt;nombre&gt;</span>Roberto<span class="nt">&lt;/nombre&gt;</span>
<span class="w">      </span><span class="nt">&lt;apellidos&gt;</span>Mínguez<span class="w"> </span>Torralbo<span class="nt">&lt;/apellidos&gt;</span>
<span class="w">   </span><span class="nt">&lt;/profesor&gt;</span>
<span class="nt">&lt;/claustro&gt;</span>
</pre></div>
</div>
</div>
</details><p>En este caso, la expresión:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="o">/</span><span class="n">claustro</span>
</pre></div>
</div>
<p>representa el nodo raíz <em>claustro</em>, mientras que la expresión:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="o">/</span><span class="n">claustro</span><span class="o">/</span><span class="n">profesor</span>
</pre></div>
</div>
<p>representa todos los nodos <em>profesor</em> que son hijos del <em>claustro</em>.</p>
<div class="admonition note">
<p class="admonition-title">Nota</p>
<p>A diferencia de las rutas de archivos, en que cada ruta absoluta
provee una ubicacion única, las rutas de <em>XPath</em> pueden seleccionar varios
componentes a la vez.</p>
</div>
<p>Es posible también hacer referencia a descendientes como en:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="o">/</span><span class="n">claustro</span><span class="o">//</span><span class="n">nombre</span>
</pre></div>
</div>
<p>en que seleccionamos todos los nodos <em>nombre</em> que son descendientes de claustro.
Para este caso particular, obtenemos los nombres de todos profesores que
pertenecen al claustro. Otro ejemplo podría ser:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="o">//</span><span class="n">profesor</span>
</pre></div>
</div>
<p>Del mismo modo que en las rutas de archivos existen rutas relativas, en las
rutas <em>XPath</em> también existen, y del mismo modo que puede surgir la necesidad de
seleccionar un directorio o archivo cuando nos encontramos trabajando en otro
directorio, es posible que necesitemos hacer referencia a otros nodos, cuando
nos encontramos procesando un determinado nodo. Para las rutas relativas, como
en el caso de los archivos, se usa el punto (<code class="docutils literal notranslate"><span class="pre">.</span></code>), que significa este nodo, y
dos puntos seguidos (<code class="docutils literal notranslate"><span class="pre">..</span></code>), que significan el nodo padre. Así pues, si
estuviésemos procesando un determinado nodo <em>profesor</em>, la ruta:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="o">./</span><span class="n">nombre</span>
</pre></div>
</div>
<p>representaría el nodo <em>nombre</em> de ese profesor; mientras que, si procesando el
nodo <em>apelativo</em> de un procesor, hacemos referencia a:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="o">../</span><span class="n">nombre</span>
</pre></div>
</div>
<p>haremos referencia al nombre del profesor cuyo nodo estuviéramos procesando.</p>
</section>
<section id="sintaxis-completa">
<h2><span class="section-number">3.1.1.2. </span>Sintaxis completa<a class="headerlink" href="#sintaxis-completa" title="Enlace permanente a este encabezado">¶</a></h2>
<p>El epígrafe anterior presenta una semblanza muy superficial de cómo <em>XPath</em>
puede referir nodos <abbr title="eXtensible  Markup Language">XML</abbr>. <em>XPath</em>, sin embargo, es mucho más potente y este
epígrafe está destinado a desentrañarlo. Por lo pronto, la sintaxis general de
una expresión <em>XPath</em> es la siguiente:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="o">/</span><span class="n">paso1</span><span class="o">/</span><span class="n">paso2</span><span class="o">/</span><span class="n">paso3</span>
</pre></div>
</div>
<p>donde cada <em>paso</em> tiene la siguiente estructura:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">eje</span><span class="p">::</span><span class="n">filtro</span><span class="p">[</span><span class="n">predicado</span><span class="p">]</span>
</pre></div>
</div>
<p>en que se distinguen tres partes (<strong>eje</strong>, <strong>filtro</strong> y <strong>predicado</strong>), que es
conveniente precisar.</p>
<div class="admonition warning">
<p class="admonition-title">Advertencia</p>
<p>Antes de proseguir es importante hacer una aclaración
terminológica. Hasta ahora habíamos tratados los términos «<em>nodo</em>» y
«<em>elemento</em>» como sinónimos. Pero ello no es así: un <em class="dfn">elemento</em>, en
realidad, es un tipo de <em>nodo</em> llamado <em>nodo elemento</em>. <em>Nodo</em> es un término
más general que engloba también otros tipos de nodos: los <em>atributos</em>, que
son <em>nodos atributo</em>; los <em>comentarios</em>, que son <em>nodos comentario</em>; el
texto, que son <em>nodos texto</em>.</p>
</div>
<section id="filtros">
<h3><span class="section-number">3.1.1.2.1. </span>Filtros<a class="headerlink" href="#filtros" title="Enlace permanente a este encabezado">¶</a></h3>
<p>El <em class="dfn">filtro</em> es aquella parte de la ruta <em>XPath</em> que expresa qué nodo o nodos
quieren referirse con tal ruta. Puede ser:</p>
<dl>
<dt><strong>QName</strong></dt><dd><p>Es el nombre del nodo. Por ejemplo:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="o">/</span><span class="n">claustro</span>
</pre></div>
</div>
<p>selecciona el nodo <em>claustro</em>. Puede usarse un asterisco («*») para indicar
cualquier nodo que sea elemento. Por ejemplo:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="o">/</span><span class="n">claustro</span><span class="o">/</span><span class="n">profesor</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span><span class="o">/*</span>
</pre></div>
</div>
<p>selecciona los elementos <em>apodo</em>, <em>nombre</em>, <em>apellidos</em> y <em>departamento</em>
hijos del primer profesor.</p>
</dd>
<dt><strong>text()</strong></dt><dd><p>Selecciona los nodos de texto. Por ejemplo:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="o">/</span><span class="n">claustro</span><span class="o">/</span><span class="n">profesor</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span><span class="o">/</span><span class="n">nombre</span><span class="o">/</span><span class="n">text</span><span class="p">()</span>
</pre></div>
</div>
<p>devuelve exclusivamente la cadena «<em>José</em>», mientras que la expresión:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="o">/</span><span class="n">claustro</span><span class="o">/</span><span class="n">profesor</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span><span class="o">/</span><span class="n">nombre</span>
</pre></div>
</div>
<p>devuelve el nodo <em>nombre</em>, esto es:</p>
<div class="highlight-xml notranslate"><div class="highlight"><pre><span></span><span class="nt">&lt;nombre&gt;</span>José<span class="nt">&lt;/nombre&gt;</span>
</pre></div>
</div>
<div class="admonition note">
<p class="admonition-title">Nota</p>
<p>Nótese que a efectos de su definición gramatical este nodo:</p>
<div class="highlight-xml notranslate"><div class="highlight"><pre><span></span><span class="nt">&lt;profesor</span><span class="w"> </span><span class="na">id=</span><span class="s">&quot;p1&quot;</span><span class="w"> </span><span class="na">sexo=</span><span class="s">&quot;hombre&quot;</span><span class="nt">&gt;</span>
<span class="w">   </span><span class="nt">&lt;apodo&gt;</span>Pepe<span class="nt">&lt;/apodo&gt;</span>
<span class="w">   </span><span class="nt">&lt;nombre&gt;</span>José<span class="nt">&lt;/nombre&gt;</span>
<span class="w">   </span><span class="nt">&lt;apellidos&gt;</span>Suárez<span class="w"> </span>Lantilla<span class="nt">&lt;/apellidos&gt;</span>
<span class="w">   </span><span class="nt">&lt;departamento&gt;</span><span class="ni">&amp;ING;</span><span class="nt">&lt;/departamento&gt;</span>
<span class="nt">&lt;/profesor&gt;</span>
</pre></div>
</div>
<p>y este otro:</p>
<div class="highlight-xml notranslate"><div class="highlight"><pre><span></span><span class="nt">&lt;profesor</span><span class="w"> </span><span class="na">id=</span><span class="s">&quot;p1&quot;</span><span class="w"> </span><span class="na">sexo=</span><span class="s">&quot;hombre&quot;</span><span class="nt">&gt;&lt;apodo&gt;</span>Pepe<span class="nt">&lt;/apodo&gt;&lt;nombre&gt;</span>José<span class="nt">&lt;/nombre&gt;&lt;apellidos&gt;</span>Suárez<span class="w"> </span>Lantilla<span class="nt">&lt;/apellidos&gt;&lt;departamento&gt;</span><span class="ni">&amp;ING;</span><span class="nt">&lt;/departamento&gt;&lt;/profesor&gt;</span>
</pre></div>
</div>
<p>son equivalentes: un nodo <em>profesor</em> que contiene cuatro nodos elemento:
<em>apodo</em>, <em>nombre</em>, <em>apellidos</em> y <em>departamento</em>. En cambio, para <em>XPath</em>
la primera expresión de <em>profesor</em> contiene nodos texto entre los
nodo elementos, cada uno de los cuales contiene, siemplemente, caracteres
de espaciado.</p>
</div>
</dd>
<dt><strong>node()</strong></dt><dd><p>Todos los nodos, sean del tipo que sean. Por ejemplo:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="o">/</span><span class="n">claustro</span><span class="o">/</span><span class="n">node</span><span class="p">()</span>
</pre></div>
</div>
<p>selecciona todos los nodo <em>profesor</em> y todos los nodos texto hijo,
consecuencia de haber sangrado tan bien el documento.</p>
<div class="admonition note">
<p class="admonition-title">Nota</p>
<p>En cambio:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="o">/</span><span class="n">claustro</span><span class="o">/*</span>
</pre></div>
</div>
<p>selecciona exclusiamente los nodos <em>profesor</em>.</p>
</div>
</dd>
<dt><strong>comment()</strong></dt><dd><p>Todos los nodos que sean comentarios:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="o">/</span><span class="n">claustro</span><span class="o">/</span><span class="n">comment</span><span class="p">()</span>
</pre></div>
</div>
</dd>
<dt><strong>&#64;atributo</strong></dt><dd><p>Selecciona el atributo con el nombre expresado. Por ejemplo:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="o">/</span><span class="n">claustro</span><span class="o">/</span><span class="n">profesor</span><span class="o">/</span><span class="nd">@sexo</span>
</pre></div>
</div>
<p>refiero los sexos de todos los profesores.</p>
</dd>
<dt><strong>processing-instruction()</strong></dt><dd><p>Todas las instrucciones de procesamiento. Por ejemplo:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="s1">&#39;//procesing-instruction()&#39;</span>
</pre></div>
</div>
<p>selecciona todas las instrucciones de procesamiento del documento.</p>
</dd>
<dt><strong>processing-instruction(destino)</strong></dt><dd><p>Todas las instrucciones de procesamiento cuyo destino sea el indicado. El
<em class="dfn">destino</em> es la palabra adyacente al signo «?».</p>
</dd>
</dl>
</section>
<section id="ejes">
<h3><span class="section-number">3.1.1.2.2. </span>Ejes<a class="headerlink" href="#ejes" title="Enlace permanente a este encabezado">¶</a></h3>
<p>El <em class="dfn">eje</em> es la parte de la ruta <em>XPath</em> que determina el sentido que se
tomará al interpretar la siguiente parte de la ruta. Recordemos que si nos
encontramos procesando un nodo y queremos referirnos a otro, podemos buscar
entre sus descendientes, entre sus ascendientes o entre sus hermanos.</p>
<table class="tb-eje docutils align-default" id="id6">
<caption><span class="caption-text"><strong>Ejes en XPath</strong></span><a class="headerlink" href="#id6" title="Enlace permanente a esta tabla">¶</a></caption>
<thead>
<tr class="row-odd"><th class="head"><p>Sentido</p></th>
<th class="head"><p>Nombre</p></th>
<th class="head"><p>Abreviatura</p></th>
<th class="head"><p>Ejemplo</p></th>
<th class="head"><p>Descripción</p></th>
</tr>
</thead>
<tbody>
<tr class="row-even"><td rowspan="7"><p>Descendente</p></td>
<td><p>child</p></td>
<td></td>
<td><div class="line-block">
<div class="line">/claustro/profesor</div>
<div class="line">/claustro/child::profesor</div>
</div>
</td>
<td><p>Selecciona hijos.</p></td>
</tr>
<tr class="row-odd"><td><p>descendent</p></td>
<td><p>/</p></td>
<td><div class="line-block">
<div class="line">/claustro//apodo</div>
<div class="line">/claustro/descendent::apodo</div>
</div>
</td>
<td><p>Selecciona descendientes.</p></td>
</tr>
<tr class="row-even"><td><p>self</p></td>
<td><p>.</p></td>
<td><div class="line-block">
<div class="line">/claustro/.</div>
<div class="line">/claustro//self::*</div>
</div>
</td>
<td><p>Selecciona el propio nodo.</p></td>
</tr>
<tr class="row-odd"><td colspan="2"><p>descendent-or-self</p></td>
<td><p>/claustro/descendent-or-self::*</p></td>
<td><p>Selecciona descendientes o el propio nodo</p></td>
</tr>
<tr class="row-even"><td colspan="2"><p>following-sibling</p></td>
<td><p>//profesor[1]/following-sibling::profesor</p></td>
<td><p>Selecciona los hermanos posteriores</p></td>
</tr>
<tr class="row-odd"><td colspan="2"><p>following</p></td>
<td><p>//profesor[1]/following::*</p></td>
<td><p>Selecciona los nodos posteriores</p></td>
</tr>
<tr class="row-even"><td><p>attribute</p></td>
<td><p>&#64;</p></td>
<td><div class="line-block">
<div class="line">//profesor/&#64;sexo</div>
<div class="line">//profesor/attribute::sexo</div>
</div>
</td>
<td><p>Selecciona atributo (puede usarse
<code class="docutils literal notranslate"><span class="pre">&#64;*</span></code>)</p></td>
</tr>
<tr class="row-odd"><td rowspan="5"><p>Ascendente</p></td>
<td><p>parent</p></td>
<td><p>..</p></td>
<td><div class="line-block">
<div class="line">//profesor[1]/apodo/..</div>
<div class="line">//profesor[1]/apodo/parent::*</div>
</div>
</td>
<td><p>Selecciona el nodo padre.</p></td>
</tr>
<tr class="row-even"><td colspan="2"><p>ancestor</p></td>
<td><div class="line-block">
<div class="line">//profesor[1]/apodo/ancestor::*</div>
</div>
</td>
<td><p>Selecciona ascendientes.</p></td>
</tr>
<tr class="row-odd"><td colspan="2"><p>ancestor-or-self</p></td>
<td><p>//profesor[1]/apodo/ancestor-or-self::*</p></td>
<td><p>Seleccioa ascendientes o el propio nodo</p></td>
</tr>
<tr class="row-even"><td colspan="2"><p>preceding</p></td>
<td><p>//profesor[2]/nombre/preceding::nombre</p></td>
<td><p>Selecciona nodos anteriores</p></td>
</tr>
<tr class="row-odd"><td colspan="2"><p>preceding-sibling</p></td>
<td><p>//profesor[2]/nombre/preceding-sibling::*</p></td>
<td><p>Selecciona los hermanos anteriores</p></td>
</tr>
</tbody>
</table>
</section>
<section id="predicados">
<h3><span class="section-number">3.1.1.2.3. </span>Predicados<a class="headerlink" href="#predicados" title="Enlace permanente a este encabezado">¶</a></h3>
<p>El <em class="dfn">predicado</em> es la parte de la estructura que permite añadir una
condición a la ruta y se escribe entre corchetes. Por ejemplo:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="o">//</span><span class="n">profesor</span><span class="p">[</span><span class="nd">@sexo</span> <span class="o">=</span> <span class="s1">&#39;hombre&#39;</span><span class="p">]</span>
</pre></div>
</div>
<p>selecciona, entre todos los nodos <em>profesor</em>, sólo los que representan
profesores varones.</p>
<p>Dos son aspectos fundamentales a la hora de componer un predicado:</p>
<ul class="simple">
<li><p>Al representar el predicado una condición, la expresión se evalúa a verdadero
o falso. En el ejemplo, comprobábamos unas igualdad.</p></li>
<li><p>Las rutas <em>XPath</em> expresadas dentro del predicado, si son relativas, son
relativas al nodo adyacente (<em>profesor</em> en el caso del ejemplo). En
consecuencia, <code class="docutils literal notranslate"><span class="pre">&#64;sexo</span></code> es el atributo <em>sexo</em> del profesor en cuestión.</p></li>
</ul>
<div class="admonition note">
<p class="admonition-title">Nota</p>
<p>Para poder explicar mejor los predicados se supondrá que un <em>profesor</em>
puede tener ninguno, uno o varios apodos, esto es, que su definición usando
<abbr title="Document Type Definition">DTD</abbr> es:</p>
<div class="highlight-dtd notranslate"><div class="highlight"><pre><span></span><span class="k">&lt;!ELEMENT</span> <span class="nt">profesor</span> <span class="o">(</span><span class="nt">apodo</span><span class="o">*,</span> <span class="nt">nombre</span><span class="o">,</span> <span class="nt">apellidos</span><span class="o">,</span> <span class="nt">departamento</span><span class="o">)</span><span class="k">&gt;</span>
</pre></div>
</div>
</div>
<section id="operadores">
<h4><span class="section-number">3.1.1.2.3.1. </span>Operadores<a class="headerlink" href="#operadores" title="Enlace permanente a este encabezado">¶</a></h4>
<p>Dentro de los predicados pueden usarse los siguientes operadores:</p>
<table class="docutils align-default" id="id7">
<caption><span class="caption-text"><strong>Operadores aritméticos</strong></span><a class="headerlink" href="#id7" title="Enlace permanente a esta tabla">¶</a></caption>
<thead>
<tr class="row-odd"><th class="head"><p>Operador</p></th>
<th class="head"><p>Significado</p></th>
</tr>
</thead>
<tbody>
<tr class="row-even"><td><p>+</p></td>
<td><p>Suma</p></td>
</tr>
<tr class="row-odd"><td><p>-</p></td>
<td><p>Resta</p></td>
</tr>
<tr class="row-even"><td><p>*</p></td>
<td><p>Multiplicación</p></td>
</tr>
<tr class="row-odd"><td><p>div</p></td>
<td><p>División</p></td>
</tr>
<tr class="row-even"><td><p>mod</p></td>
<td><p>Módulo (resto)</p></td>
</tr>
</tbody>
</table>
<table class="docutils align-default" id="id8">
<caption><span class="caption-text"><strong>Operadores lógicos</strong></span><a class="headerlink" href="#id8" title="Enlace permanente a esta tabla">¶</a></caption>
<thead>
<tr class="row-odd"><th class="head"><p>Operador</p></th>
<th class="head"><p>Significado</p></th>
</tr>
</thead>
<tbody>
<tr class="row-even"><td><p>=</p></td>
<td><p>Igualdad</p></td>
</tr>
<tr class="row-odd"><td><p>!=</p></td>
<td><p>Desigualdad</p></td>
</tr>
<tr class="row-even"><td><p>&lt;</p></td>
<td><p>Menor</p></td>
</tr>
<tr class="row-odd"><td><p>&lt;=</p></td>
<td><p>Menor o igual</p></td>
</tr>
<tr class="row-even"><td><p>&gt;</p></td>
<td><p>Mayor</p></td>
</tr>
<tr class="row-odd"><td><p>&gt;=</p></td>
<td><p>Mayor o igual</p></td>
</tr>
<tr class="row-even"><td><p>and</p></td>
<td><p>Conjunción</p></td>
</tr>
<tr class="row-odd"><td><p>or</p></td>
<td><p>Disyunción</p></td>
</tr>
<tr class="row-even"><td><p>not()</p></td>
<td><p>Negación</p></td>
</tr>
</tbody>
</table>
<p class="rubric">Ejemplos</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="o">//</span><span class="n">profesor</span><span class="p">[</span><span class="nd">@sexo</span> <span class="o">=</span> <span class="s1">&#39;hombre&#39;</span><span class="p">]</span>
<span class="o">//</span><span class="n">profesor</span><span class="p">[</span><span class="n">nombre</span> <span class="o">!=</span> <span class="s1">&#39;José&#39;</span><span class="p">]</span>
<span class="o">//</span><span class="n">profesor</span><span class="p">[</span><span class="ow">not</span><span class="p">(</span><span class="n">nombre</span> <span class="o">=</span> <span class="s1">&#39;José&#39;</span><span class="p">)]</span>
<span class="o">//</span><span class="n">profesor</span><span class="p">[</span><span class="nd">@sexo</span> <span class="o">=</span> <span class="s1">&#39;hombre&#39;</span> <span class="ow">and</span> <span class="n">departamento</span> <span class="o">=</span> <span class="s1">&#39;Historia&#39;</span><span class="p">]</span>
</pre></div>
</div>
<div class="admonition note">
<p class="admonition-title">Nota</p>
<p>Pueden yuxtaponerse dos predicados y en ese caso deberán cumplirse
ambos predicados. Por tanto, el último ejemplo es equivalente a:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="o">//</span><span class="n">profesor</span><span class="p">[</span><span class="nd">@sexo</span> <span class="o">=</span> <span class="s1">&#39;hombre&#39;</span><span class="p">][</span><span class="n">departamento</span> <span class="o">=</span> <span class="s1">&#39;Historia&#39;</span><span class="p">]</span>
</pre></div>
</div>
</div>
</section>
<section id="funciones">
<h4><span class="section-number">3.1.1.2.3.2. </span>Funciones<a class="headerlink" href="#funciones" title="Enlace permanente a este encabezado">¶</a></h4>
<p>Junto a nodos y operadores, en los predicados<a class="footnote-reference brackets" href="#id5" id="id3" role="doc-noteref"><span class="fn-bracket">[</span>2<span class="fn-bracket">]</span></a> también es posible usar
funciones. En el sitio para desarrolladores de <strong class="program">mozilla</strong> puede
consultarse <a class="reference external" href="https://developer.mozilla.org/es/docs/XPath/funciones-xpath">una relación completa de funciones para XPath 1.0</a>, de las cuales
aquí citaremos algunas muy socorridas:</p>
<dl>
<dt><a class="reference external" href="https://developer.mozilla.org/en-US/docs/Web/XPath/Functions/count">count()</a></dt><dd><p>Cuenta el número de nodos. Por ejemplo, podemos seleccionar los profesores
que tienen más de un apodo de este modo:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="o">//</span><span class="n">profesor</span><span class="p">[</span><span class="n">count</span><span class="p">(</span><span class="n">apodo</span><span class="p">)</span> <span class="o">&gt;</span> <span class="mi">1</span><span class="p">]</span>
</pre></div>
</div>
</dd>
<dt><a class="reference external" href="https://developer.mozilla.org/en-US/docs/Web/XPath/Functions/local-name">local-name()</a></dt><dd><p>Devuelve el nombre del elemento (sin la espacio de nombres). Si no se incluye
como argumento un nodo, se devuelve el nombre del nodo actual. Por ejemplo:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="o">//</span><span class="n">profesor</span><span class="o">/*</span><span class="p">[</span><span class="n">local</span><span class="o">-</span><span class="n">name</span><span class="p">()</span> <span class="o">=</span> <span class="s1">&#39;apodo&#39;</span> <span class="ow">or</span> <span class="n">local</span><span class="o">-</span><span class="n">name</span><span class="p">()</span> <span class="o">=</span> <span class="s1">&#39;nombre&#39;</span><span class="p">]</span>
</pre></div>
</div>
<p>selecciona los nodos hijo de profesor que son <em>apodo</em> o <em>nombre</em>.</p>
</dd>
<dt><a class="reference external" href="https://developer.mozilla.org/en-US/docs/Web/XPath/Functions/not">not()</a></dt><dd><p>Invierte el resultado lógico de la expresión. Ya se trató al hablar de los
operadores.</p>
</dd>
</dl>
<dl id="xpath-position">
<dt><a class="reference external" href="https://developer.mozilla.org/en-US/docs/Web/XPath/Functions/position">position()</a></dt><dd><p>Devuelve la posición del elemento actual. Para seleccionar el segundo
profesor se puede hacer:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="o">//</span><span class="n">profesor</span><span class="p">[</span><span class="n">position</span><span class="p">()</span> <span class="o">=</span> <span class="mi">2</span><span class="p">]</span>
</pre></div>
</div>
<div class="admonition note">
<p class="admonition-title">Nota</p>
<p>En este caso particular, la expresión puede simplificarse a:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="o">//</span><span class="n">profesor</span><span class="p">[</span><span class="mi">2</span><span class="p">]</span>
</pre></div>
</div>
</div>
<div class="admonition note">
<p class="admonition-title">Nota</p>
<p>Para indicar el último, puede usarse la función <cite>last()
&lt;https://developer.mozilla.org/en-US/docs/Web/XPath/Functions/last&gt;</cite>.</p>
</div>
</dd>
<dt><a class="reference external" href="https://developer.mozilla.org/en-US/docs/Web/XPath/Functions/sum">sum()</a></dt><dd><p>Suma los nodos que se incluyen como argumento, supuesto que estos sean
números.</p>
</dd>
</dl>
<div class="admonition note">
<p class="admonition-title">Nota</p>
<p>Algunas funciones pueden usarse fuera de los predicados para devolver
el resultado final de la expresión <em>XPath</em>. Por ejemplo, esto devolvería
de cuántos profesores se compone el claustro:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">count</span><span class="p">(</span><span class="o">//</span><span class="n">profesores</span><span class="p">)</span>
</pre></div>
</div>
</div>
</section>
<section id="evaluacion">
<h4><span class="section-number">3.1.1.2.3.3. </span>Evaluación<a class="headerlink" href="#evaluacion" title="Enlace permanente a este encabezado">¶</a></h4>
<p>La evaluación de predicados no es tan simple como pueda resultar a simple
vista. Los operandos de los predicados pueden ser una cadena, un número, un
booleano, un nodo o un conjunto de nodos.</p>
<p>Por ejemplo, en la expresión:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="o">//</span><span class="n">profesor</span><span class="p">[</span><span class="n">nombre</span> <span class="o">=</span> <span class="s2">&quot;José&quot;</span><span class="p">]</span>
</pre></div>
</div>
<p>se compara un nodo elemento con una cadena; ya que, en puridad, para comparar
texto con texto habría que haber hecho:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="o">//</span><span class="n">profesor</span><span class="p">[</span><span class="n">nombre</span><span class="o">/</span><span class="n">text</span><span class="p">()</span> <span class="o">=</span> <span class="s2">&quot;José&quot;</span><span class="p">]</span>
</pre></div>
</div>
<p>En cambio, la primera expresión funciona ya que se realizan conversiones
automáticas para igualar los tipos de los dos operados.</p>
<p class="rubric">Conversión de tipos</p>
<p>Al evaluarse predicados es posible que se realicen conversiones automáticas de
tipos, aunque pueden forzarse algunas conversiones utilizando las funciones
<a class="reference external" href="https://developer.mozilla.org/en-US/docs/Web/XPath/Functions/boolean">boolean()</a>,
<a class="reference external" href="https://developer.mozilla.org/en-US/docs/Web/XPath/Functions/string">string()</a>
o <a class="reference external" href="https://developer.mozilla.org/en-US/docs/Web/XPath/Functions/number">number()</a>.</p>
<p>Las conversiones <strong>automáticas</strong> operan del siguiente modo:</p>
<ol class="arabic simple">
<li><p>Si el operador es <code class="docutils literal notranslate"><span class="pre">=</span></code> o <code class="docutils literal notranslate"><span class="pre">!=</span></code> y alguno de los dos operandos es booleano,
el otro se convertirá a booleano; si no es así y uno de los dos es número, el
otro se convierte a número; y en cualquier otro caso, ambos se convierten a
cadena.</p></li>
<li><p>Si los operadores son de comparación (<code class="docutils literal notranslate"><span class="pre">&lt;</span></code>, <code class="docutils literal notranslate"><span class="pre">&lt;=</span></code>, <code class="docutils literal notranslate"><span class="pre">&gt;</span></code> y <code class="docutils literal notranslate"><span class="pre">&gt;=</span></code>) los
operandos se convierten a número. Nótese que esto implica que no pueden
compararse alfabéticamente cadenas.</p></li>
<li><p>Ante operadores aritméticos, ambos operandos se convierten a número.</p></li>
</ol>
<p>Otro aspecto a considerar es qué resultado produce la conversión a otro tipo:</p>
<ul>
<li><p><em>Conversión a cadena</em>:</p>
<ul class="simple">
<li><p>Los números se convierten a cadenas según lo que se esperaría de ellos.</p></li>
<li><p>Los valores booleanos <em>false</em> y <em>true</em> se convierten a las cadenas «false» y
«true».</p></li>
<li><p>Un conjunto de nodos se convierte a cadena, convirtiendo a cadena el primero
de los nodos. Si el conjunto está vacío, entonces se obtiene la cadena
vacía. El valor de cadena de un nodo es el valor del atributo, si el nodo es
un nodo atributo; o la concatenación de los nodos de texto descendientes, si
el nodo es un nodo elemento.</p></li>
</ul>
</li>
<li><p><em>Conversión a número</em>:</p>
<ul class="simple">
<li><p>Las cadenas que representan número son convertidas al número equivalente; si
no representan ningún número, se obtiene <strong>NaN</strong>.</p></li>
<li><p><em>true</em> se convierte a <strong>1</strong>, y <em>false</em> a <strong>0</strong>.</p></li>
<li><p>Para convertir en número un conjunto de nodos se convierte primero el
conjunto en cadena.</p></li>
</ul>
</li>
<li><p><em>Conversión a booleano</em>:</p>
<ul>
<li><p>Los números negativos y positivos se consideran verdaderos; <strong>0</strong> y <strong>NaN</strong>
se consideran falsos.</p></li>
<li><p>Un conjunto de nodos es verdadero, a menos que esté vacío. Esta es la razón
por la que para seleccionar los profesores que no tienen apodo basta con
hacer:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="o">//</span><span class="n">profesor</span><span class="p">[</span><span class="ow">not</span><span class="p">(</span><span class="n">apodo</span><span class="p">)]</span>
</pre></div>
</div>
</li>
<li><p>Una cadena es verdadera, a menos que sea la cadena vacía.</p></li>
</ul>
</li>
</ul>
<p><strong>Lógica y pluralidad</strong></p>
<p>Por lo general, los operandos de una operación lógica  representan valores
únics. En cambio, en <em>XPath</em> es muy habitual que los operandos representen
conjuntos de nodos. Por ejemplo:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="o">//</span><span class="n">profesor</span><span class="p">[</span><span class="n">apodo</span> <span class="o">=</span> <span class="s2">&quot;Pepe&quot;</span><span class="p">]</span>
</pre></div>
</div>
<p>Como puede haber varios nodos <em>apodo</em>, en algunos casos el operando izquierdo
representa un conjunto de nodos, por lo que estaremos comparando varios valores
(izquierda) con uno (derecha). Esto es lo que hemos denominado <em class="dfn">el problema
de la pluralidad</em>. <em>XPath</em> lo resuelve del siguiente modo:</p>
<ol class="arabic simple">
<li><p>Cuando se compara una pluralidad de nodos con un único valor, la expresión es
verdadera con que al menos uno de los nodos de la pluralidad cumpla con la
expresión. En consecuencia, en el ejemplo anterior bastaría con que uno de
los apodos del profesor fuera «Pepe» para que ese profesor quedara
seleccionado.</p></li>
<li><p>Cuando ambos operandos de las expresión son una pluralidad de nodos, la
expresión es verdadera si hay un nodo del primer conjunto y un nodo del
segundo conjunto, que al ser comparados entre sí como cadenas hacen que la
expresión sea verdadera.</p></li>
</ol>
<div class="admonition warning">
<p class="admonition-title">Advertencia</p>
<p>Es importante tener presente que cuando uno o los dos operandos son
una pluralidad, lo contrario a:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="o">//</span><span class="n">profesor</span><span class="p">[</span><span class="n">apodo</span> <span class="o">=</span> <span class="s2">&quot;Pepe&quot;</span><span class="p">]</span>
</pre></div>
</div>
<p>no es:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="o">//</span><span class="n">profesor</span><span class="p">[</span><span class="n">apodo</span> <span class="o">!=</span> <span class="s2">&quot;Pepe&quot;</span><span class="p">]</span>
</pre></div>
</div>
<p>sino:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="o">//</span><span class="n">profesor</span><span class="p">[</span><span class="ow">not</span><span class="p">(</span><span class="n">apodo</span> <span class="o">=</span> <span class="s2">&quot;Pepe&quot;</span><span class="p">)]</span>
</pre></div>
</div>
<p>Sólo esta segunda expresión nos devolvería los nodos de los profesores cuyo
apodo no sea «Pepe», ya que la segunda expresión nos devolvería cualquier
profesor en que uno de cuyos apodos no fuera «Pepe».</p>
</div>
</section>
</section>
<section id="agregacion-de-rutas">
<h3><span class="section-number">3.1.1.2.4. </span>Agregación de rutas<a class="headerlink" href="#agregacion-de-rutas" title="Enlace permanente a este encabezado">¶</a></h3>
<p><em>XPath</em> permite agregar rutas de manera que los nodos seleccionados sean la
unión de los nodos que seleccionan las distintas rutas. Por ejemplo:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="o">//</span><span class="n">profesor</span><span class="o">/</span><span class="n">apodo</span> <span class="o">|</span> <span class="o">//</span><span class="n">profesor</span><span class="o">/</span><span class="n">nombre</span>
</pre></div>
</div>
<p>selecciona todos los nodos <em>apodo</em> y <em>nombre</em>.</p>
</section>
</section>
<section id="procesadores">
<h2><span class="section-number">3.1.1.3. </span>Procesadores<a class="headerlink" href="#procesadores" title="Enlace permanente a este encabezado">¶</a></h2>
<p>Para procesar nuestras expresiones <em>XPath</em> tenemos muchas alternativas, dos de
las cuales pueden ser:</p>
<ul class="simple">
<li><p><a class="reference external" href="https://extendsclass.com/xpath-tester.html">XPath Tester</a>, que permite
evaluar online nuestras expresiones.</p></li>
<li><p>El paquete <a class="reference external" href="https://packages.debian.org/stable/xmlstarlet">xmlstarlet</a>, cuyo paquete homónimo permite utilizar
expresiones <em>XPath</em> tanto para seleccionar información del <abbr title="eXtensible  Markup Language">XML</abbr> original,
como para modificarlo.</p></li>
</ul>
<section id="seleccion">
<h3><span class="section-number">3.1.1.3.1. </span>Selección<a class="headerlink" href="#seleccion" title="Enlace permanente a este encabezado">¶</a></h3>
<p>Para lograrlo es necesario usar el comando <code class="docutils literal notranslate"><span class="pre">sel</span></code>, seguido de la opción <code class="docutils literal notranslate"><span class="pre">-t</span></code>, y
la acción que se quiere realizar a continuación, que puede ser:</p>
<dl>
<dt><code class="code docutils literal notranslate"><span class="pre">-v</span> <span class="pre">&lt;expresión-xpath&gt;</span></code></dt><dd><p>Muestra el valor de lo seleccionado mediante la expresión. Se deberá usar esa
opción cuando se quiere devolver texto simple, esto es, el valor de un
atributo o de un nodo que contiene texto. Por ejemplo:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span>$ xmlstarlet sel -t -v &#39;//profesor[1]/@id&#39; -n claustro.xml
p1
</pre></div>
</div>
<div class="admonition note">
<p class="admonition-title">Nota</p>
<p>Se ha añadido la opción <code class="docutils literal notranslate"><span class="pre">-n</span></code> para añadir un cambio de línea al
final del resultado.</p>
</div>
</dd>
<dt><code class="code docutils literal notranslate"><span class="pre">-c</span> <span class="pre">&lt;expresion-path&gt;</span></code></dt><dd><p>Copia el nodo seleccionado, por tanto deberá usarse cuando el resultado de
nuestra selección es un nodo elemento o un conjunto de nodos elemento. Por
ejemplo, lo siguiente devuelve todos los nodos <em>apodo</em>:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span>$ xmlstarlet sel -t -c &#39;//profesor/apodo&#39; -n claustro.xml
&lt;apodo&gt;Pepe&lt;/apodo&gt;&lt;apodo&gt;Paco&lt;/apodo&gt;&lt;apodo&gt;Mari&lt;/apodo&gt;
</pre></div>
</div>
</dd>
<dt><code class="code docutils literal notranslate"><span class="pre">-m</span> <span class="pre">&lt;expresión-path&gt;</span></code></dt><dd><p>Selecciona un nodo o un conjunto de nodos para seguir trabajando sobre
ellos. Por tanto, requerirá que luego se use <code class="docutils literal notranslate"><span class="pre">-v</span></code> o <code class="docutils literal notranslate"><span class="pre">-c</span></code>. Por ejemplo:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span>$ xmlstarlet sel -t -m &#39;//profesor/apodo&#39; -v &#39;.&#39; claustro.xml
PepePacoMari
</pre></div>
</div>
<p>En este caso, habría sido fundamental usar <code class="docutils literal notranslate"><span class="pre">-n</span></code>:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span>$ xmlstarlet sel -t -m &#39;//profesor/apodo&#39; -v &#39;.&#39; -n claustro.xml
Pepe
Paco
Mari
</pre></div>
</div>
</dd>
</dl>
<div class="admonition note">
<p class="admonition-title">Nota</p>
<p><strong class="command">xmlstarlet</strong> es capaz de devolvernos el código <abbr title="eXtensible Stylesheet Language Transformations">XSLT</abbr>
equivalente a nuestra selección añadiendo tras <code class="docutils literal notranslate"><span class="pre">sel</span></code> la opción <code class="docutils literal notranslate"><span class="pre">-C</span></code>.</p>
</div>
</section>
<section id="edicion">
<h3><span class="section-number">3.1.1.3.2. </span>Edición<a class="headerlink" href="#edicion" title="Enlace permanente a este encabezado">¶</a></h3>
<p>En este caso, debe usarse <code class="docutils literal notranslate"><span class="pre">ed</span></code>, una acción y el uso de expresiones <em>XPath</em>:</p>
<dl>
<dt><code class="code docutils literal notranslate"><span class="pre">-d</span> <span class="pre">&lt;expresion-xpath&gt;</span></code></dt><dd><p>Borra los nodos que selecciona la expresión:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span>$ xmlstarlet ed -d &#39;//profesor[last()]&#39; claustro.xml
</pre></div>
</div>
<p>Esta expresión elimnina el último de los profesores.</p>
</dd>
<dt><code class="code docutils literal notranslate"><span class="pre">-u</span> <span class="pre">&lt;expresion-xpath&gt;</span> <span class="pre">-v</span> <span class="pre">valor</span></code></dt><dd><p>Actualiza el valor del nodo o nodos seleccionados:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span>$ xmlstarlet ed -u &#39;//profesor[1]/apodo&#39; -v &quot;Manolo&quot; claustro.xml
</pre></div>
</div>
</dd>
<dt><code class="code docutils literal notranslate"><span class="pre">-i</span> <span class="pre">&lt;expresión-xpath&gt;</span> <span class="pre">-t</span> <span class="pre">(elem|text|attr)</span> <span class="pre">-n</span> <span class="pre">&lt;nombre&gt;</span> <span class="pre">-v</span> <span class="pre">&lt;valor&gt;</span></code></dt><dd><p>Permite insertar antes del nodo seleccionado (o los nodos) un nodo de tipo
elemento, texto o atributo del nombre y valor referidos. Se deben hacer
varias puntualizaciones:</p>
<ul class="simple">
<li><p>Los nodos de texto no tienen nombre, así que da igual el nombre que se les
dé.</p></li>
<li><p>El valor sólo puede ser texto, así que, directamente, sólo se pueden crear
nodos elemento que contienen texto.</p></li>
<li><p>Si se quiere crear nodos elemento que tienen atributos o contienen otros
nodos elemento, entonces hay que componer varias acciones.</p></li>
</ul>
<p>Por ejemplo, esto añadiría un nuevo apodo al primer profesor:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span>$ xmlstarlet ed -i &#39;//profesor[1]/nombre&#39; -t elem -n &quot;apodo&quot; -v &quot;Pancho&quot; claustro.xml
</pre></div>
</div>
</dd>
<dt><code class="code docutils literal notranslate"><span class="pre">-a</span> <span class="pre">&lt;expresión-xpath&gt;</span> <span class="pre">-t</span> <span class="pre">(elem|text|attr)</span> <span class="pre">-n</span> <span class="pre">nombre</span> <span class="pre">-v</span> <span class="pre">valor</span></code></dt><dd><p>Como  <code class="docutils literal notranslate"><span class="pre">-i</span></code> pero añade el nodo después, no antes. Por ejemplo:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span>$ xmlstarlet ed -a &#39;//profesor[1]/apodo[last()]&#39; -t elem -n &quot;apodo&quot; -v &quot;Pancho&quot; claustro.xml
</pre></div>
</div>
</dd>
<dt><code class="code docutils literal notranslate"><span class="pre">-s</span> <span class="pre">&lt;expresión-xpath&gt;</span> <span class="pre">-t</span> <span class="pre">(elemen|text|attr)</span> <span class="pre">-n</span> <span class="pre">nombre</span> <span class="pre">-v</span> <span class="pre">valor</span></code></dt><dd><p>Añade el nuevo elemento como último elemento del elemento seleccionado:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span>$ xmlstarlet ed -s &#39;//profesor[2]/nombre&#39; -t text -n foo -v &quot; María&quot; claustro.xml
</pre></div>
</div>
</dd>
</dl>
<div class="admonition note">
<p class="admonition-title">Nota</p>
<p>Las transformaciones que podemos hacer de este modo son bastante
limitadas. Un mecanismo más apropiado para realizarlas es usar <span class="xref std std-ref">XSLT</span>.</p>
</div>
</section>
</section>
<section id="ejercicio-resuelto">
<h2><span class="section-number">3.1.1.4. </span>Ejercicio resuelto<a class="headerlink" href="#ejercicio-resuelto" title="Enlace permanente a este encabezado">¶</a></h2>
<p>Dado el <abbr title="eXtensible  Markup Language">XML</abbr> <a class="reference internal" href="../01.intro/02b.marcas.html#xml-resueltos"><span class="std std-ref">propuesto para representar el negocio de una cadena de
restaurantes</span></a>, determine las expresion <em>XPath</em> apropiadas para:</p>
<ol class="arabic">
<li><p>Obtener todas las recetas disponibles.</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="o">//</span><span class="n">receta</span>
</pre></div>
</div>
</li>
<li><p>Obtener el nodo que representa la receta de nombre «ensalada».</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="o">//</span><span class="n">receta</span><span class="p">[</span><span class="nd">@nombre</span><span class="o">=</span><span class="s2">&quot;ensalada&quot;</span><span class="p">]</span>
</pre></div>
</div>
</li>
<li><p>Obtener la carta del restaurante de identificador «re01».</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="o">/</span><span class="n">cadena</span><span class="o">/</span><span class="n">restaurante</span><span class="p">[</span><span class="nd">@id</span><span class="o">=</span><span class="s2">&quot;re01&quot;</span><span class="p">]</span><span class="o">/</span><span class="n">carta</span>
</pre></div>
</div>
</li>
<li><p>Obtener el código postal del restaurante «El tragón feliz»-</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="o">/</span><span class="n">cadena</span><span class="o">/</span><span class="n">restaurante</span><span class="p">[</span><span class="nd">@nombre</span><span class="o">=</span><span class="s2">&quot;El dragon feliz&quot;</span><span class="p">]</span><span class="o">/</span><span class="n">domicilio</span><span class="o">/</span><span class="n">cp</span>
</pre></div>
</div>
</li>
<li><p>Contar las recetas de las que dispone la cadena.</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">count</span><span class="p">(</span><span class="o">//</span><span class="n">receta</span><span class="p">)</span>
</pre></div>
</div>
</li>
<li><p>Contar cuántos ingredientes necesita la receta de la <em>ensalada</em>.</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">count</span><span class="p">(</span><span class="o">//</span><span class="n">receta</span><span class="p">[</span><span class="nd">@nombre</span><span class="o">=</span><span class="s2">&quot;ensalada&quot;</span><span class="p">]</span><span class="o">/</span><span class="n">ingrediente</span><span class="p">)</span>
</pre></div>
</div>
</li>
<li><p>Contar cuántos ingredientes de «ensalada» se deben medir en gramos.</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">count</span><span class="p">(</span><span class="o">//</span><span class="n">receta</span><span class="p">[</span><span class="nd">@nombre</span><span class="o">=</span><span class="s2">&quot;ensalada&quot;</span><span class="p">]</span><span class="o">/</span><span class="n">ingrediente</span><span class="p">[</span><span class="nd">@unidad</span><span class="o">=</span><span class="s2">&quot;gramo&quot;</span><span class="p">])</span>
</pre></div>
</div>
</li>
<li><p>Obtener la carta del restaurante «El tragón feliz».</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="o">/</span><span class="n">cadena</span><span class="o">/</span><span class="n">restaurante</span><span class="p">[</span><span class="nd">@nombre</span><span class="o">=</span><span class="s2">&quot;El tragón feliz&quot;</span><span class="p">]</span><span class="o">/</span><span class="n">carta</span>
</pre></div>
</div>
</li>
<li><p>Obtener el nombre de las recetas en las que se usa <em>lechuga</em>.</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="o">//</span><span class="n">receta</span><span class="p">[</span><span class="n">ingrediente</span><span class="o">/</span><span class="nd">@bombre</span> <span class="o">=</span> <span class="s2">&quot;lechuga&quot;</span><span class="p">]</span><span class="o">/</span><span class="nd">@nombre</span>
</pre></div>
</div>
</li>
<li><p>Obtener el nombre de las recetas en las que <strong>no</strong> se usa <em>lechuga</em>.</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="o">//</span><span class="n">receta</span><span class="p">[</span><span class="ow">not</span><span class="p">(</span><span class="n">ingrediente</span><span class="o">/</span><span class="nd">@bombre</span> <span class="o">=</span> <span class="s2">&quot;lechuga&quot;</span><span class="p">)]</span><span class="o">/</span><span class="nd">@nombre</span>
</pre></div>
</div>
</li>
<li><p>Obtener el identificador de los restaurantes en los que se sirven tapas.</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="o">/</span><span class="n">cadena</span><span class="o">/</span><span class="n">restaurante</span><span class="p">[</span><span class="n">carta</span><span class="o">/</span><span class="n">plato</span><span class="o">/</span><span class="nd">@tipo</span> <span class="o">=</span> <span class="s2">&quot;tapa&quot;</span> <span class="p">]</span><span class="o">/</span><span class="nd">@id</span>
</pre></div>
</div>
<p>o mejor:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="o">/</span><span class="n">cadena</span><span class="o">/</span><span class="n">restaurante</span><span class="p">[</span><span class="n">carta</span><span class="o">/</span><span class="n">plato</span><span class="p">[</span><span class="n">contains</span><span class="p">(</span><span class="nd">@tipo</span><span class="p">,</span> <span class="s2">&quot;tapa&quot;</span><span class="p">)]]</span><span class="o">/</span><span class="nd">@id</span>
</pre></div>
</div>
</li>
<li><p>Obtener el identificador de los restaurantes en los que <strong>no</strong> se sirven tapas.</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="o">/</span><span class="n">cadena</span><span class="o">/</span><span class="n">restaurante</span><span class="p">[</span><span class="n">carta</span><span class="o">/</span><span class="n">plato</span><span class="p">[</span><span class="ow">not</span><span class="p">(</span><span class="n">contains</span><span class="p">(</span><span class="nd">@tipo</span><span class="p">,</span> <span class="s2">&quot;tapa&quot;</span><span class="p">))]]</span><span class="o">/</span><span class="nd">@id</span>
</pre></div>
</div>
</li>
<li><p>Obtener el nombre de los restaurantes con más de 10 platos en la carta.</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="o">/</span><span class="n">cadena</span><span class="o">/</span><span class="n">restaurante</span><span class="p">[</span><span class="n">count</span><span class="p">(</span><span class="n">carta</span><span class="o">/</span><span class="n">plato</span><span class="p">)</span> <span class="o">&gt;</span> <span class="mi">10</span><span class="p">]</span><span class="o">/</span><span class="nd">@nombre</span>
</pre></div>
</div>
</li>
<li><p>Obtener los nombres de las recetas que se sirven en «El tragón feliz».</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="o">//</span><span class="n">receta</span><span class="p">[</span><span class="nd">@id</span> <span class="o">=</span> <span class="o">/</span><span class="n">cadena</span><span class="o">/</span><span class="n">restaurante</span><span class="p">[</span><span class="nd">@nombre</span><span class="o">=</span><span class="s2">&quot;El tragón feliz&quot;</span><span class="p">]</span><span class="o">/</span><span class="n">carta</span><span class="o">/</span><span class="n">plato</span><span class="o">/</span><span class="nd">@ref</span><span class="p">]</span><span class="o">/</span><span class="nd">@nombre</span>
</pre></div>
</div>
</li>
<li><p>Obtener el nombre de los restaurantes situados en la provincia de Huelva
(hágalo a partir del código postal)</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="o">/</span><span class="n">cadena</span><span class="o">/</span><span class="n">restaurante</span><span class="p">[</span><span class="n">substring</span><span class="p">(</span><span class="n">domicilio</span><span class="o">/</span><span class="n">cp</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">)</span> <span class="o">=</span> <span class="s2">&quot;21&quot;</span><span class="p">]</span><span class="o">/</span><span class="nd">@nombre</span>
</pre></div>
</div>
</li>
<li><p>Obtener el nombre de las recetas que se sirven como tapa en algún restaurante.</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="o">//</span><span class="n">receta</span><span class="p">[</span><span class="nd">@id</span> <span class="o">=</span> <span class="o">/</span><span class="n">cadena</span><span class="o">/</span><span class="n">restaurante</span><span class="o">/</span><span class="n">carta</span><span class="o">/</span><span class="n">plato</span><span class="p">[</span><span class="n">contains</span><span class="p">(</span><span class="nd">@tipo</span><span class="p">,</span> <span class="s2">&quot;tapa&quot;</span><span class="p">)]</span><span class="o">/</span><span class="nd">@ref</span><span class="p">]</span><span class="o">/</span><span class="nd">@nombre</span>
</pre></div>
</div>
</li>
<li><p>Obtener el nombre de los restaurantes que sirven bocadillos de anchoa.</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="o">/</span><span class="n">cadena</span><span class="o">/</span><span class="n">restaurante</span><span class="p">[</span><span class="n">carta</span><span class="o">/</span><span class="n">plato</span><span class="o">/</span><span class="nd">@ref</span> <span class="o">=</span> <span class="o">//</span><span class="n">receta</span><span class="p">[</span><span class="nd">@nombre</span><span class="o">=</span><span class="s2">&quot;bocadillo de anchoas&quot;</span><span class="p">]</span><span class="o">/</span><span class="nd">@id</span><span class="p">]</span><span class="o">/</span><span class="nd">@nombre</span>
</pre></div>
</div>
</li>
<li><p>Contar los restaurantes que usan lechuga en su carta.</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">count</span><span class="p">(</span><span class="o">/</span><span class="n">cadena</span><span class="o">/</span><span class="n">restaurante</span><span class="p">[</span><span class="n">carta</span><span class="o">/</span><span class="n">plato</span><span class="o">/</span><span class="nd">@ref</span> <span class="o">=</span> <span class="o">//</span><span class="n">receta</span><span class="p">[</span><span class="n">ingrediente</span><span class="o">/</span><span class="nd">@nombre</span> <span class="o">=</span> <span class="s2">&quot;lechuga&quot;</span><span class="p">]</span><span class="o">/</span><span class="nd">@id</span><span class="p">])</span>
</pre></div>
</div>
</li>
<li><p>Contar los restaurantes que <strong>no</strong> usan lechuga en su carta.</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">count</span><span class="p">(</span><span class="o">/</span><span class="n">cadena</span><span class="o">/</span><span class="n">restaurante</span><span class="p">[</span><span class="ow">not</span><span class="p">(</span><span class="n">carta</span><span class="o">/</span><span class="n">plato</span><span class="o">/</span><span class="nd">@ref</span> <span class="o">=</span> <span class="o">//</span><span class="n">receta</span><span class="p">[</span><span class="n">ingrediente</span><span class="o">/</span><span class="nd">@nombre</span> <span class="o">=</span> <span class="s2">&quot;lechuga&quot;</span><span class="p">]</span><span class="o">/</span><span class="nd">@id</span><span class="p">)])</span>
</pre></div>
</div>
</li>
<li><p>¿Qué receta requiere más aceite? Suponga que el aceite siempre se mide en <em>cc</em>.</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="o">//</span><span class="n">receta</span><span class="p">[</span><span class="n">ingrediente</span><span class="p">[</span><span class="nd">@nombre</span> <span class="o">=</span> <span class="s2">&quot;aceite&quot;</span><span class="p">]</span><span class="o">/</span><span class="nd">@cantidad</span> <span class="o">&gt;=</span> <span class="o">//</span><span class="n">receta</span><span class="o">/</span><span class="n">ingrediente</span><span class="p">[</span><span class="nd">@nombre</span> <span class="o">=</span> <span class="s2">&quot;aceite&quot;</span><span class="p">]</span><span class="o">/</span><span class="nd">@cantidad</span><span class="p">]</span>
</pre></div>
</div>
</li>
</ol>
</section>
<section id="ejercicios-propuestos">
<h2><span class="section-number">3.1.1.5. </span>Ejercicios propuestos<a class="headerlink" href="#ejercicios-propuestos" title="Enlace permanente a este encabezado">¶</a></h2>
<blockquote>
<div><ol class="arabic simple">
<li><p>Las facturas que tenían algún descuento</p></li>
<li><p>Las facturas anteriores al año en curso</p></li>
<li><p>El número de facturas a las que se les aplicó un descuento mayor del 5%</p></li>
<li><p>Las facturas con cinco productos diferentes.</p></li>
<li><p>Las facturas en las que se facturó el producto «p01».</p></li>
<li><p>Los clientes que viven en Isla Cristina.</p></li>
<li><p>Los clientes que viven en la provincia de Huelva (el código postal puede servir para ello).</p></li>
<li><p>Los nombres de los productos con iva superreducido.</p></li>
<li><p>El número de productos que tienen un iva superreducido.</p></li>
<li><p>Los productos cuyo precio es mayor a 2 euros.</p></li>
<li><p>Todas las facturas en las que el número total de artículos comprados
fuese de más de 10. Para que tenga sentido esta pregunta, hágase la suposición
de que todos los productos que se venden, se venden por unidades.</p></li>
<li><p>El número de facturas de emitidas en noviembre de 2012.</p></li>
<li><p>El número de facturas que sólo contienen un producto.</p></li>
<li><p>Las facturas a nombre de Perico de los Palotes.</p></li>
<li><p>Las productos de la factura con identificador «f01» cuyo iva es normal.</p></li>
<li><p>Todas las facturas en las que se facturaron altramuces.</p></li>
<li><p>El total de sandías vendidas.</p></li>
<li><p>Las facturas emitidas a residentes en Isla Cristina.</p></li>
<li><p>Las facturas sin productos gravados con iva normal.</p></li>
<li><p>Las facturas cuyos productos están todos gravados con iva normal.</p></li>
</ol>
</div></blockquote>
<ol class="arabic simple">
<li><p>Dada la solución propuesta para almacenar la información sobre los libros y préstamos en una biblioteca,
determinar la expresión <em>XPath</em> que devuelve:</p>
<ol class="arabic simple">
<li><p>El número de socios de la biblioteca</p></li>
<li><p>La dirección del socio que se llama Perico de los Palotes.</p></li>
<li><p>Los libros cuyo año de edición sea 1985.</p></li>
<li><p>Los libros de la editorial Alfaguara.</p></li>
<li><p>El número total de ejemplares que hay en la biblioteca.</p></li>
<li><p>Todos los libros cuyo autor sea «Miguel de Cervantes Saavedra».</p></li>
<li><p>El número de ejemplares del libro con ISBN 00-9081-234.</p></li>
<li><p>El número total de ejemplares prestados.</p></li>
<li><p>El número total de ejemplares no prestados.</p></li>
<li><p>Los libros que se han prestado al socio c1.</p></li>
<li><p>Los libros que no están prestados al socio c1.</p></li>
<li><p>Los libros que se han prestado al socio c1, pero no al socio c2.</p></li>
<li><p>El número de ejemplares de libros de la editorial Castalia.</p></li>
<li><p>Los identificadores de los socios que tiene algún libro en préstamo.</p></li>
<li><p>Los ejemplares aún disponibles (no prestados) de Don Quijote de La Mancha.</p></li>
<li><p>Los libros de los que quedan menos de dos ejemplares en la biblioteca.</p></li>
<li><p>Los libros de los que no se ha prestado ningún ejemplar.</p></li>
<li><p>Los libros que tiene todos los ejemplares prestados</p></li>
<li><p>Los libros que tiene más ejemplares prestados que en la biblioteca.</p></li>
<li><p>El número de ejemplares prestados al socio Perico de los Palotes.</p></li>
</ol>
</li>
<li><p>Dada la solución propuesta para almacenar la información sobre los coches
que vende un concesionario, determinar la expresión <em>XPath</em> que devuelve:</p>
<ol class="arabic simple">
<li><p>Los nombres de las marchas que vende el concesionario.</p></li>
<li><p>El nombre de los modelos de la marca Renault que vende el concesionario.</p></li>
<li><p>Los modelos de cinco plazas.</p></li>
<li><p>Los modelos que tienen una cilindrada mayor a 300.</p></li>
<li><p>El modelo Megane.</p></li>
<li><p>El último modelo de todas las marcas.</p></li>
<li><p>El número de marcas que vende el concesionario.</p></li>
<li><p>El número de modelos que vende el concesionario.</p></li>
<li><p>El cliente de identificador p1.</p></li>
<li><p>El número de clientes.</p></li>
<li><p>Los coches que ha reservado el cliente p1</p></li>
<li><p>Los coches nuevos (no tienen kilometraje)</p></li>
<li><p>Los coches reservados.</p></li>
<li><p>El número de coches Clio.</p></li>
<li><p>Los Clio reservados</p></li>
<li><p>Los coches de segunda mano reservados.</p></li>
<li><p>Los coches reservados que sean Clio o Megane</p></li>
<li><p>Los coches nuevos no reservados aún.</p></li>
<li><p>El número de coches de la marca Renault</p></li>
<li><p>Los coches reservados a los habitantes de Villaconejos</p></li>
</ol>
</li>
<li><p>Dada la solución propuesta para almacenar la información sobre los parques
nacionales, determinar la expresión <em>XPath</em> que devuelve:</p>
<ol class="arabic simple">
<li><p>El número de especies vegetales.</p></li>
<li><p>Las especies vegetales con un peligro alto de extinción.</p></li>
<li><p>El número de especies animales en peligro bajo de extinción.</p></li>
<li><p>El número de especies en peligro alto de extinción.</p></li>
<li><p>El nombre común de las especies vegetales en peligro alto de extinción</p></li>
<li><p>El peligro de extinción del animal de nombre común «Lince ibérico».</p></li>
<li><p>El número de parques nacionales.</p></li>
<li><p>El número de parques en Canarias.</p></li>
<li><p>Los parques de la provincia de Huelva.</p></li>
<li><p>Los parques con una extensión mayor de 30.000 hectáreas.</p></li>
<li><p>El total de presupuestos.</p></li>
<li><p>El total de ejemplares de Lince ibérico que hay en los parques.</p></li>
<li><p>El número de especies de interés en Doñana.</p></li>
<li><p>El número de ejemplares animales de interés en Doñana.</p></li>
<li><p>El parque de Timanfaya.</p></li>
<li><p>Los especies animales de interés de Garajonay.</p></li>
<li><p>Las comunidades autónomas con parques nacionales.</p></li>
<li><p>Los parques nacionales con menos de veinte especies de interés</p></li>
<li><p>El número de parque nacionales que sólo tiene como especies de interés animales.</p></li>
<li><p>Los parques donde hay más especies animales de interés que vegetales</p></li>
</ol>
</li>
<li><p>Dada la solución propuesta para almacenar la información sobre los
habitantes de un municipio, determinar la expresión <em>XPath</em> que devuelve:</p>
<ol class="arabic simple">
<li><p>El número de habitantes del municipio.</p></li>
<li><p>Los varones del municipio.</p></li>
<li><p>Las mujeres del municipio.</p></li>
<li><p>El número de habitantes de los que se tiene registrado el padre.</p></li>
<li><p>El número de habitantes de los que se tienen registrados padre y madre.</p></li>
<li><p>El número de habitantes de los que no se conoce padre ni madre.</p></li>
<li><p>Los nombres de los habitantes de los que se conoce la madre, pero no el padre.</p></li>
<li><p>Los varones cazorleños de los que se conoce el padre.</p></li>
<li><p>Los habitantes que se llaman Perico.</p></li>
<li><p>El listado de identificadores de personas que son padre.</p></li>
<li><p>El listado de identificadores de personas que son madre.</p></li>
<li><p>Los habitantes de padre conocido que han nacido en Cazorla.</p></li>
<li><p>Los datos de los habitantes cuyo padre tienen identificador h01.</p></li>
<li><p>Los habitantes que son padre de alguien.</p></li>
<li><p>Las habitantes que son madre de alguien.</p></li>
<li><p>Los habitantes que son padre de alguien y, a la vez, tienen padre conocido.</p></li>
<li><p>¿Hay alguna persona que haya nacido en Villaconejos.</p></li>
<li><p>El listado de localidades en las que hayan nacido los habitantes que son padre.</p></li>
<li><p>Los varones que no son padre.</p></li>
<li><p>Las mujeres que no son madre de ninguna niña.</p></li>
</ol>
</li>
<li><p>Dada la solución propuesta para almacenar la información de un dibujo
técnico en dos dimensiones, determinar la expresión <em>XPath</em> que selecciona:</p>
<ol class="arabic simple">
<li><p>Todas las circunferencias.</p></li>
<li><p>La cuarta recta.</p></li>
<li><p>Los centros de las circunferencias.</p></li>
<li><p>El último punto.</p></li>
<li><p>El rectángulo con identificador «e32».</p></li>
<li><p>Todos los radios de las circunferencias.</p></li>
<li><p>El radio de la circunferencia de identificador «e2».</p></li>
<li><p>El radio de la quinta circunferencia.</p></li>
<li><p>Todos los radios de circunferencia mayores de 10.</p></li>
<li><p>Las unidades en las que se han expresado todos los números.</p></li>
<li><p>El identificador de la quinta entidad de dibujo.</p></li>
<li><p>Las rectas cuyo punto inicial (p1) sea el centro de coordenadas (0,0).</p></li>
<li><p>Las rectas cuyo punto inicial esté en el segundo cuadrante.</p></li>
<li><p>Los puntos que se encuentren en el cuarto cuadrante.</p></li>
<li><p>El cuarto de los rectángulos</p></li>
<li><p>Todas las coordenadas y de todas las rectas.</p></li>
<li><p>Todas las coordenadas y de todas las entidades de dibujo.</p></li>
<li><p>Los puntos finales de todos los rectángulos.</p></li>
<li><p>Todas las rectas cuya coordenada x del punto inicial sea mayor que la coordenada x del punto final.</p></li>
<li><p>¿Cuántos puntos hay en total?</p></li>
<li><p>¿Cuántos puntos hay en el primer cuadrante?</p></li>
<li><p>¿Cuántas circunferencias tienen radio mayor de 20?</p></li>
<li><p>¿Cuántas entidades de dibujo hay en total?</p></li>
<li><p>¿Cuántas coordenadas x hay definidas en total?</p></li>
<li><p>Todas los rectángulos cuyo lado horizontal sea el doble de largo que el vertical.</p></li>
</ol>
</li>
</ol>
<p class="rubric">Notas al pie</p>
<aside class="footnote-list brackets">
<aside class="footnote brackets" id="id4" role="note">
<span class="label"><span class="fn-bracket">[</span><a role="doc-backlink" href="#id2">1</a><span class="fn-bracket">]</span></span>
<p>Puede consultar <a class="reference external" href="http://www.w3.org/TR/xpath10/">su especificación</a>.</p>
</aside>
<aside class="footnote brackets" id="id5" role="note">
<span class="label"><span class="fn-bracket">[</span><a role="doc-backlink" href="#id3">2</a><span class="fn-bracket">]</span></span>
<p>Y no sólo. Ya veremos más adelante.</p>
</aside>
</aside>
</section>
</section>


            <div class="clearer"></div>
          </div>
        </div>
      </div>
      <div class="sphinxsidebar" role="navigation" aria-label="main navigation">
        <div class="sphinxsidebarwrapper">
        <p class="logo"><a href="../index.html" title="index">
          <img class="logo" src="../_static/logo.png" alt="Logo"/>
        </a></p><div class="sphinx-toc sphinxlocaltoc">
    <h3><a href="../index.html">Page contents</a></h3>
    <ul>
<li><a class="reference internal" href="#">3.1.1. XPath</a><ul>
<li><a class="reference internal" href="#sintaxis-basica">3.1.1.1. Sintaxis básica</a></li>
<li><a class="reference internal" href="#sintaxis-completa">3.1.1.2. Sintaxis completa</a><ul>
<li><a class="reference internal" href="#filtros">3.1.1.2.1. Filtros</a></li>
<li><a class="reference internal" href="#ejes">3.1.1.2.2. Ejes</a></li>
<li><a class="reference internal" href="#predicados">3.1.1.2.3. Predicados</a><ul>
<li><a class="reference internal" href="#operadores">3.1.1.2.3.1. Operadores</a></li>
<li><a class="reference internal" href="#funciones">3.1.1.2.3.2. Funciones</a></li>
<li><a class="reference internal" href="#evaluacion">3.1.1.2.3.3. Evaluación</a></li>
</ul>
</li>
<li><a class="reference internal" href="#agregacion-de-rutas">3.1.1.2.4. Agregación de rutas</a></li>
</ul>
</li>
<li><a class="reference internal" href="#procesadores">3.1.1.3. Procesadores</a><ul>
<li><a class="reference internal" href="#seleccion">3.1.1.3.1. Selección</a></li>
<li><a class="reference internal" href="#edicion">3.1.1.3.2. Edición</a></li>
</ul>
</li>
<li><a class="reference internal" href="#ejercicio-resuelto">3.1.1.4. Ejercicio resuelto</a></li>
<li><a class="reference internal" href="#ejercicios-propuestos">3.1.1.5. Ejercicios propuestos</a></li>
</ul>
</li>
</ul>

  </div>
  <div class="sphinxprev">
    <h4>Previous page</h4>
    <p class="topless"><a href="01.consulta.html"
                          title="Previous page">&larr; <span class="section-number">3.1. </span>Tecnologías de consulta</a></p>
  </div>
  <div class="sphinxnext">
    <h4>Next page</h4>
    <p class="topless"><a href="01b.jsonpath.html"
                          title="Next page">&rarr; <span class="section-number">3.1.2. </span><abbr title="JavaScript Object Notation">JSON</abbr>Path</a></p>
  </div>
  <div role="note" aria-label="source link">
    <h3>Esta página</h3>
    <ul class="this-page-menu">
      <li><a href="../_sources/03.almacenamiento/01a.xpath.rst.txt"
            rel="nofollow">Mostrar el código</a></li>
    </ul>
   </div>
<div id="searchbox" style="display: none" role="search">
  <h3 id="searchlabel">Búsqueda rápida</h3>
    <div class="searchformwrapper">
    <form class="search" action="../search.html" method="get">
      <input type="text" name="q" aria-labelledby="searchlabel" autocomplete="off" autocorrect="off" autocapitalize="off" spellcheck="false"/>
      <input type="submit" value="Ir a" />
    </form>
    </div>
</div>
<script>document.getElementById('searchbox').style.display = "block"</script>
        </div>
      </div>
    
    
        <div class="sidebar-toggle-group no-js">
            
            <button class="sidebar-toggle" id="sidebar-hide" title="Hide the sidebar menu">
                 «
                <span class="show-for-small">hide menu</span>
                
            </button>
            <button class="sidebar-toggle" id="sidebar-show" title="Show the sidebar menu">
                
                <span class="show-for-small">menu</span>
                <span class="hide-for-small">sidebar</span>
                 »
            </button>
        </div>
    
      <div class="clearer"></div>
    </div>
    <div class="relbar-bottom">
        
    <div class="related" role="navigation" aria-label="related navigation">
      <h3>Navegación</h3>
      <ul>
        <li class="right" style="margin-right: 10px">
          <a href="../genindex.html" title="Índice General"
             >índice</a></li>
        <li class="right" >
          <a href="01b.jsonpath.html" title="3.1.2. JSONPath"
             >siguiente</a> &nbsp; &nbsp;</li>
        <li class="right" >
          <a href="01.consulta.html" title="3.1. Tecnologías de consulta"
             >anterior</a> &nbsp; &nbsp;</li>
    <li><a href="../index.html">documentación de Lenguajes de Marcas - rolling</a> &#187;</li>

          <li class="nav-item nav-item-1"><a href="index.html" ><span class="section-number">3. </span>Almacenamiento</a> &#187;</li>
          <li class="nav-item nav-item-2"><a href="01.consulta.html" ><span class="section-number">3.1. </span>Tecnologías de consulta</a> &#187;</li>
        <li class="nav-item nav-item-this"><a href=""><span class="section-number">3.1.1. </span>XPath</a></li> 
      </ul>
    </div>
    </div>

    <div class="footer" role="contentinfo">
        &#169; Derechos de autor 2023, José Miguel Sánchez Alés.
      Creado usando <a href="https://www.sphinx-doc.org/">Sphinx</a> 5.3.0.
    </div>
    <!-- cloud_sptheme 1.4 -->
  </body>
</html>